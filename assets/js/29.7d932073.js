(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{434:function(t,s,a){"use strict";a.r(s);var e=a(34),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"关于-js-与-css-是否阻塞-dom-的渲染和解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于-js-与-css-是否阻塞-dom-的渲染和解析"}},[t._v("#")]),t._v(" 关于 JS 与 CSS 是否阻塞 DOM 的渲染和解析")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/banner.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("  最近系统梳理"),a("code",[t._v("HTML5")]),t._v("所有涉及到的标签时，梳理至"),a("code",[t._v("<link>")]),t._v("和"),a("code",[t._v("<script>")]),t._v("标签时，碰巧想到一个困扰很久的问题，即一般把"),a("code",[t._v("<script>")]),t._v("放在"),a("code",[t._v("<body>")]),t._v("尾部，"),a("code",[t._v("<link>")]),t._v("标签放在"),a("code",[t._v("<head>")]),t._v("内部，而页面通过"),a("code",[t._v("CDN")]),t._v("引入第三方框架或库时，基本都是将其"),a("code",[t._v("<script>")]),t._v("标签放在"),a("code",[t._v("<link>")]),t._v("标签前面。")]),t._v(" "),a("p",[t._v("  可能此方式已经成为了约定俗成，但是究竟其好处在哪里，或者说其它的方式为什么不可取，想必你也和我有同样的疑问，那就接着来往下看吧。")]),t._v(" "),a("h2",{attrs:{id:"准备工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),a("p",[t._v("  首先需要做的准备工作是，搭建一个服务器，目的是为了返回"),a("code",[t._v("css")]),t._v("样式和"),a("code",[t._v("js")]),t._v("脚本，并且让服务器根据传递的参数，固定延时返回数据。")]),t._v(" "),a("p",[t._v("  其目录结构如下，其中"),a("code",[t._v("index.js")]),t._v("和"),a("code",[t._v("style.css")]),t._v("就是用于返回的数据，"),a("code",[t._v("app.js")]),t._v("为服务器启动文件，"),a("code",[t._v("index.html")]),t._v("是用来测试案例的文件，剩余文件或文件夹可以忽略。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("├── "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v("\n│   ├── index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js\n│   ├── style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("css\n├── app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js\n├── index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html\n├── "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json\n├── node_modules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\n")])])]),a("p",[t._v("  涉及的相关代码也贴一下吧，方便复制调试。有必要说明一下，本地运行"),a("code",[t._v("node app.js")]),t._v("启动后，浏览器输入"),a("code",[t._v("http://127.0.0.1:3000/")]),t._v("就能访问到"),a("code",[t._v("index.html")]),t._v("，而访问"),a("code",[t._v("style.css")]),t._v("可以输入"),a("code",[t._v("http://127.0.0.1:3000/static/style.css?sleep=3000")]),t._v("，其中"),a("code",[t._v("sleep")]),t._v("参数则可自由控制"),a("code",[t._v("css")]),t._v("文件延时返回，例如想要文件"),a("code",[t._v("5s")]),t._v("后返回就设置"),a("code",[t._v("sleep=5000")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// app.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("express")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" port "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sleepFun")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("time")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("filter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" sleep "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleepFun")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/static/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" express"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("static")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./static/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./index.html'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UTF-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("app is running at http://127.0.0.1:")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("port"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// static/index.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// static/style.css")]),t._v("\np "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" lightblue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("  接着就是"),a("code",[t._v("index.html")]),t._v("的准备工作，其中"),a("code",[t._v("HTML")]),t._v("部分的架子就长下面那样，然后你只需要记住"),a("code",[t._v("DOMContentLoaded")]),t._v("事件将在页面"),a("code",[t._v("DOM")]),t._v("解析完成后触发。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DOCTYPE")]),t._v(" html"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("html lang"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zh-CN"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOMContentLoaded'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("hello world"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("h2",{attrs:{id:"css-不会阻塞-dom-解析-但是会阻塞-dom-渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css-不会阻塞-dom-解析-但是会阻塞-dom-渲染"}},[t._v("#")]),t._v(" CSS 不会阻塞 DOM 解析，但是会阻塞 DOM 渲染")]),t._v(" "),a("p",[t._v("  首先在"),a("code",[t._v("index.html")]),t._v("插入如下"),a("code",[t._v("<link>")]),t._v("标签，然后在浏览器输入"),a("code",[t._v("http://127.0.0.1:3000/")]),t._v("访问此页面。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOMContentLoaded'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("link rel"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stylesheet"')]),t._v(" href"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./static/style.css?sleep=3000"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("hello world"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("  页面初始显示为空白，控制台打印出了"),a("code",[t._v("p")]),t._v("元素，同时浏览器标签页上加载"),a("code",[t._v("loading")]),t._v("，"),a("code",[t._v("3s")]),t._v("后页面显示出浅蓝色的"),a("code",[t._v("hello world")]),t._v("。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/css.gif",alt:""}})]),t._v(" "),a("p",[t._v("  以上情况也就说明，"),a("code",[t._v("CSS")]),t._v("不会阻塞"),a("code",[t._v("DOM")]),t._v("的解析，如果说"),a("code",[t._v("CSS")]),t._v("阻塞"),a("code",[t._v("DOM")]),t._v("解析的话，那么"),a("code",[t._v("p")]),t._v("标签不会被解析，进而"),a("code",[t._v("DOM")]),t._v("不会被解析完成，"),a("code",[t._v("CSS")]),t._v("请求过程中也就不可能会触发"),a("code",[t._v("DOMContentLoaded")]),t._v("事件。而且在"),a("code",[t._v("css")]),t._v("请求过程中，控制台立即打印出了"),a("code",[t._v("p")]),t._v("元素，因此"),a("code",[t._v("CSS")]),t._v("不会阻塞"),a("code",[t._v("DOM")]),t._v("的解析。")]),t._v(" "),a("p",[t._v("  另一个情况就是，虽然"),a("code",[t._v("DOM")]),t._v("很早就被解析完成，但是"),a("code",[t._v("p")]),t._v("标签却迟迟没有渲染，原因在于"),a("code",[t._v("CSS")]),t._v("样式还未请求完成，在样式获取后"),a("code",[t._v("hello world")]),t._v("才被渲染出来，所以说"),a("code",[t._v("CSS")]),t._v("会阻塞页面渲染。")]),t._v(" "),a("p",[t._v("  简单阐述一下浏览器的解析渲染过程，解析"),a("code",[t._v("DOM")]),t._v("生成"),a("code",[t._v("DOM Tree")]),t._v("，解析"),a("code",[t._v("CSS")]),t._v("生成"),a("code",[t._v("CSSOM Tree")]),t._v("，两者结合生成"),a("code",[t._v("render tree")]),t._v("渲染树，最后浏览器根据渲染树渲染至页面。由此可以看出"),a("code",[t._v("DOM Tree")]),t._v("的解析和"),a("code",[t._v("CSSOM Tree")]),t._v("的解析是互不影响的，两者是并行的。因此"),a("code",[t._v("CSS")]),t._v("不会阻塞页面"),a("code",[t._v("DOM")]),t._v("的解析，但是由于"),a("code",[t._v("render tree")]),t._v("的生成是依赖"),a("code",[t._v("DOM Tree")]),t._v("和"),a("code",[t._v("CSSOM Tree")]),t._v("的，因此"),a("code",[t._v("CSS")]),t._v("必然会阻塞"),a("code",[t._v("DOM")]),t._v("的渲染。")]),t._v(" "),a("p",[t._v("  更为严谨一点的说，"),a("code",[t._v("CSS")]),t._v("会阻塞"),a("code",[t._v("render tree")]),t._v("的生成，进而会阻塞"),a("code",[t._v("DOM")]),t._v("的渲染。")]),t._v(" "),a("h2",{attrs:{id:"js-会阻塞-dom-解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js-会阻塞-dom-解析"}},[t._v("#")]),t._v(" JS 会阻塞 DOM 解析")]),t._v(" "),a("p",[t._v("  为了避免加载"),a("code",[t._v("CSS")]),t._v("造成的干扰，如下仅关注"),a("code",[t._v("JS")]),t._v("的执行情况，其中"),a("code",[t._v("for")]),t._v("循环的循环体中逻辑暂不考虑，仅仅是让"),a("code",[t._v("JS")]),t._v("执行更多时间。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOMContentLoaded'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" arr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("hello world"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("  浏览器访问页面，初始时为空白且控制台打印"),a("code",[t._v("null")]),t._v("，浏览器"),a("code",[t._v("loading")]),t._v("短暂延时后，控制台打印出"),a("code",[t._v("p")]),t._v("标签同时页面渲染出"),a("code",[t._v("hello world")]),t._v("。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/js.gif",alt:""}})]),t._v(" "),a("p",[t._v("  以上情况很容易说明"),a("code",[t._v("JS")]),t._v("会阻塞"),a("code",[t._v("DOM")]),t._v("解析了，"),a("code",[t._v("JS")]),t._v("执行初控制台打印"),a("code",[t._v("null")]),t._v("，因为此时"),a("code",[t._v("p")]),t._v("标签还未被解析，"),a("code",[t._v("for")]),t._v("循环执行时，可以明显感觉到执行耗时，执行完成"),a("code",[t._v("p")]),t._v("标签被解析，此时触发"),a("code",[t._v("DOMContentLoaded")]),t._v("事件，控制台打印出"),a("code",[t._v("p")]),t._v("标签，同时页面渲染出"),a("code",[t._v("hello world")]),t._v("。")]),t._v(" "),a("p",[t._v("  比较合理的解释就是，首先浏览器无法知晓"),a("code",[t._v("JS")]),t._v("的具体内容，倘若先解析"),a("code",[t._v("DOM")]),t._v("，万一"),a("code",[t._v("JS")]),t._v("内部全部删除掉"),a("code",[t._v("DOM")]),t._v("，那么浏览器就白忙活了，所以就干脆暂停解析"),a("code",[t._v("DOM")]),t._v("，等到"),a("code",[t._v("JS")]),t._v("执行完成再继续解析。")]),t._v(" "),a("h2",{attrs:{id:"css-会阻塞-js-的执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css-会阻塞-js-的执行"}},[t._v("#")]),t._v(" CSS 会阻塞 JS 的执行")]),t._v(" "),a("p",[t._v("  如下在页内"),a("code",[t._v("JS")]),t._v("脚本前插入"),a("code",[t._v("<link>")]),t._v("标签，并且延时"),a("code",[t._v("3s")]),t._v("获取"),a("code",[t._v("CSS")]),t._v("样式。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOMContentLoaded'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("link rel"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stylesheet"')]),t._v(" href"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./static/style.css?sleep=3000"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./static/index.js"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("hello world"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("  初始页面空白，浏览器"),a("code",[t._v("loading")]),t._v("加载"),a("code",[t._v("3s")]),t._v("后，控制台打印出"),a("code",[t._v("null")]),t._v("，紧接着打印出"),a("code",[t._v("p")]),t._v("标签，同时页面渲染出浅蓝色"),a("code",[t._v("p")]),t._v("标签。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/css-js.gif",alt:""}})]),t._v(" "),a("p",[t._v("  此情况好像是"),a("code",[t._v("CSS")]),t._v("不仅阻塞了"),a("code",[t._v("DOM")]),t._v("的解析，并且也阻塞了"),a("code",[t._v("DOM")]),t._v("渲染。")]),t._v(" "),a("p",[t._v("  但是首先要思考下是什么阻塞了"),a("code",[t._v("DOM")]),t._v("的解析，刚刚已经证明了"),a("code",[t._v("CSS")]),t._v("不会阻塞"),a("code",[t._v("DOM")]),t._v("的解析，所以只可能是"),a("code",[t._v("JS")]),t._v("阻塞了"),a("code",[t._v("DOM")]),t._v("解析。但是"),a("code",[t._v("JS")]),t._v("只有两行代码，不会阻塞长达"),a("code",[t._v("3s")]),t._v("左右的时间。所以只有一个可能就是"),a("code",[t._v("CSS")]),t._v("会阻塞"),a("code",[t._v("JS")]),t._v("的执行。")]),t._v(" "),a("p",[t._v("  因此输出结果也能大致分析出来了，首先解析到第一个"),a("code",[t._v("<script>")]),t._v("标签，"),a("code",[t._v("document")]),t._v("绑定上"),a("code",[t._v("DOMContentLoaded")]),t._v("事件，紧接着解析到"),a("code",[t._v("link")]),t._v("标签，浏览器请求"),a("code",[t._v("CSS")]),t._v("样式，由于"),a("code",[t._v("CSS")]),t._v("不会阻塞"),a("code",[t._v("DOM")]),t._v("解析，因此浏览器继续向下解析，发现第二个"),a("code",[t._v("<script>")]),t._v("标签，浏览器请求"),a("code",[t._v("JS")]),t._v("脚本，此时"),a("code",[t._v("JS")]),t._v("获取完成，但是由于"),a("code",[t._v("CSS")]),t._v("还在获取，"),a("code",[t._v("JS")]),t._v("需要一直等待其获取完成，所以不能立即执行。")]),t._v(" "),a("p",[t._v("  而第二个"),a("code",[t._v("<script>")]),t._v("不能立即执行，导致它后面的"),a("code",[t._v("p")]),t._v("标签也没办法解析，原因则是"),a("code",[t._v("JS")]),t._v("会阻塞"),a("code",[t._v("DOM")]),t._v("解析。只有等待到"),a("code",[t._v("CSS")]),t._v("样式获取成功后，此时"),a("code",[t._v("JS")]),t._v("立即执行，控制台输出"),a("code",[t._v("null")]),t._v("，然后浏览器继续解析到"),a("code",[t._v("p")]),t._v("标签，解析完成，"),a("code",[t._v("DOMContentLoaded")]),t._v("事件触发，控制台输出"),a("code",[t._v("p")]),t._v("标签，最后浅蓝色"),a("code",[t._v("hello world")]),t._v("渲染至页面。")]),t._v(" "),a("p",[t._v("  其实这样做也是有道理的，设想"),a("code",[t._v("JS")]),t._v("脚本中的内容是获取"),a("code",[t._v("DOM")]),t._v("元素的"),a("code",[t._v("CSS")]),t._v("样式属性，如果"),a("code",[t._v("JS")]),t._v("想要获取到"),a("code",[t._v("DOM")]),t._v("最新的正确的样式，势必需要所有的"),a("code",[t._v("CSS")]),t._v("加载完成，否则获取的样式可能是错误或者不是最新的。因此要等到"),a("code",[t._v("JS")]),t._v("脚本前面的"),a("code",[t._v("CSS")]),t._v("加载完成，"),a("code",[t._v("JS")]),t._v("才能再执行，并且不管"),a("code",[t._v("JS")]),t._v("脚本中是否获取"),a("code",[t._v("DOM")]),t._v("元素的样式，浏览器都要这样做。")]),t._v(" "),a("p",[t._v("  回溯文章开头的那个疑问，所以一般将"),a("code",[t._v("<script>")]),t._v("放在"),a("code",[t._v("<link>")]),t._v("标签前面是有道理的。")]),t._v(" "),a("h2",{attrs:{id:"js-会触发页面渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js-会触发页面渲染"}},[t._v("#")]),t._v(" JS 会触发页面渲染")]),t._v(" "),a("p",[t._v("  如下"),a("code",[t._v("CSS")]),t._v("采用页内方式，其中颜色名及其"),a("code",[t._v("rgb")]),t._v("值分别为浅绿色"),a("code",[t._v("lightgreen")]),t._v("（"),a("code",[t._v("rgb(144, 238, 144)")]),t._v("）、粉色"),a("code",[t._v("pink")]),t._v("（"),a("code",[t._v("rgb(255, 192, 203)")]),t._v("）。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// index.html")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    p "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" lightgreen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("hello"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./static/index.js?sleep=2000"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("beautiful"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    p "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" pink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./static/index.js?sleep=4000"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("world"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    p "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" lightblue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// static/index.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" style "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getComputedStyle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("color"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("  页面初始渲染出浅绿色"),a("code",[t._v("hello")]),t._v("，紧接着"),a("code",[t._v("2s")]),t._v("后渲染出粉色"),a("code",[t._v("hello beautiful")]),t._v("且控制台打印"),a("code",[t._v("rgb(144, 238, 144)")]),t._v("，然后又"),a("code",[t._v("2s")]),t._v("后渲染出浅蓝色"),a("code",[t._v("hello beautiful world")]),t._v("且控制台打印"),a("code",[t._v("rgb(255, 192, 203)")]),t._v("。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/js-draw.gif",alt:""}})]),t._v(" "),a("p",[t._v("  上述结果大致分析为浏览器首先解析第一个"),a("code",[t._v("<style>")]),t._v("标签和"),a("code",[t._v("hello")]),t._v("文本的"),a("code",[t._v("p")]),t._v("标签，此时继续向下解析发现了第一个"),a("code",[t._v("<script>")]),t._v("标签，紧接着触发一次渲染，由于此过程非常快所以页面初始就能看到浅绿色"),a("code",[t._v("hello")]),t._v("。")]),t._v(" "),a("p",[t._v("  然后浏览器发出"),a("code",[t._v("JS")]),t._v("请求，"),a("code",[t._v("2s")]),t._v("后"),a("code",[t._v("JS")]),t._v("获取完成立即运行控制台输出"),a("code",[t._v("rgb(144, 238, 144)")]),t._v("，"),a("code",[t._v("JS")]),t._v("运行完成后浏览器继续向下解析到"),a("code",[t._v("beautiful")]),t._v("文本的"),a("code",[t._v("p")]),t._v("标签和第二个"),a("code",[t._v("<style>")]),t._v("标签，再继续向下解析发现了第二个"),a("code",[t._v("<script>")]),t._v("标签，触发一次渲染，这个过程也是非常快，所以可以看到控制台输出结果和渲染粉色"),a("code",[t._v("hello beautiful")]),t._v("几乎是同时的。")]),t._v(" "),a("p",[t._v("  解析到第二个"),a("code",[t._v("<script>")]),t._v("标签时，浏览器不会发出请求（稍作解释），"),a("code",[t._v("2s")]),t._v("后获取到"),a("code",[t._v("JS")]),t._v("脚本并执行，控制台输出"),a("code",[t._v("rgb(255, 192, 203)")]),t._v("，紧接着浏览器继续向下解析到"),a("code",[t._v("world")]),t._v("文本的"),a("code",[t._v("p")]),t._v("标签和第三个"),a("code",[t._v("<style>")]),t._v("标签，此时"),a("code",[t._v("DOM")]),t._v("解析完成，再进行正常的渲染，这个过程也是非常快，所以也能看到控制台输出结果和渲染浅蓝色"),a("code",[t._v("hello beautiful world")]),t._v("几乎是同时的。")]),t._v(" "),a("p",[t._v("  现在来解答刚才那个问题，浏览器解析"),a("code",[t._v("DOM")]),t._v("时，虽然会一行一行向下解析，但是它会预先加载具有引用标记的外部资源（例如带有"),a("code",[t._v("src")]),t._v("标记的"),a("code",[t._v("<script>")]),t._v("标签），而在解析到此标签时，则无需再去加载，直接运行，以此提高运行效率。所以就会有上述两个输出结果间隔"),a("code",[t._v("2s")]),t._v("的情况，而不是"),a("code",[t._v("4s")]),t._v("，因为浏览器预先就一起加载了两个"),a("code",[t._v("<script>")]),t._v("脚本，第一个"),a("code",[t._v("<script>")]),t._v("脚本加载完成时，第二个"),a("code",[t._v("<script>")]),t._v("脚本还剩大概"),a("code",[t._v("2s")]),t._v("加载完成。")]),t._v(" "),a("p",[t._v("  而这个结论才是解释为何"),a("code",[t._v("CSS")]),t._v("会阻塞"),a("code",[t._v("JS")]),t._v("的执行的真正原因，浏览器无法预先知道脚本的具体内容，因此在碰到"),a("code",[t._v("<script>")]),t._v("标签时，只好先渲染一次页面，确保"),a("code",[t._v("<script>")]),t._v("脚本内能获取到"),a("code",[t._v("DOM")]),t._v("的最新的样式。倘若在决定渲染页面时，还有尚未加载完成的"),a("code",[t._v("CSS")]),t._v("样式，只能等待其加载完成再去渲染页面。")]),t._v(" "),a("h2",{attrs:{id:"body-内的-css"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#body-内的-css"}},[t._v("#")]),t._v(" Body 内的 CSS")]),t._v(" "),a("p",[t._v("  来看一个较为特殊的情况。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOMContentLoaded'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("hello"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("link rel"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stylesheet"')]),t._v(" href"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./static/style.css?sleep=3000"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("world"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("  按照上述的所有结论，预先分析一下运行结果，首先浏览器解析"),a("code",[t._v("<script>")]),t._v("脚本，"),a("code",[t._v("document")]),t._v("上绑定了"),a("code",[t._v("DOMContentLoaded")]),t._v("事件，紧接着浏览器继续向下解析，发现了文本为"),a("code",[t._v("hello")]),t._v("的"),a("code",[t._v("p")]),t._v("标签和"),a("code",[t._v("<link>")]),t._v("标签，浏览器发起"),a("code",[t._v("CSS")]),t._v("请求，由于"),a("code",[t._v("CSS")]),t._v("不会阻塞"),a("code",[t._v("DOM")]),t._v("解析，浏览器继续向下解析至文本为"),a("code",[t._v("world")]),t._v("的"),a("code",[t._v("p")]),t._v("标签，此时页面解析完成，"),a("code",[t._v("DOMContentLoaded")]),t._v("事件触发控制台输出"),a("code",[t._v("p")]),t._v("标签，"),a("code",[t._v("3s")]),t._v("后页面渲染出浅蓝色"),a("code",[t._v("hello world")]),t._v("。")]),t._v(" "),a("p",[t._v("  因此初始时页面空白，浏览器"),a("code",[t._v("loading")]),t._v("加载"),a("code",[t._v("3s")]),t._v("后，控制台打印出"),a("code",[t._v("p")]),t._v("标签，同时页面渲染出浅蓝色"),a("code",[t._v("hello world")]),t._v("。")]),t._v(" "),a("p",[t._v("  但是实际结果并不是这样，先来看看"),a("code",[t._v("Chrome")]),t._v("浏览器下的表现。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/Chrome.gif",alt:""}})]),t._v(" "),a("p",[t._v("  再来看看"),a("code",[t._v("Firefox")]),t._v("浏览器下的表现。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/Firefox.gif",alt:""}})]),t._v(" "),a("p",[t._v("  接着再来看看"),a("code",[t._v("Opera")]),t._v("浏览器下的表现。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/Opera.gif",alt:""}})]),t._v(" "),a("p",[t._v("  ;"),a("code",[t._v("IE11")]),t._v("及以下浏览器的表现。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/IE11.gif",alt:""}})]),t._v(" "),a("p",[t._v("  ;"),a("code",[t._v("Edge")]),t._v("浏览器下的表现。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/html/perform/block-dom/Edge.gif",alt:""}})]),t._v(" "),a("p",[t._v("  怎么样，蒙了吧，"),a("code",[t._v("5")]),t._v("种浏览器"),a("code",[t._v("3")]),t._v("种表现形式，并且没有一种表现与预先分析的一致。")]),t._v(" "),a("p",[t._v("  其实造成这种差异的原因，是一种被称为浏览器样式闪烁（"),a("a",{attrs:{href:"https://webkit.org/blog/66/the-fouc-problem/",target:"_blank",rel:"noopener noreferrer"}},[t._v("FOUC"),a("OutboundLink")],1),t._v("，"),a("code",[t._v("Flash of Unstyled Content")]),t._v("）的现象。")]),t._v(" "),a("p",[t._v("  由于浏览器引擎的架构方式不一致，在浏览器解析到"),a("code",[t._v("Body")]),t._v("内的"),a("code",[t._v("CSS")]),t._v("的时候，浏览器引擎是可以做出选择的。")]),t._v(" "),a("p",[t._v("  一种选择是它可以在请求"),a("code",[t._v("CSS")]),t._v("的时候暂停后续"),a("code",[t._v("DOM")]),t._v("的解析，在"),a("code",[t._v("CSS")]),t._v("加载完成后再继续往后解析，此情况就会造成"),a("code",[t._v("CSS")]),t._v("阻塞"),a("code",[t._v("DOM")]),t._v("的解析，导致页面"),a("code",[t._v("DOM")]),t._v("解析及其样式渲染推迟，而此表现形式就与"),a("code",[t._v("JS")]),t._v("的情况相似。")]),t._v(" "),a("p",[t._v("  另一种选择是它也可以在请求"),a("code",[t._v("CSS")]),t._v("的时候继续往后解析，此时"),a("code",[t._v("CSS")]),t._v("的加载与"),a("code",[t._v("DOM")]),t._v("的解析就是并行的，等到"),a("code",[t._v("CSS")]),t._v("加载完成后再更新样式，此情况下部分"),a("code",[t._v("DOM")]),t._v("样式就会从默认样式立即跳转到有样式状态，形成样式闪烁。")]),t._v(" "),a("p",[t._v("  此小结不必太过于纠结，只需记住"),a("code",[t._v("Body")]),t._v("内的"),a("code",[t._v("CSS")]),t._v("会由于浏览器的差异，呈现不同的表现形式，而这种现象一般称为"),a("code",[t._v("FOUC")]),t._v("，代码中应当极力避免此种情况发生即可。")]),t._v(" "),a("h2",{attrs:{id:"综上所述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#综上所述"}},[t._v("#")]),t._v(" 综上所述")]),t._v(" "),a("p",[t._v("  综合上述所有情况，可以得出如下结论。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("CSS")]),t._v("不会阻塞"),a("code",[t._v("DOM")]),t._v("解析，但是会阻塞"),a("code",[t._v("DOM")]),t._v("渲染，严谨一点则是"),a("code",[t._v("CSS")]),t._v("会阻塞"),a("code",[t._v("render tree")]),t._v("的生成，进而会阻塞"),a("code",[t._v("DOM")]),t._v("的渲染")]),t._v(" "),a("li",[a("code",[t._v("JS")]),t._v("会阻塞"),a("code",[t._v("DOM")]),t._v("解析")]),t._v(" "),a("li",[a("code",[t._v("CSS")]),t._v("会阻塞"),a("code",[t._v("JS")]),t._v("的执行")]),t._v(" "),a("li",[t._v("浏览器遇到"),a("code",[t._v("<script>")]),t._v("标签且没有"),a("code",[t._v("defer")]),t._v("或"),a("code",[t._v("async")]),t._v("属性时会触发页面渲染")]),t._v(" "),a("li",[a("code",[t._v("Body")]),t._v("内部的外链"),a("code",[t._v("CSS")]),t._v("较为特殊，会形成"),a("code",[t._v("FOUC")]),t._v("现象，请慎用")])]),t._v(" "),a("h2",{attrs:{id:"🎉-写在最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🎉-写在最后"}},[t._v("#")]),t._v(" 🎉 写在最后")]),t._v(" "),a("p",[t._v("🍻伙伴们，如果你已经看到了这里，觉得这篇文章有帮助到你的话不妨点赞👍或 "),a("a",{attrs:{href:"https://github.com/dongwei1125/blog",target:"_blank",rel:"noopener noreferrer"}},[t._v("Star"),a("OutboundLink")],1),t._v(" ✨支持一下哦！")]),t._v(" "),a("p",[t._v("手动码字，如有错误，欢迎在评论区指正💬~")]),t._v(" "),a("p",[t._v("你的支持就是我更新的最大动力💪~")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/dongwei1125",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),a("OutboundLink")],1),t._v(" / "),a("a",{attrs:{href:"https://gitee.com/dongwei1125",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gitee"),a("OutboundLink")],1),t._v("、"),a("a",{attrs:{href:"https://dongwei1125.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Pages"),a("OutboundLink")],1),t._v("、"),a("a",{attrs:{href:"https://juejin.cn/user/2621689331987783",target:"_blank",rel:"noopener noreferrer"}},[t._v("掘金"),a("OutboundLink")],1),t._v("、"),a("a",{attrs:{href:"https://blog.csdn.net/Don_GW",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSDN"),a("OutboundLink")],1),t._v(" 同步更新，欢迎关注😉~")])])}),[],!1,null,null,null);s.default=n.exports}}]);