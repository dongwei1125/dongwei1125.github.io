(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{445:function(s,a,t){"use strict";t.r(a);var e=t(34),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"javascript-浮点数陷阱"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascript-浮点数陷阱"}},[s._v("#")]),s._v(" JavaScript 浮点数陷阱")]),s._v(" "),t("p",[t("img",{attrs:{src:"/js/float/banner.jpg",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("JavaScript")]),s._v("中的浮点数经常会有奇怪的运算结果，例如"),t("code",[s._v("0.1 + 0.2 != 0.3")]),s._v("或者是"),t("code",[s._v("1.005.toFixed(2)")]),s._v("结果为"),t("code",[s._v("1.00")]),s._v("，又或者"),t("code",[s._v("Number.MAX_VALUE")]),s._v("与"),t("code",[s._v("Number.MAX_SAFE_INTEGER")]),s._v("的区别等等。")]),s._v(" "),t("p",[s._v("  此处对"),t("code",[s._v("JavaScript")]),s._v("浮点数的存储标准和以上疑问做了比较细致的整理，希望对你有用。")]),s._v(" "),t("h2",{attrs:{id:"ieee-754"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ieee-754"}},[s._v("#")]),s._v(" IEEE 754")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("JavaScript")]),s._v("与其它语言不同，"),t("code",[s._v("Number")]),s._v("类型是不区分整型和浮点的。对于所有的数字包括整数和小数相同存储，遵循"),t("code",[s._v("IEEE 754")]),s._v("的双精度标准，"),t("code",[s._v("64")]),s._v("位固定长度，也即是常说的"),t("code",[s._v("double")]),s._v("类型。")]),s._v(" "),t("p",[s._v("  由于整数和小数都采用"),t("code",[s._v("64")]),s._v("位存储，对于内存来说整型和浮点型也就没有区别了。")]),s._v(" "),t("blockquote",[t("p",[s._v("位运算上，会将操作数转为"),t("code",[s._v("32")]),s._v("位有符号数，小数部分直接丢弃")])]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("64")]),s._v("位比特包括三个部分。")]),s._v(" "),t("ul",[t("li",[s._v("符号位（"),t("code",[s._v("S")]),s._v("，"),t("code",[s._v("sign")]),s._v("）：第"),t("code",[s._v("63")]),s._v("位，"),t("code",[s._v("0")]),s._v("表示正数，"),t("code",[s._v("1")]),s._v("表示负数")]),s._v(" "),t("li",[s._v("指数位（"),t("code",[s._v("E")]),s._v("，"),t("code",[s._v("exponent")]),s._v("）：第"),t("code",[s._v("52")]),s._v("到"),t("code",[s._v("62")]),s._v("位，共"),t("code",[s._v("11")]),s._v("位，取值范围为"),t("code",[s._v("0~2047")]),s._v("。但是指数位是可以为负数的，偏移"),t("code",[s._v("2023")]),s._v("后取值范围变为"),t("code",[s._v("[-1023, 1024]")])]),s._v(" "),t("li",[s._v("尾数位（"),t("code",[s._v("M")]),s._v("，"),t("code",[s._v("mantissa")]),s._v("）：第"),t("code",[s._v("0")]),s._v("到"),t("code",[s._v("51")]),s._v("位，共"),t("code",[s._v("52")]),s._v("位。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/js/float/ieee.png",alt:""}})]),s._v(" "),t("p",[s._v("  计算公式为。")]),s._v(" "),t("LaTeX",[s._v("V=(-1)^S2^{E-1023}(M+1)")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("11.25")]),s._v("的"),t("code",[s._v("64")]),s._v("位表示。")]),s._v(" "),t("ul",[t("li",[s._v("将整数和小数部分转换成二进制，即"),t("code",[s._v("11.25 = 1011.01")])]),s._v(" "),t("li",[s._v("移动小数点，使其位于第"),t("code",[s._v("1")]),s._v("、"),t("code",[s._v("2")]),s._v("位之间，规范化为"),t("code",[s._v("1.01101 * 2 ^ 3")])]),s._v(" "),t("li",[t("code",[s._v("11.25")]),s._v("为正数，"),t("code",[s._v("S = 0")]),s._v("。另外指数为"),t("code",[s._v("3")]),s._v("，则"),t("code",[s._v("E = 1023 + 3 = 1026")]),s._v("，即"),t("code",[s._v("100 0000 0010")])]),s._v(" "),t("li",[s._v("舍去整数部分"),t("code",[s._v("1")]),s._v("，剩下尾数部分"),t("code",[s._v("01101")]),s._v("，空位补"),t("code",[s._v("0")]),s._v("，即"),t("code",[s._v("0110 1000 ... 0000")]),s._v("（"),t("code",[s._v("52")]),s._v("位）")]),s._v(" "),t("li",[t("code",[s._v("11.25")]),s._v("的"),t("code",[s._v("64")]),s._v("位浮点数的二进制表示为"),t("code",[s._v("0 10000000010 01101000...0000")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"/js/float/11.25.png",alt:""}})]),s._v(" "),t("p",[s._v("  ("),t("a",{attrs:{href:"http://www.binaryconvert.com/convert_double.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("图片来源"),t("OutboundLink")],1),s._v(")")]),s._v(" "),t("blockquote",[t("p",[s._v("规范化后的整数部分必然为"),t("code",[s._v("1")]),s._v("，存储时可以省略，只记录小数点之后的部分, 也就节约了一位内存")])]),s._v(" "),t("h2",{attrs:{id:"就近舍入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#就近舍入"}},[s._v("#")]),s._v(" 就近舍入")]),s._v(" "),t("p",[s._v("  在四舍五入中，"),t("code",[s._v("0 ~ 9")]),s._v("十个数，"),t("code",[s._v("0")]),s._v("比较特殊，不会存在舍去的情况，舍不舍去都是当前数。而剩下的"),t("code",[s._v("9")]),s._v("个数中，"),t("code",[s._v("1 ~ 4")]),s._v("舍去，"),t("code",[s._v("5 ~ 9")]),s._v("上入，概率上舍去为"),t("code",[s._v("4 / 9")]),s._v("，上入为"),t("code",[s._v("5 / 9")]),s._v("，因此并不是公平的。")]),s._v(" "),t("p",[s._v("  就近舍入，或者叫银行家舍入，是四舍六入五成双。即"),t("code",[s._v("1 ~ 4")]),s._v("舍去，"),t("code",[s._v("6 ~ 9")]),s._v("上入，"),t("code",[s._v("5")]),s._v("的情况则看前一位是奇数还是偶数，偶数则舍去，奇数则上入，因此概率都是"),t("code",[s._v("50%")]),s._v("，更加合理。")]),s._v(" "),t("p",[s._v("  二进制中的就近舍入，其中"),t("code",[s._v("1001")]),s._v("大于"),t("code",[s._v("1000")]),s._v("则上入"),t("code",[s._v("1")]),s._v("，"),t("code",[s._v("0111")]),s._v("小于"),t("code",[s._v("1000")]),s._v("则舍去，而对于"),t("code",[s._v("1000")]),s._v("的情况，看前一位是奇数还是偶数，若为"),t("code",[s._v("0")]),s._v("则舍去，为"),t("code",[s._v("1")]),s._v("则上入"),t("code",[s._v("1")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.010")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.001")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.010")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.101")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.100")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.100")]),s._v("\n")])])]),t("h2",{attrs:{id:"number-max-value"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#number-max-value"}},[s._v("#")]),s._v(" Number.MAX_VALUE")]),s._v(" "),t("p",[s._v("  ;"),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_VALUE",target:"_blank",rel:"noopener noreferrer"}},[s._v("Number.MAX_VALUE"),t("OutboundLink")],1),s._v(" 即"),t("code",[s._v("JavaScript")]),s._v("中所能表示的最大数值。")]),s._v(" "),t("p",[s._v("  按照"),t("code",[s._v("IEEE 754")]),s._v("的"),t("code",[s._v("64")]),s._v("位标准，可以明显想到以下表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v("\n")])])]),t("p",[s._v("  但是注意指数位全为"),t("code",[s._v("1")]),s._v("用来表示"),t("code",[s._v("NaN")]),s._v("或"),t("code",[s._v("Infinity")]),s._v("，因此指数位最大为"),t("code",[s._v("111 1111 1110")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v("\n")])])]),t("p",[s._v("  转为十进制。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2046")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1023")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1023")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1023")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("52")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("971")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("971")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.7976931348623157e+308")]),s._v("\n")])])]),t("p",[s._v("  也即是"),t("code",[s._v("Number.MAX_VALUE")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("971")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.7976931348623157e+308")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" Math"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("971")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" Number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MAX_VALUE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// true")]),s._v("\n")])])]),t("h2",{attrs:{id:"number-max-safe-integer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#number-max-safe-integer"}},[s._v("#")]),s._v(" Number.MAX_SAFE_INTEGER")]),s._v(" "),t("p",[s._v("  ;"),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER",target:"_blank",rel:"noopener noreferrer"}},[s._v("Number.MAX_SAFE_INTEGER"),t("OutboundLink")],1),s._v(" 表示"),t("code",[s._v("JavaScript")]),s._v("中最大的安全整数。")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("Number.MAX_SAFE_INTEGER")]),s._v("二进制表示，注意指数刚好为"),t("code",[s._v("52")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000110011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v("\n")])])]),t("p",[s._v("  转为十进制。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1075")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1023")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("52")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9007199254740991")]),s._v("\n")])])]),t("p",[s._v("  然后来说说为什么叫安全整数，指的是当前整数转换为二进制时，可以完全存储在尾数位中，不会发生舍入。")]),s._v(" "),t("p",[s._v("  而"),t("code",[s._v("Number.MAX_SAFE_INTEGER + 1")]),s._v("和"),t("code",[s._v("Number.MAX_SAFE_INTEGER + 2")]),s._v("都会存在舍去的情况。")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("Number.MAX_SAFE_INTEGER + 2")]),s._v("，"),t("code",[s._v("9007199254740993")]),s._v("的二进制表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000000000000000000000000000000000000000000000000001")]),s._v("\n")])])]),t("p",[s._v("  规范化。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00000000000000000000000000000000000000000000000000001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v("\n")])])]),t("p",[s._v("  由于指数位只能容纳"),t("code",[s._v("52")]),s._v("位，低位为"),t("code",[s._v("1")]),s._v("且前一位为"),t("code",[s._v("0")]),s._v("，就近舍入时会被舍去。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),s._v("\n")])])]),t("p",[s._v("  ;"),t("code",[s._v("64")]),s._v("位浮点数表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000110100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),s._v("\n")])])]),t("p",[s._v("  另外"),t("code",[s._v("Number.MAX_SAFE_INTEGER + 1")]),s._v("，也会存在舍去的情况。")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("9007199254740992")]),s._v("的浮点数表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000110100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),s._v("\n")])])]),t("p",[s._v("  因此会造成以下结果。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("Number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MAX_SAFE_INTEGER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" Number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MAX_SAFE_INTEGER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// true")]),s._v("\n")])])]),t("h2",{attrs:{id:"_0-1-0-2-0-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-1-0-2-0-3"}},[s._v("#")]),s._v(" 0.1 + 0.2 != 0.3")]),s._v(" "),t("h3",{attrs:{id:"_0-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-1"}},[s._v("#")]),s._v(" 0.1")]),s._v(" "),t("p",[s._v("  先来将"),t("code",[s._v("0.1")]),s._v("转换为二进制，连续乘以"),t("code",[s._v("2")]),s._v("并取整。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 整 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 余 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 整 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 余 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 整 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 余 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.6")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 整 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 余 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.6")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 整 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 余 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 整 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 余 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v("\n")])])]),t("p",[s._v("  ;"),t("code",[s._v("0.1")]),s._v("的二进制表示，"),t("code",[s._v("0011")]),s._v("将无限循环下去。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("  规范化，另外"),t("code",[s._v("0.1")]),s._v("为正数，"),t("code",[s._v("S = 0")]),s._v("，指数为"),t("code",[s._v("-4 + 1023 = 1019")]),s._v("，即"),t("code",[s._v("011 1111 1011")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n")])])]),t("p",[s._v("  尾数位最多存储"),t("code",[s._v("52")]),s._v("位，且采用就近舍入模式，向前进"),t("code",[s._v("1")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v("\n")])])]),t("p",[s._v("  ;"),t("code",[s._v("0.1")]),s._v("的"),t("code",[s._v("64")]),s._v("位浮点数表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v("\n")])])]),t("p",[t("img",{attrs:{src:"/js/float/0.1.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"_0-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-2"}},[s._v("#")]),s._v(" 0.2")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("0.2")]),s._v("的二进制。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("  规范化"),t("code",[s._v("0.2")]),s._v("，"),t("code",[s._v("S = 0")]),s._v("，指数为"),t("code",[s._v("-3 + 1023 = 1020")]),s._v("，即"),t("code",[s._v("011 1111 1100")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])])]),t("p",[s._v("  存储"),t("code",[s._v("52")]),s._v("位，其余舍去，向前进"),t("code",[s._v("1")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v("\n")])])]),t("p",[s._v("  ;"),t("code",[s._v("0.2")]),s._v("的"),t("code",[s._v("64")]),s._v("位浮点数表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v("\n")])])]),t("p",[t("img",{attrs:{src:"/js/float/0.2.png",alt:""}})]),s._v(" "),t("p",[s._v("  因此实际上"),t("code",[s._v("0.1")]),s._v("和"),t("code",[s._v("0.2")]),s._v("转换为"),t("code",[s._v("64")]),s._v("位的双精度浮点数时，都存在精度损失。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0.1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0.2")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("浮点数运算三步骤，对阶、求和、规范化")])]),s._v(" "),t("h3",{attrs:{id:"对阶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对阶"}},[s._v("#")]),s._v(" 对阶")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("0.1")]),s._v("和"),t("code",[s._v("0.2")]),s._v("的指数部分阶次不一致，要先统一阶次，且遵循小阶向大阶看齐的原则。")]),s._v(" "),t("p",[s._v("  比如十进制的"),t("code",[s._v("1.5 * 10 ^ 10 + 1.23 * 10 ^ 13")]),s._v("，保留小数点前后"),t("code",[s._v("1")]),s._v("位。")]),s._v(" "),t("ul",[t("li",[s._v("大阶向小阶看齐时，即"),t("code",[s._v("1.5 * 10 ^ 10 + 1230 * 10 ^ 10")]),s._v("，结果为"),t("code",[s._v("1231.5 * 10 ^ 10")]),s._v("，规则舍弃后为"),t("code",[s._v("1.5 * 10 ^ 10")])]),s._v(" "),t("li",[s._v("小阶向大阶看齐时，即"),t("code",[s._v("0.0015 * 10 ^ 13 + 1.23 * 10 ^ 13")]),s._v("，结果为"),t("code",[s._v("1.2315 * 10 ^ 13")]),s._v("，规则舍弃后为"),t("code",[s._v("1.2 * 10 ^ 13")])])]),s._v(" "),t("p",[s._v("  明显看到小阶向大阶更能接近实际结果。另外阶次若加"),t("code",[s._v("1")]),s._v("，尾数位就要右移"),t("code",[s._v("1")]),s._v("位，阶次相同时对阶完成。")]),s._v(" "),t("p",[s._v("  为什么阶次加"),t("code",[s._v("1")]),s._v("尾数位就右移"),t("code",[s._v("1")]),s._v("位呢？")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("0.1")]),s._v("的"),t("code",[s._v("64")]),s._v("位浮点数表示，值为"),t("code",[s._v("1.1001 1001 ... 1001 1001 1010 * 2 ^ -4")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v("\n")])])]),t("p",[s._v("  此处若阶次加"),t("code",[s._v("1")]),s._v("，要保持值大小不变，小数点要左移"),t("code",[s._v("1")]),s._v("位，即"),t("code",[s._v("0.1 1001 1001 ... 1001 1001 1010 * 2 ^ -3")]),s._v("，也就相当于尾数位右移"),t("code",[s._v("1")]),s._v("位。右移后空位补"),t("code",[s._v("1")]),s._v("，也就是省略的整数部分的"),t("code",[s._v("1")]),s._v("。注意若还要右移，空位只能补"),t("code",[s._v("0")]),s._v("，原因在于整数部分后续都是"),t("code",[s._v("0")]),s._v("了。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1100110011001100110011001100110011001100110011001101")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("  因此对阶过程如下，由于低位为"),t("code",[s._v("0")]),s._v("，可以省去。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0.1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111100")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100110011001100110011001100110011001100110011001101")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 阶次加 1，尾数位右移 1 位")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1100110011001100110011001100110011001100110011001101")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 空位补 1")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("注意尾数位右移是将低位移出，会损失一定的精度，为了减小误差，将保留若干移出的位，在以后的规范化时再做舍入")])]),s._v(" "),t("h3",{attrs:{id:"求和"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#求和"}},[s._v("#")]),s._v(" 求和")]),s._v(" "),t("p",[s._v("  阶数相同，开始求和。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1100110011001100110011001100110011001100110011001101")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0.1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001100110011001100110011001100110011001100110011010")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0.2")]),s._v("\n")])])]),t("p",[s._v("  更好理解的方式，注意尾数位产生了进位。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1100110011001100110011001100110011001100110011001101")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1001100110011001100110011001100110011001100110011010")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0110011001100110011001100110011001100110011001100111")]),s._v("\n")])])]),t("h3",{attrs:{id:"规范化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#规范化"}},[s._v("#")]),s._v(" 规范化")]),s._v(" "),t("p",[s._v("  求和结果为"),t("code",[s._v("10.0 1100 1100 ... 1100 1100 111 * 2 ^ -3")]),s._v("，即"),t("code",[s._v("1.00 1100 1100 ... 1100 1100 111 * 2 ^ -2")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00110011001100110011001100110011001100110011001100111")]),s._v("\n")])])]),t("p",[s._v("  由于指数位只能容纳"),t("code",[s._v("52")]),s._v("位，就近舍入后向前进"),t("code",[s._v("1")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011001100110011001100110011001100110011001100110011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011001100110011001100110011001100110011001100110100")]),s._v("\n")])])]),t("p",[s._v("  ;"),t("code",[s._v("IEEE 754")]),s._v("的双精度"),t("code",[s._v("64")]),s._v("位表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111101")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011001100110011001100110011001100110011001100110100")]),s._v("\n")])])]),t("p",[s._v("  即"),t("code",[s._v("1.0011 0011 ... 0011 0011 0100 * 2 ^ -2")]),s._v("，转换为十进制也就是"),t("code",[s._v("0.30000000000000004")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),t("p",[s._v("  要明确的是，诸如"),t("code",[s._v("0.1")]),s._v("、"),t("code",[s._v("0.2")]),s._v("之类的数，虽然在十进制中能非常清晰地表达，但是在二进制中却是无穷尽的，无法精确表示。而"),t("code",[s._v("JavaScript")]),s._v("遵循"),t("code",[s._v("IEEE 754")]),s._v("的双精度标准，仅"),t("code",[s._v("64")]),s._v("位，进制的转换中要舍弃低位来存储，因此必然存在精度丢失。")]),s._v(" "),t("p",[s._v("  另外在相加的过程中，对阶、求和、规范化都可能存在舍入，也会存在精度的丢失。")]),s._v(" "),t("h2",{attrs:{id:"_1-005-tofixed-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-005-tofixed-2"}},[s._v("#")]),s._v(" 1.005.toFixed(2)")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("1.005")]),s._v("的二进制表示，"),t("code",[s._v("0000 1010 0011 1101 0111")]),s._v("将无限循环下去。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1010")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0011")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1101")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0111")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("  ;"),t("code",[s._v("IEEE 754")]),s._v("的双精度"),t("code",[s._v("64")]),s._v("位表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000101000111101011100001010001111010111000010100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000101000111101011100001010001111010111000010100")]),s._v("\n")])])]),t("p",[s._v("  ;"),t("code",[s._v("1.005")]),s._v("截断后面位数后，已经小于"),t("code",[s._v("1.005")]),s._v("，利用 "),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/toPrecision",target:"_blank",rel:"noopener noreferrer"}},[s._v("Number.prototype.toPrecision"),t("OutboundLink")],1),s._v(" 来看下"),t("code",[s._v("1.005")]),s._v("的"),t("code",[s._v("20")]),s._v("位精度。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/js/float/1.005.png",alt:""}})]),s._v(" "),t("p",[s._v("  因此"),t("code",[s._v("toFixed")]),s._v("保留两位小数，四舍五入时。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.005")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toFixed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.00")]),s._v("\n")])])]),t("h2",{attrs:{id:"number-max-value-1-不是-infinity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#number-max-value-1-不是-infinity"}},[s._v("#")]),s._v(" Number.MAX_VALUE + 1 不是 Infinity")]),s._v(" "),t("h3",{attrs:{id:"number-max-value-1-number-max-value"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#number-max-value-1-number-max-value"}},[s._v("#")]),s._v(" Number.MAX_VALUE + 1 === Number.MAX_VALUE")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("Number.MAX_VALUE")]),s._v("与"),t("code",[s._v("1")]),s._v("的"),t("code",[s._v("64")]),s._v("位浮点数表示为。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Number.MAX_VALUE")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1")]),s._v("\n")])])]),t("p",[s._v("  相加对阶时"),t("code",[s._v("1")]),s._v("的阶数将由"),t("code",[s._v("0")]),s._v("升到"),t("code",[s._v("1023")]),s._v("，尾数位将右移"),t("code",[s._v("1023")]),s._v("位。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Number.MAX_VALUE")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("000.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1")]),s._v("\n")])])]),t("p",[s._v("  求和。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0000000000000000000000000000000000000000000000000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("000.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("000.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("  规范化时低位将舍弃，实际相当于"),t("code",[s._v("Number.MAX_VALUE")]),s._v("加"),t("code",[s._v("0")]),s._v("，所以会有以下结果。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("Number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MAX_VALUE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" Number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MAX_VALUE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// true")]),s._v("\n")])])]),t("h3",{attrs:{id:"_2-970"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-970"}},[s._v("#")]),s._v(" 2 ^ 970")]),s._v(" "),t("p",[s._v("  那到底"),t("code",[s._v("Number.MAX_VALUE")]),s._v("加上多少等于"),t("code",[s._v("Infinity")]),s._v("呢？")]),s._v(" "),t("p",[s._v("  按照"),t("code",[s._v("IEEE 754")]),s._v("的规范，只要大于等于以下数，就会被表示为"),t("code",[s._v("Infinity")]),s._v("。")]),s._v(" "),t("LaTeX",[s._v("2^{E_{max}}(2-\\frac{2^{1-p}}{2})")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("64")]),s._v("位浮点数中，"),t("code",[s._v("E"),t("sub",[s._v("max")])]),s._v("为"),t("code",[s._v("1023")]),s._v("，"),t("code",[s._v("p")]),s._v("为"),t("code",[s._v("53")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1023")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1023")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("970")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("  此结果与"),t("code",[s._v("Number.MAX_VALUE")]),s._v("差值为。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("970")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("971")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("970")]),s._v("\n")])])]),t("p",[s._v("  因此"),t("code",[s._v("Number.MAX_VALUE")]),s._v("至少加上"),t("code",[s._v("2 ^ 970")]),s._v("才能等于"),t("code",[s._v("Infinity")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"number-max-value-2-970-infinity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#number-max-value-2-970-infinity"}},[s._v("#")]),s._v(" Number.MAX_VALUE + 2 ^ 970 === Infinity")]),s._v(" "),t("p",[s._v("  ;"),t("code",[s._v("Number.MAX_VALUE")]),s._v("与"),t("code",[s._v("2 ^ 970")]),s._v("的"),t("code",[s._v("64")]),s._v("位浮点数表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Number.MAX_VALUE")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111001001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2 ^ 970")]),s._v("\n")])])]),t("p",[s._v("  相加对阶时"),t("code",[s._v("2 ^ 970")]),s._v("阶数将由"),t("code",[s._v("970")]),s._v("升到"),t("code",[s._v("1023")]),s._v("，差值为"),t("code",[s._v("53")]),s._v("，尾数位将右移"),t("code",[s._v("53")]),s._v("位。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111111111111111111111111111111111111111111111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Number.MAX_VALUE")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111110")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2 ^ 970")]),s._v("\n")])])]),t("p",[s._v("  求和，就近舍入时，低位舍入，向前进"),t("code",[s._v("1")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0000000000000000000000000000000000000000000000000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1111111111111111111111111111111111111111111111111111")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0000000000000000000000000000000000000000000000000000")]),s._v("\n")])])]),t("p",[s._v("  注意尾数位产生了进位，指数位则加"),t("code",[s._v("1")]),s._v("，尾数位右移"),t("code",[s._v("1")]),s._v("位。")]),s._v(" "),t("p",[s._v("  结果的"),t("code",[s._v("64")]),s._v("位浮点数表示，而以下表示实际就是"),t("code",[s._v("Infinity")]),s._v("的"),t("code",[s._v("64")]),s._v("位浮点数表示。")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111111111")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000000000000000000000000000000000000000")]),s._v("\n")])])]),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/camsong/blog/issues/9",target:"_blank",rel:"noopener noreferrer"}},[s._v("JavaScript 浮点数陷阱及解法"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://0.30000000000000004.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("0.30000000000000004"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/qufei1993/Nodejs-Roadmap/blob/master/docs/javascript/floating-point-number-0.1-0.2.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("0.1 + 0.2 为什么不等于 0.3？"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/343040291",target:"_blank",rel:"noopener noreferrer"}},[s._v("为什么说 32 位浮点数的精度是 7 位有效数"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.zhihu.com/question/24423421",target:"_blank",rel:"noopener noreferrer"}},[s._v("为什么 Number.MAX_VALUE + 1 不是 Infinity?"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"🎉-写在最后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🎉-写在最后"}},[s._v("#")]),s._v(" 🎉 写在最后")]),s._v(" "),t("p",[s._v("🍻伙伴们，如果你已经看到了这里，觉得这篇文章有帮助到你的话不妨点赞👍或 "),t("a",{attrs:{href:"https://github.com/dongwei1125/blog",target:"_blank",rel:"noopener noreferrer"}},[s._v("Star"),t("OutboundLink")],1),s._v(" ✨支持一下哦！")]),s._v(" "),t("p",[s._v("手动码字，如有错误，欢迎在评论区指正💬~")]),s._v(" "),t("p",[s._v("你的支持就是我更新的最大动力💪~")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/dongwei1125",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub"),t("OutboundLink")],1),s._v(" / "),t("a",{attrs:{href:"https://gitee.com/dongwei1125",target:"_blank",rel:"noopener noreferrer"}},[s._v("Gitee"),t("OutboundLink")],1),s._v("、"),t("a",{attrs:{href:"https://dongwei1125.github.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub Pages"),t("OutboundLink")],1),s._v("、"),t("a",{attrs:{href:"https://juejin.cn/user/2621689331987783",target:"_blank",rel:"noopener noreferrer"}},[s._v("掘金"),t("OutboundLink")],1),s._v("、"),t("a",{attrs:{href:"https://blog.csdn.net/Don_GW",target:"_blank",rel:"noopener noreferrer"}},[s._v("CSDN"),t("OutboundLink")],1),s._v(" 同步更新，欢迎关注😉~")])],1)}),[],!1,null,null,null);a.default=r.exports}}]);