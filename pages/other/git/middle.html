<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>比较全面的 Git 命令手册，几乎涵盖日常所有的使用场景（中） | DonV</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/header.jpg">
    <meta name="description" content="A paper about JavaScript, HTML and CSS.">
    
    <link rel="preload" href="/assets/css/0.styles.87611319.css" as="style"><link rel="preload" href="/assets/js/app.0aa97f73.js" as="script"><link rel="preload" href="/assets/js/2.f850a8ef.js" as="script"><link rel="preload" href="/assets/js/57.8bcda68a.js" as="script"><link rel="prefetch" href="/assets/js/10.cb041c1b.js"><link rel="prefetch" href="/assets/js/11.1aadbcee.js"><link rel="prefetch" href="/assets/js/12.77cc8e56.js"><link rel="prefetch" href="/assets/js/13.7e8162d9.js"><link rel="prefetch" href="/assets/js/14.dea6ba67.js"><link rel="prefetch" href="/assets/js/15.a786d687.js"><link rel="prefetch" href="/assets/js/16.163edf25.js"><link rel="prefetch" href="/assets/js/17.3a0232cb.js"><link rel="prefetch" href="/assets/js/18.91bd2dd7.js"><link rel="prefetch" href="/assets/js/19.a36993f8.js"><link rel="prefetch" href="/assets/js/20.30dd9f79.js"><link rel="prefetch" href="/assets/js/21.5e3c83a3.js"><link rel="prefetch" href="/assets/js/22.88d5e321.js"><link rel="prefetch" href="/assets/js/23.b54a65a7.js"><link rel="prefetch" href="/assets/js/24.51df379f.js"><link rel="prefetch" href="/assets/js/25.79342bd2.js"><link rel="prefetch" href="/assets/js/26.643d5441.js"><link rel="prefetch" href="/assets/js/27.54b7d7b4.js"><link rel="prefetch" href="/assets/js/28.d01a4aee.js"><link rel="prefetch" href="/assets/js/29.7d932073.js"><link rel="prefetch" href="/assets/js/3.31ebf682.js"><link rel="prefetch" href="/assets/js/30.4c2f5636.js"><link rel="prefetch" href="/assets/js/31.b00c42d5.js"><link rel="prefetch" href="/assets/js/32.e9a0f488.js"><link rel="prefetch" href="/assets/js/33.f510b5fd.js"><link rel="prefetch" href="/assets/js/34.6e78f32f.js"><link rel="prefetch" href="/assets/js/35.04d666a2.js"><link rel="prefetch" href="/assets/js/36.900a3beb.js"><link rel="prefetch" href="/assets/js/37.19ddf8d7.js"><link rel="prefetch" href="/assets/js/38.35f899bd.js"><link rel="prefetch" href="/assets/js/39.fe9ea525.js"><link rel="prefetch" href="/assets/js/4.3c7083a8.js"><link rel="prefetch" href="/assets/js/40.0d116ce0.js"><link rel="prefetch" href="/assets/js/41.6cdce4cf.js"><link rel="prefetch" href="/assets/js/42.ab0bd0d5.js"><link rel="prefetch" href="/assets/js/43.66c8f8eb.js"><link rel="prefetch" href="/assets/js/44.ac02981e.js"><link rel="prefetch" href="/assets/js/45.479814b0.js"><link rel="prefetch" href="/assets/js/46.29956259.js"><link rel="prefetch" href="/assets/js/47.a89cf7d2.js"><link rel="prefetch" href="/assets/js/48.859e3502.js"><link rel="prefetch" href="/assets/js/49.d0fa0b25.js"><link rel="prefetch" href="/assets/js/5.206809f3.js"><link rel="prefetch" href="/assets/js/50.d051084c.js"><link rel="prefetch" href="/assets/js/51.fa831e6a.js"><link rel="prefetch" href="/assets/js/52.3ed98760.js"><link rel="prefetch" href="/assets/js/53.016b1c3c.js"><link rel="prefetch" href="/assets/js/54.c88e06c5.js"><link rel="prefetch" href="/assets/js/55.937bfe09.js"><link rel="prefetch" href="/assets/js/56.03003660.js"><link rel="prefetch" href="/assets/js/58.286692ba.js"><link rel="prefetch" href="/assets/js/59.fbfe98aa.js"><link rel="prefetch" href="/assets/js/6.6f9d9bda.js"><link rel="prefetch" href="/assets/js/60.0975844e.js"><link rel="prefetch" href="/assets/js/61.0af6cf48.js"><link rel="prefetch" href="/assets/js/62.66c23699.js"><link rel="prefetch" href="/assets/js/63.7fda9b3f.js"><link rel="prefetch" href="/assets/js/7.6f64fba1.js"><link rel="prefetch" href="/assets/js/8.a163349f.js"><link rel="prefetch" href="/assets/js/9.9058d3cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87611319.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header.jpg" alt="DonV" class="logo"> <span class="site-name can-hide">DonV</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  其它
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  应用
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  其它
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  应用
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>比较全面的 Git 命令手册，几乎涵盖日常所有的使用场景（中）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/other/git/middle.html#工具" class="sidebar-link">工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#单次提交" class="sidebar-link">单次提交</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#提交区间" class="sidebar-link">提交区间</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#交互式暂存" class="sidebar-link">交互式暂存</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#部分暂存" class="sidebar-link">部分暂存</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#储藏" class="sidebar-link">储藏</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#清理" class="sidebar-link">清理</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#搜索" class="sidebar-link">搜索</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#交互式变基" class="sidebar-link">交互式变基</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#擦除" class="sidebar-link">擦除</a></li></ul></li><li><a href="/pages/other/git/middle.html#高阶命令" class="sidebar-link">高阶命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#文件集合" class="sidebar-link">文件集合</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#高级合并" class="sidebar-link">高级合并</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#重用合并记录" class="sidebar-link">重用合并记录</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#还原提交" class="sidebar-link">还原提交</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#调试工具" class="sidebar-link">调试工具</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#打包" class="sidebar-link">打包</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#凭据存储" class="sidebar-link">凭据存储</a></li></ul></li><li><a href="/pages/other/git/middle.html#子模块" class="sidebar-link">子模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#添加" class="sidebar-link">添加</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#查看-2" class="sidebar-link">查看</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#提交-2" class="sidebar-link">提交</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#克隆" class="sidebar-link">克隆</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#更新" class="sidebar-link">更新</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#推送" class="sidebar-link">推送</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#合并" class="sidebar-link">合并</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#删除" class="sidebar-link">删除</a></li><li class="sidebar-sub-header"><a href="/pages/other/git/middle.html#其他" class="sidebar-link">其他</a></li></ul></li><li><a href="/pages/other/git/middle.html#🎉-写在最后" class="sidebar-link">🎉 写在最后</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="比较全面的-git-命令手册-几乎涵盖日常所有的使用场景-中"><a href="#比较全面的-git-命令手册-几乎涵盖日常所有的使用场景-中" class="header-anchor">#</a> 比较全面的 Git 命令手册，几乎涵盖日常所有的使用场景（中）</h1> <p><img src="/other/git/banner.jpg" alt=""></p> <h2 id="工具"><a href="#工具" class="header-anchor">#</a> 工具</h2> <h3 id="单次提交"><a href="#单次提交" class="header-anchor">#</a> 单次提交</h3> <h4 id="日志引用"><a href="#日志引用" class="header-anchor">#</a> 日志引用</h4> <p>  显示某次提交的具体信息，其中<code>show</code>后为某次提交的部分校验和。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git show 9fceb0
</code></pre></div><p>  查看某个分支的最后一次提交对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git show master
</code></pre></div><p>  查看某个分支指向的提交对象的校验和。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git rev<span class="token operator">-</span>parse master
</code></pre></div><p>  可使用<code>@{n}</code>来引用<code>git reflog</code>中输出的记录，其中<code>HEAD@{n}</code>若为提交记录，则输出提交记录信息，若非提交记录，则输出所在的分支的最近一次提交记录。注意<code>reflog</code>引用日志只存在本地仓库，记录仓库内的操作信息，新克隆的仓库引用日志为空。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git show <span class="token constant">HEAD</span>@<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="祖先引用"><a href="#祖先引用" class="header-anchor">#</a> 祖先引用</h4> <p>  查看某个提交的父提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git show <span class="token constant">HEAD</span><span class="token operator">^</span>
</code></pre></div><p>  某次提交为合并提交，则其存在多个父提交，<code>^n</code>表示当前提交的第<code>n</code>父提交。若某合并提交有两个父提交，其中第一父提交为合并时所在分支的提交，第二父提交为所合并分支的提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git show <span class="token constant">HEAD</span><span class="token operator">^</span><span class="token number">2</span>
</code></pre></div><p>  根据指定的次数获取对应的第一父提交，如下为第一父提交的第一父提交，与<code>HEAD^^</code>等价。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git show <span class="token constant">HEAD</span><span class="token operator">~</span><span class="token number">2</span>
</code></pre></div><h3 id="提交区间"><a href="#提交区间" class="header-anchor">#</a> 提交区间</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>       <span class="token constant">C</span> —— <span class="token constant">D</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
      <span class="token operator">/</span>
<span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">E</span> —— <span class="token constant">F</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master
</code></pre></div><h4 id="双点"><a href="#双点" class="header-anchor">#</a> 双点</h4> <p>  筛选出在一个分支中而不在另一个分支中的提交。如下命令选出在<code>dev</code>分支而不在<code>master</code>分支中的提交，即<code>C</code>和<code>D</code>提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log master<span class="token punctuation">.</span><span class="token punctuation">.</span>dev
</code></pre></div><p>  也可查看即将推送到远端的某些提交，如下查看当前分支推送到远端<code>master</code>分支的提交有哪些。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log origin<span class="token operator">/</span>master<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token constant">HEAD</span>
</code></pre></div><h4 id="排除"><a href="#排除" class="header-anchor">#</a> 排除</h4> <p>  也可加上<code>^</code>字符或者<code>--not</code>来指明不希望包含某个分支的提交，如下三个命令等价。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log <span class="token constant">A</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token constant">B</span>
git log <span class="token operator">^</span><span class="token constant">A</span> <span class="token constant">B</span>
git log <span class="token constant">B</span> <span class="token operator">--</span>not <span class="token constant">A</span>
</code></pre></div><p>  查看<code>A</code>或<code>B</code>包含的但是<code>C</code>不包含的提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log <span class="token constant">A</span> <span class="token constant">B</span> <span class="token operator">^</span><span class="token constant">C</span>
git log <span class="token constant">A</span> <span class="token constant">B</span> <span class="token operator">--</span>not <span class="token constant">C</span>
</code></pre></div><h4 id="三点"><a href="#三点" class="header-anchor">#</a> 三点</h4> <p>  筛选被两个中的一个包含但又不包括两者同时包含的提交。如下查看<code>master</code>或<code>dev</code>中包含但是不包括两者共有提交，即<code>E</code>、<code>F</code>、<code>C</code>和<code>D</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log master<span class="token operator">...</span>dev
</code></pre></div><p>  常用参数<code>--left-right</code>显示每个提交是处于哪一侧的分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log <span class="token operator">--</span>left<span class="token operator">-</span>right master<span class="token operator">...</span>dev
<span class="token operator">&lt;</span> <span class="token constant">F</span>
<span class="token operator">&lt;</span> <span class="token constant">E</span>
<span class="token operator">&gt;</span> <span class="token constant">D</span>
<span class="token operator">&gt;</span> <span class="token constant">C</span>
</code></pre></div><h3 id="交互式暂存"><a href="#交互式暂存" class="header-anchor">#</a> 交互式暂存</h3> <p>  运行命令<code>git add -i</code>进入<code>Git</code>交互式终端模式，其中<code>-i</code>为<code>--interactive</code>简写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>           staged     unstaged path
  <span class="token number">1</span><span class="token operator">:</span>    unchanged        <span class="token operator">+</span><span class="token number">1</span><span class="token operator">/</span><span class="token operator">-</span><span class="token number">1</span> <span class="token constant">TODO</span>
  <span class="token number">2</span><span class="token operator">:</span>        <span class="token operator">+</span><span class="token number">1</span><span class="token operator">/</span><span class="token operator">-</span><span class="token number">1</span>      nothing index<span class="token punctuation">.</span>html
  <span class="token number">3</span><span class="token operator">:</span>    unchanged        <span class="token operator">+</span><span class="token number">1</span><span class="token operator">/</span><span class="token operator">-</span><span class="token number">1</span> readme<span class="token punctuation">.</span>md

<span class="token operator">**</span><span class="token operator">*</span> Commands <span class="token operator">**</span><span class="token operator">*</span>
  <span class="token number">1</span><span class="token operator">:</span> status       <span class="token number">2</span><span class="token operator">:</span> update       <span class="token number">3</span><span class="token operator">:</span> revert       <span class="token number">4</span><span class="token operator">:</span> add untracked
  <span class="token number">5</span><span class="token operator">:</span> patch        <span class="token number">6</span><span class="token operator">:</span> diff         <span class="token number">7</span><span class="token operator">:</span> quit         <span class="token number">8</span><span class="token operator">:</span> help
What now<span class="token operator">&gt;</span>
</code></pre></div><p>  其中<code>staged</code>为已暂存列表，<code>unstaged</code>为未暂存列表，<code>Commands</code>为操作命令，<code>What now</code>后键入数字序号或命令首字母操作。</p> <ul><li><code>status</code>：同<code>git status</code>一致，信息更简略</li> <li><code>update</code>：暂存文件，键入<code>2</code>或<code>u</code>后输入文件对应的数字暂存文件（多个文件用<code>,</code>隔开），每个文件前面的<code>*</code>意味着选中的文件将会被暂存，<code>&gt;&gt;</code>提示符后不输入任何东西并回车表示执行此次命令</li> <li><code>revert</code>：取消暂存</li> <li><code>add untracked</code>：跟踪文件</li> <li><code>patch</code>：部分暂存文件，类似<code>git add -p</code></li> <li><code>diff</code>：暂存区和最近一次提交的差异，类似<code>git diff --cached</code></li> <li><code>quit</code>：退出交互式终端</li> <li><code>help</code>：命令帮助</li></ul> <h3 id="部分暂存"><a href="#部分暂存" class="header-anchor">#</a> 部分暂存</h3> <p>  执行如下命令，部分暂存更改，其中<code>-p</code>为<code>--patch</code>简写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git add <span class="token operator">-</span>p
</code></pre></div><p>  其中每一个修改的文件称为一个区块，也可分隔成多个较小的区块，区块命令如下。</p> <ul><li><code>y</code>：暂存此区块</li> <li><code>n</code>：不暂存此区块</li> <li><code>q</code>：退出，不暂存包括此区块在内的剩余的区块</li> <li><code>a</code>：暂存此区块与此文件后面所有的区块</li> <li><code>d</code>：不暂存此区块与此文件后面所有的区块</li> <li><code>g</code>：选择并跳转至一个区块</li> <li><code>/</code>：搜索正则表达示匹配的区块</li> <li><code>j</code>：跳转至下一个未处理的区块</li> <li><code>J</code>：跳转至下一个区块</li> <li><code>k</code>：跳转至上一个未处理的区块</li> <li><code>K</code>：跳转至上一个区块</li> <li><code>s</code>：将当前的区块分割成多个较小的区块</li> <li><code>e</code>：手动编辑当前的区块</li> <li><code>?</code>：输出帮助</li></ul> <h3 id="储藏"><a href="#储藏" class="header-anchor">#</a> 储藏</h3> <h4 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h4> <p>  储藏即将还不想提交的但是已修改的内容保存至堆栈中，后续可在某个分支上恢复出堆栈中的内容。不仅可以恢复到原分支，也可以恢复到其他任意指定的分支上。作用范围包括工作区和暂存区中的修改，即未提交的修改都会保存至堆栈中。</p> <h4 id="保存"><a href="#保存" class="header-anchor">#</a> 保存</h4> <p>  将未提交（工作区和暂存区）的修改保存至堆栈中，不包括未跟踪的文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash
</code></pre></div><p>  将未提交的修改和未跟踪的文件都保存至堆栈中，其中<code>-u</code>为<code>--include-untracked</code>简写，也可执行<code>git stash --all</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash <span class="token operator">-</span>u
</code></pre></div><p>  将工作区的修改保存至堆栈，不包括未跟踪的文件，其中<code>-k</code>为<code>--keep-index</code>简写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash <span class="token operator">-</span>k
</code></pre></div><p>  保存至堆栈中并备注，其中<code>message</code>为备注信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash save <span class="token string">'message'</span>
</code></pre></div><p>  保存部分修改至堆栈中，其中<code>-p</code>为<code>--patch</code>简写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash <span class="token operator">-</span>p
</code></pre></div><h4 id="查看"><a href="#查看" class="header-anchor">#</a> 查看</h4> <p>  查看堆栈中的内容。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash list
</code></pre></div><p>  运行如下命令，查看保存至堆栈中的某次修改的改动（每个修改的文件增改行统计和共计）。<code>git stash show</code>查看栈顶即最近一次保存至堆栈的修改的改动。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash show stash@<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span>
</code></pre></div><p>  查看某次修改的改动的详细差异。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash show stash@<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token operator">-</span>p
</code></pre></div><h4 id="应用"><a href="#应用" class="header-anchor">#</a> 应用</h4> <p>  运行如下命令，应用某次改动到当前分支。<code>git stash apply</code>应用栈顶的改动。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash apply stash@<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span>
</code></pre></div><p>  已重新应用了文件的改动，但是之前暂存的修改未被重新暂存。<code>--index</code>选项重新应用暂存的修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash apply <span class="token operator">--</span>index
</code></pre></div><h4 id="移除"><a href="#移除" class="header-anchor">#</a> 移除</h4> <p>  移除堆栈上某次改动，<code>git stash drop</code>移除栈顶的改动。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash drop stash@<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span>
</code></pre></div><p>  应用堆栈上某次改动并移除。<code>git stash drop</code>应用并移除栈顶的改动。注意若执行<code>git stash pop</code>出现冲突，实际已经应用了改动，但是改动依然在堆栈列表内，手动移除即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash pop stash@<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span>
</code></pre></div><p>  清空堆栈列表。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash clear
</code></pre></div><h4 id="分支"><a href="#分支" class="header-anchor">#</a> 分支</h4> <p>  运行如下命令，将堆栈中某次改动生成一个新分支，检出储藏时所在的提交，然后应用改动，应用成功后移除改动。<code>git stash branch</code>将栈顶改动生成一个新分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git stash branch dev stash@<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="清理"><a href="#清理" class="header-anchor">#</a> 清理</h3> <h4 id="命令"><a href="#命令" class="header-anchor">#</a> 命令</h4> <p>  ;<code>git clean</code>用来从工作目录删除未被跟踪的文件。</p> <p>  主要选项如下，可指定多项并简写。</p> <ul><li><code>-f</code>： <code>--force</code>简写，删除时必须指定</li> <li><code>-n</code>：<code>--dry-run</code>简写，用于显示将被删除的文件或文件夹</li> <li><code>-d</code>：删除文件夹时必须指定</li> <li><code>-x</code>：包括<code>.gitignore</code>忽略的文件或文件夹</li> <li><code>-X</code>：仅为<code>.gitignore</code>忽略的文件或文件夹</li> <li><code>-i</code>：交互式清理</li></ul> <p>  查看将被删除的文件列表 。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clean <span class="token operator">-</span>n
</code></pre></div><p>  查看将被删除的文件和文件夹。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clean <span class="token operator">-</span>d <span class="token operator">-</span>n
</code></pre></div><p>  删除未被跟踪的文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clean <span class="token operator">-</span>f
</code></pre></div><p>  删除未被跟踪的文件和文件夹。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clean <span class="token operator">-</span>f <span class="token operator">-</span>d
</code></pre></div><p>  删除未被跟踪的文件和被<code>.gitignore</code>忽略的文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clean <span class="token operator">-</span>f <span class="token operator">-</span>x
</code></pre></div><p>  仅删除被<code>.gitignore</code>忽略的文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clean <span class="token operator">-</span>f <span class="token operator">-</span><span class="token constant">X</span>
</code></pre></div><p>  删除未被跟踪的文件和文件夹、<code>.gitignore</code>忽略的文件和文件夹，也可简写为<code>git clean -fdx</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clean <span class="token operator">-</span>f <span class="token operator">-</span>d <span class="token operator">-</span>x
</code></pre></div><h4 id="交互式清理"><a href="#交互式清理" class="header-anchor">#</a> 交互式清理</h4> <p>  运行<code>git clean -i -d</code>进入交互模式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Would remove the following item<span class="token operator">:</span>
  dist<span class="token operator">/</span> readme<span class="token punctuation">.</span>md index<span class="token punctuation">.</span>html
<span class="token operator">**</span><span class="token operator">*</span> Commands <span class="token operator">**</span><span class="token operator">*</span>
    <span class="token number">1</span><span class="token operator">:</span> clean                <span class="token number">2</span><span class="token operator">:</span> filter by pattern    <span class="token number">3</span><span class="token operator">:</span> select by numbers
    <span class="token number">4</span><span class="token operator">:</span> ask each             <span class="token number">5</span><span class="token operator">:</span> quit                 <span class="token number">6</span><span class="token operator">:</span> help
What now<span class="token operator">&gt;</span>
</code></pre></div><p>  ;<code>Would remove the following item</code>后为即将清理的文件和文件夹列表。</p> <ul><li><code>clean</code>：清理列表内文件和文件夹</li> <li><code>filter by pattern</code>：排除清理列表部分文件或文件夹，全部排除清理列表为空自动退出交互模式</li> <li><code>select by numbers</code>：选择清理列表部分文件或文件夹，均未选择清理列表为空自动退出交互模式</li> <li><code>ask each</code>：询问方式删除列表文件或文件夹</li> <li><code>quit</code>：退出交互式模式</li> <li><code>help</code>：命令帮助</li></ul> <h3 id="搜索"><a href="#搜索" class="header-anchor">#</a> 搜索</h3> <p>  从工作目录中查找一个字符串或者正则表达式。</p> <p>  查找工作目录包含字符串<code>A</code>的行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git grep <span class="token constant">A</span>
</code></pre></div><p>  查找工作目录包含字符串<code>A</code>的行，并展示行号。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git grep <span class="token operator">-</span>n <span class="token constant">A</span>
</code></pre></div><p>  查找包含字符串<code>A</code>的文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git grep <span class="token operator">--</span>name<span class="token operator">-</span>only <span class="token constant">A</span>
</code></pre></div><p>  统计文件中出现字符串<code>A</code>的行数，<code>-c</code>为<code>--count</code>简写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git grep <span class="token operator">-</span>c <span class="token constant">A</span>
</code></pre></div><p>  某一行满足多个条件，如下命令满足某一行包括<code>A</code>或<code>B</code>，其中<code>--or</code>可省略。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git grep <span class="token operator">-</span>e <span class="token constant">A</span> <span class="token operator">--</span>or <span class="token operator">-</span>e <span class="token constant">B</span>
</code></pre></div><p>  某一行包括<code>A</code>并且包括<code>B</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git grep <span class="token operator">-</span>e <span class="token constant">A</span> <span class="token operator">--</span>and <span class="token operator">-</span>e <span class="token constant">B</span>
</code></pre></div><p>  某一行包括<code>A</code>和<code>B</code>或者<code>A</code>和<code>C</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git grep <span class="token operator">-</span>e <span class="token constant">A</span> <span class="token operator">--</span>and \<span class="token punctuation">(</span> <span class="token operator">-</span>e <span class="token constant">B</span> <span class="token operator">-</span>e <span class="token constant">C</span> \<span class="token punctuation">)</span>
</code></pre></div><h3 id="交互式变基"><a href="#交互式变基" class="header-anchor">#</a> 交互式变基</h3> <p>  用于变基时对提交历史记录进行复杂的修改，可用于调整提交顺序、改变提交中的提交信息或修改文件、压缩提交或拆分提交、也可用于移除提交等。</p> <h4 id="提交区间-2"><a href="#提交区间-2" class="header-anchor">#</a> 提交区间</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">D</span>  d34<span class="token operator">...</span>  <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token constant">HEAD</span>
<span class="token operator">|</span>
<span class="token constant">C</span>  c23<span class="token operator">...</span>
<span class="token operator">|</span>
<span class="token constant">B</span>  b12<span class="token operator">...</span>
<span class="token operator">|</span>
<span class="token constant">A</span>  <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span><span class="token operator">~</span><span class="token number">3</span>
</code></pre></div><p>  运行如下命令显示交互式变基界面，其中<code>-i</code>选项后为提交记录区间，<code>HEAD~3</code>到<code>HEAD</code>范围的提交记录，左开又闭，即为<code>B</code>、<code>C</code>和<code>D</code>。区间终点可省略，默认为<code>HEAD</code>指向的提交记录。注意<code>Git</code>从上到下依次应用每一个提交的修改，越早的提交在越上面。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git rebase <span class="token operator">-</span>i <span class="token constant">HEAD</span><span class="token operator">~</span><span class="token number">3</span> <span class="token constant">HEAD</span>

pick b12<span class="token operator">...</span> <span class="token constant">B</span>
pick c23<span class="token operator">...</span> <span class="token constant">C</span>
pick d34<span class="token operator">...</span> <span class="token constant">D</span>

# Rebase <span class="token operator">...</span> onto <span class="token operator">...</span> <span class="token punctuation">(</span><span class="token number">3</span> commands<span class="token punctuation">)</span>
</code></pre></div><h4 id="选项参数"><a href="#选项参数" class="header-anchor">#</a> 选项参数</h4> <p>  部分选项参数如下，注意删除某一行提交即移除某个提交，全部删除变基将会终止。</p> <ul><li><code>pick</code>：保留某个提交</li> <li><code>reword</code>：修改某个提交的提交信息</li> <li><code>edit</code>：修改某个提交</li> <li><code>squash</code>：将某个提交与上一个提交合并，可修改提交信息</li> <li><code>fixup</code>：将某个提交与上一个提交合并</li> <li><code>drop</code>：移除某个提交</li></ul> <h4 id="移除提交"><a href="#移除提交" class="header-anchor">#</a> 移除提交</h4> <p>  将<code>pick</code>修改为<code>drop</code>，保存并退出。如下将移除<code>C</code>的提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pick b12<span class="token operator">...</span> <span class="token constant">B</span>
drop c23<span class="token operator">...</span> <span class="token constant">C</span>
pick d34<span class="token operator">...</span> <span class="token constant">D</span>
</code></pre></div><h4 id="提交顺序"><a href="#提交顺序" class="header-anchor">#</a> 提交顺序</h4> <p>  调整编辑器内提交记录顺序，保存并退出。如下将提交顺序由<code>B</code>、<code>C</code>、<code>D</code>调整为<code>D</code>、<code>B</code>、<code>C</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pick d34<span class="token operator">...</span> <span class="token constant">D</span>
pick b12<span class="token operator">...</span> <span class="token constant">B</span>
pick c23<span class="token operator">...</span> <span class="token constant">C</span>
</code></pre></div><h4 id="修改提交信息"><a href="#修改提交信息" class="header-anchor">#</a> 修改提交信息</h4> <p>  将<code>pick</code>修改为<code>reword</code>，保存并退出。如下将修改<code>C</code>、<code>D</code>的提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pick b12<span class="token operator">...</span> <span class="token constant">B</span>
reword c23<span class="token operator">...</span> <span class="token constant">C</span>
reword d34<span class="token operator">...</span> <span class="token constant">D</span>
</code></pre></div><p>  保存并退出后进入<code>C</code>的提交信息编辑界面，然后再进入<code>D</code>的提交信息编辑界面。运行<code>git log --oneline</code>查看提交历史。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>d89<span class="token operator">...</span> <span class="token constant">D</span>'
c36<span class="token operator">...</span> <span class="token constant">C</span>'
b12<span class="token operator">...</span> <span class="token constant">B</span>
</code></pre></div><h4 id="压缩提交"><a href="#压缩提交" class="header-anchor">#</a> 压缩提交</h4> <p>  将多个提交压缩为一个提交，如下将<code>C</code>、<code>D</code>压缩到<code>B</code>，并修改提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pick b12<span class="token operator">...</span> <span class="token constant">B</span>
squash c23<span class="token operator">...</span> <span class="token constant">C</span>
squash d34<span class="token operator">...</span> <span class="token constant">D</span>
</code></pre></div><p>  保存并退出将修改提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code># This is a combination <span class="token keyword">of</span> <span class="token number">3</span> commits<span class="token punctuation">.</span>
# This is the 1st commit message<span class="token operator">:</span>

<span class="token constant">B</span>

# This is the commit message #<span class="token number">2</span><span class="token operator">:</span>

<span class="token constant">C</span>

# This is the commit message #<span class="token number">3</span><span class="token operator">:</span>

<span class="token constant">D</span>
</code></pre></div><p>  也可执行如下命令，跳过修改提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pick b12<span class="token operator">...</span> <span class="token constant">B</span>
fixup c23<span class="token operator">...</span> <span class="token constant">C</span>
fixup d34<span class="token operator">...</span> <span class="token constant">D</span>
</code></pre></div><h4 id="拆分提交"><a href="#拆分提交" class="header-anchor">#</a> 拆分提交</h4> <p>  拆分一个提交为多个提交，如下将拆分提交<code>C</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pick b12<span class="token operator">...</span> <span class="token constant">B</span>
edit c23<span class="token operator">...</span> <span class="token constant">C</span>
pick d34<span class="token operator">...</span> <span class="token constant">D</span>
</code></pre></div><p>  保存并退出后，<code>HEAD</code>指向提交<code>C</code>，运行<code>git reset HEAD^</code>实际是撤销<code>C</code>的提交但是保留了修改且均为未暂存。然后再多次提交，最后执行<code>git rebase --continue</code>继续变基。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git reset <span class="token constant">HEAD</span><span class="token operator">^</span>
git add readme<span class="token punctuation">.</span>md
git commit <span class="token operator">-</span>m <span class="token string">'C1'</span>
git add index<span class="token punctuation">.</span>html
git commit <span class="token operator">-</span>m <span class="token string">'C2'</span>
git rebase <span class="token operator">--</span><span class="token keyword">continue</span>
</code></pre></div><p>  运行<code>git log --oneline</code>查看提交历史。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>d96<span class="token operator">...</span> <span class="token constant">D</span>
c35<span class="token operator">...</span> <span class="token constant">C2</span>
c46<span class="token operator">...</span> <span class="token constant">C1</span>
b12<span class="token operator">...</span> <span class="token constant">B</span>
</code></pre></div><h3 id="擦除"><a href="#擦除" class="header-anchor">#</a> 擦除</h3> <p>  使用脚本的方式改写大量提交，可全局修改邮箱地址或从每一个提交中移除一个文件。</p> <p>  ;<code>filter-branch</code>选项参数如下。</p> <ul><li><code>--tree-filter</code>：在检出项目的每一个提交后运行指定的命令然后重新提交结果</li> <li><code>--prune-empty</code>：若修改后的提交为空则扔掉不要</li> <li><code>-f</code>：<code>--force</code>简写，即忽略备份强制覆盖。第二次进行擦除时会出错，即<code>Git</code>上次已做了备份，若再次运行的话会先处理掉上次的备份</li> <li><code>--all</code>：擦除所有分支</li> <li><code>--index-filter</code>：与<code>--tree-filter</code>类似，<code>--tree-filter</code>将每个提交检出到临时目录，运行<code>filter</code>命令，并根据临时目录中的内容构建新的提交。而<code>--index-filter</code>则将每个提交复制到索引中，运行<code>filter</code>命令，并根据索引中的内容构建新的提交。即从索引构建提交比从目录构建提交要快</li></ul> <p>  擦除<code>dev</code>分支整个提交历史中的<code>dist/index.html</code>文件。误操作可运行<code>git reflog</code>查看历史提交校验和，再版本回退恢复。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git filter<span class="token operator">-</span>branch <span class="token operator">-</span>f <span class="token operator">--</span>prune<span class="token operator">-</span>empty <span class="token operator">--</span>index<span class="token operator">-</span>filter <span class="token string">'git rm -f --cached --ignore-unmatch dist/index.html'</span> dev
</code></pre></div><p>  批量修改当前分支提交历史中的作者和邮箱地址，如下将提交记录中的邮箱<code>A@git.com</code>修改为<code>B@git.com</code>，作者修改为<code>B</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git filter<span class="token operator">-</span>branch <span class="token operator">--</span>commit<span class="token operator">-</span>filter '
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;$GIT_AUTHOR_EMAIL&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;A@git.com&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
then
    <span class="token constant">GIT_AUTHOR_NAME</span><span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">;</span>
    <span class="token constant">GIT_AUTHOR_EMAIL</span><span class="token operator">=</span><span class="token string">&quot;B@git.com&quot;</span><span class="token punctuation">;</span>
    git commit<span class="token operator">-</span>tree <span class="token string">&quot;$@&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
    git commit<span class="token operator">-</span>tree <span class="token string">&quot;$@&quot;</span><span class="token punctuation">;</span>
fi'
</code></pre></div><h2 id="高阶命令"><a href="#高阶命令" class="header-anchor">#</a> 高阶命令</h2> <h3 id="文件集合"><a href="#文件集合" class="header-anchor">#</a> 文件集合</h3> <p>  ;<code>HEAD</code>是当前分支引用的指针，总是指向该分支上的最后一次提交。</p> <p>  ;<code>Index</code>是预期的下一次提交，可引用为暂存区域。</p> <p>  ;<code>Working Directory</code>即工作目录。</p> <h4 id="提交"><a href="#提交" class="header-anchor">#</a> 提交</h4> <p>  ;<code>git init</code>创建一个<code>Git</code>仓库，其中的<code>HEAD</code>引用指向未创建的分支（<code>master</code>还不存在）。分支即指向提交的指针，初始化的仓库没有提交记录，默认也就不存在分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">?</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
</code></pre></div><p>  工作目录新建文件<code>readme.md</code>，暂为<code>v1</code>版本。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
       <span class="token operator">?</span>             <span class="token operator">?</span>            readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><p>  ;<code>git add</code>获取工作目录中的内容，将其复制到<code>Index</code>中。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
       <span class="token operator">?</span>         readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><p>  ;<code>git commit</code>将<code>Index</code>中的内容保存为快照，然后创建指向快照的提交对象，更新<code>master</code>指向此次提交对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>v1 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><p>  修改工作目录中文件，定为<code>v2</code>版本，运行<code>git status</code>，将会看到<code>Changes not staged for commit</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>v1 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
</code></pre></div><p>  暂存<code>v2</code>，运行<code>git status</code>，将会看到<code>Changes to be committed</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>v1 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
</code></pre></div><p>  提交此次修改，<code>master</code>指向<code>v2</code>版本。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>v1 —— v2 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
</code></pre></div><h4 id="重置"><a href="#重置" class="header-anchor">#</a> 重置</h4> <p>  重置即<code>git reset</code>版本回退，修改<code>readme.md</code>并提交，提交历史如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>v1 —— v2 —— v3 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
</code></pre></div><p>  第一步移动<code>HEAD</code>，即移动<code>master</code>指向<code>v2</code>，<code>HEAD</code>再指向<code>master</code>。此过程可运行<code>git reset --soft HEAD^</code>实现，其实质是撤销了<code>v3</code>的提交，再次运行<code>git commit</code>可完成<code>git commit --amend</code>所做的事。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>        v3
       <span class="token operator">/</span>
v1 —— v2  <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
</code></pre></div><p>  第二步更新<code>Index</code>，即更新暂存区域。此过程可运行<code>git reset --mixed HEAD^</code>实现，其中<code>--mixed</code>可省略，实质是撤销<code>v3</code>的提交，同时取消暂存所有修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>        v3
       <span class="token operator">/</span>
v1 —— v2  <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
</code></pre></div><p>  第三步更新工作目录，即让工作目录与<code>Index</code>一致。此过程可运行<code>git reset --hard HEAD^</code>实现，强制将<code>Index</code>中的<code>v2</code>覆盖工作目录。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>        v3
       <span class="token operator">/</span>
v1 —— v2  <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
</code></pre></div><h4 id="撤销暂存"><a href="#撤销暂存" class="header-anchor">#</a> 撤销暂存</h4> <p>  修改<code>readme.md</code>并暂存，提交历史如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>v1 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
</code></pre></div><p>  运行<code>git reset readme.md</code>（为<code>git reset --mixed HEAD readme.md</code>的简写形式），实质只是将<code>readme.md</code>从<code>HEAD</code>复制到<code>Index</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>v1 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
</code></pre></div><p>  也可以不从<code>HEAD</code>复制到<code>Index</code>，而是复制具体某次提交的文件对应版本，运行<code>git reset 5f5292 readme.md</code>，其中<code>5f5292</code>为某次提交的校验和。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">v1</span> <span class="token punctuation">(</span>5f5292<span class="token punctuation">)</span> —— v2 —— v3 <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
</code></pre></div><h4 id="压缩"><a href="#压缩" class="header-anchor">#</a> 压缩</h4> <p>  若一个项目最近有三次提交，第一次提交<code>A</code>新增<code>readme.md</code>，第二次提交<code>B</code>修改<code>readme.md</code>并新增<code>index.txt</code>，第三次提交<code>C</code>再次修改<code>readme.md</code>。由于<code>B</code>、<code>C</code>两次提交都是修改同一功能，因此需要压缩。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>      <span class="token constant">C</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
    <span class="token operator">/</span>
   <span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
 <span class="token operator">/</span>
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><p>  运行<code>git reset --soft HEAD^^</code>将<code>HEAD</code>移动到提交<code>A</code>上。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>      <span class="token constant">C</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
    <span class="token operator">/</span>
   <span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
 <span class="token operator">/</span>
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
                 index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><p>  运行<code>git commit</code>将<code>B</code>、<code>C</code>的修改压缩为一次新的提交<code>D</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">C</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
<span class="token operator">|</span>
<span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token constant">D</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
<span class="token operator">|</span> <span class="token operator">/</span>
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><h4 id="分支-2"><a href="#分支-2" class="header-anchor">#</a> 分支</h4> <p>  分支的提交历史如下，当前<code>HEAD</code>指向<code>master</code>分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   <span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
 <span class="token operator">/</span>
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
</code></pre></div><p>  ;<code>git checkout dev</code>移动<code>HEAD</code>指向<code>dev</code>分支，不同于<code>git reset --hard HEAD</code>，仅仅移动<code>HEAD</code>自身，且<code>checkout</code>会检查是否有未提交的修改，防止修改丢失。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   <span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master
 <span class="token operator">/</span>
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
———— <span class="token constant">HEAD</span> ———————— Index ———————— Working Directory
readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>   readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><h3 id="高级合并"><a href="#高级合并" class="header-anchor">#</a> 高级合并</h3> <h4 id="选项参数-2"><a href="#选项参数-2" class="header-anchor">#</a> 选项参数</h4> <ul><li><code>--continue</code>：某些情况下合并产生冲突，<code>Git</code>会暂停下来等待解决冲突。一种方式是<code>git add</code>将冲突文件标记为已解决，再次提交即可。另一种方式是标记后执行<code>git merge --continue</code>继续合并，若没有冲突产生，<code>Git</code>会自动创建一个合并提交</li> <li><code>--abort</code>：尝试恢复到合并前的状态。当工作目录中有未提交的修改，<code>git merge --abort</code>某些情况下无法重现合并前的状态。因此建议合并前保持干净的工作目录，可将部分修改通过<code>git stash</code>储藏，解决冲突后再释放出来</li> <li><code>-Xignore-all-space</code>：合并过来的分支和当前分支某一文件除了空格以外没有任何区别的时候，忽略合并过来的分支的那个文件。即若<code>A</code>合并<code>B</code>的修改，<code>A</code>修改为<code>hello wor ld</code>，B 修改为<code>hello wo rld</code>，两次修改等效，且忽略合并过来的修改<code>B</code></li> <li><code>-Xignore-space-change</code>：忽略空格量的变化。若某行在非末尾的位置有空格而另外一个没有，按照冲突处理。即若<code>A</code>合并<code>B</code>的修改，<code>A</code>修改为<code>hello*world</code>（暂用<code>*</code>代替空格），<code>B</code>修改为<code>hello**world</code>，则两次修改等效，且忽略合并过来的修改<code>B</code>。<code>A</code>修改为<code>helloworld</code>，<code>B</code>修改为<code>hello world</code>，则两次修改冲突</li></ul> <h4 id="冲突状态"><a href="#冲突状态" class="header-anchor">#</a> 冲突状态</h4> <p>  查看未合并的文件，运行如下命令。其中包括两者共同祖先的版本<code>1</code>、当前版本<code>2</code>（<code>HEAD</code>）、合并过来的版本<code>3</code>（<code>MERGE_HEAD</code>）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git ls<span class="token operator">-</span>files <span class="token operator">-</span>u
<span class="token number">100644</span> ac5336<span class="token operator">...</span> <span class="token number">1</span>	readme<span class="token punctuation">.</span>md
<span class="token number">100644</span> 36c569<span class="token operator">...</span> <span class="token number">2</span>	readme<span class="token punctuation">.</span>md
<span class="token number">100644</span> e85456<span class="token operator">...</span> <span class="token number">3</span>	readme<span class="token punctuation">.</span>md
</code></pre></div><p>  查看未合并版本的具体内容，运行如下命令，其中<code>36c569</code>为当前版本<code>2</code>的部分校验和，也可运行一个特别的语法<code>git cat-file -p :2:readme.md</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git cat<span class="token operator">-</span>file <span class="token operator">-</span>p 36c569
</code></pre></div><p>  冲突文件修改后（不暂存），可运行如下命令查看修改差异。其中<code>--base</code>为查看修改后的版本与两者共同祖先的版本的差异，<code>--theirs</code>为查看修改后的版本与合并过来的版本的差异，<code>--ours</code>为查看修改后的版本和当前版本的差异。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git diff <span class="token punctuation">[</span><span class="token operator">--</span>base<span class="token operator">|</span><span class="token operator">--</span>ours<span class="token operator">|</span><span class="token operator">--</span>theirs<span class="token punctuation">]</span>
</code></pre></div><h4 id="检出冲突"><a href="#检出冲突" class="header-anchor">#</a> 检出冲突</h4> <p>  ;<code>master</code>分支修改了<code>readme.md</code>文件，<code>dev</code>分支也修改了<code>readme.md</code>文件，当前<code>HEAD</code>指向<code>master</code>分支，若合并<code>dev</code>分支的<code>readme.md</code>修改，将会产生大致如下的冲突。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span> <span class="token constant">HEAD</span>
  puts <span class="token string">'hi world'</span>
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
  puts <span class="token string">'hello git'</span>
<span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;</span> dev
</code></pre></div><p>  此时并不知道保留哪一处修改，缺少更多的参照信息，运行如下命令可查看<code>ours</code>、<code>base</code>、<code>theirs</code>三个版本的差异。可通过配置<code>git config --global merge.conflictstyle diff3</code>来作为以后合并冲突的默认格式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git checkout <span class="token operator">--</span>conflict<span class="token operator">=</span>diff3 readme<span class="token punctuation">.</span>md

cat readme<span class="token punctuation">.</span>md
<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span> ours
hi world
<span class="token operator">||</span><span class="token operator">||</span><span class="token operator">||</span><span class="token operator">|</span> base
hello world
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
hello git
<span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;</span> theirs
</code></pre></div><p>  运行如下命令，快速保留某一方的修改。其中<code>--ours</code>表示保留当前的修改，丢弃掉引入的修改。<code>--theirs</code>表示保留引入的修改，丢弃掉当前的修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git checkout <span class="token punctuation">[</span><span class="token operator">--</span>ours<span class="token operator">|</span><span class="token operator">--</span>theirs<span class="token punctuation">]</span> readme<span class="token punctuation">.</span>md
</code></pre></div><h4 id="合并日志"><a href="#合并日志" class="header-anchor">#</a> 合并日志</h4> <p>  ;<code>master</code>分支和<code>dev</code>分支提交历史如下，当前<code>HEAD</code>指向<code>master</code>。其中<code>B</code>、<code>D</code>提交修改了<code>readme.md</code>文件，提交<code>C</code>新增了<code>index.txt</code>，提交<code>E</code>新增了<code>file.txt</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">C</span> index<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
<span class="token operator">|</span>
<span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v3<span class="token punctuation">)</span>
<span class="token operator">|</span>       <span class="token constant">E</span> file<span class="token punctuation">.</span><span class="token function">txt</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
<span class="token operator">|</span>     <span class="token operator">/</span>
<span class="token operator">|</span>   <span class="token constant">D</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token operator">/</span>
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
</code></pre></div><p>  ;<code>git merge dev</code>合并产生冲突后，可运行如下命令，查看此次合并中包含的每一个分支的所有独立提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log <span class="token operator">--</span>oneline <span class="token operator">--</span>left<span class="token operator">-</span>right <span class="token constant">HEAD</span><span class="token operator">...</span><span class="token constant">MERGE_HEAD</span>
<span class="token operator">&lt;</span> f127062 <span class="token constant">B</span>
<span class="token operator">&lt;</span> af9d363 <span class="token constant">C</span>
<span class="token operator">&gt;</span> e3eb226 <span class="token constant">D</span>
<span class="token operator">&gt;</span> c3ffff1 <span class="token constant">E</span>
</code></pre></div><p>  添加<code>--merge</code>选项，只显示任何一边接触了合并冲突文件的提交。也可再添加<code>-p</code>选项查看所有冲突文件的区别。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git log <span class="token operator">--</span>oneline <span class="token operator">--</span>left<span class="token operator">-</span>right <span class="token operator">--</span>merge
<span class="token operator">&lt;</span> f127062 <span class="token constant">B</span>
<span class="token operator">&gt;</span> e3eb226 <span class="token constant">D</span>
</code></pre></div><h4 id="策略合并"><a href="#策略合并" class="header-anchor">#</a> 策略合并</h4> <p>  运行如下命令。若有某些可以合并的修改，<code>Git</code>会直接合并，某些有冲突的修改，<code>Git</code>根据选项参数选择特定的修改。<code>-Xours</code>选项即产生冲突优先使用当前<code>HEAD</code>修改，<code>-Xtheirs</code>选项即优先使用<code>dev</code>分支修改，其余可合并的修改直接合并。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git merge <span class="token punctuation">[</span><span class="token operator">-</span>Xours<span class="token operator">|</span><span class="token operator">-</span>Xtheirs<span class="token punctuation">]</span> dev
</code></pre></div><h3 id="重用合并记录"><a href="#重用合并记录" class="header-anchor">#</a> 重用合并记录</h3> <p>  重用合并记录（<code>reuse recorded resolution</code>）即让<code>Git</code>记住解决一个块冲突的方法，下一次看到相同的冲突时自动解决它。</p> <p>  配置如下选项启用<code>rerere</code>功能，也可不配置，在<code>.git</code>目录下新建<code>rr-cache</code>文件夹即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git config <span class="token operator">--</span>local rerere<span class="token punctuation">.</span>enabled <span class="token boolean">true</span>
</code></pre></div><h4 id="记录冲突"><a href="#记录冲突" class="header-anchor">#</a> 记录冲突</h4> <p>  各分支的<code>readme.md</code>修改内容如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token constant">C</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>hello git<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
  <span class="token operator">/</span>
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>hello world<span class="token punctuation">)</span> —— <span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>hi world<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
</code></pre></div><p>  ;<code>master</code>分支下合并<code>dev</code>分支<code>readme.md</code>的修改。其中<code>Recorded preimage</code>表示<code>Git</code>已经开始跟踪此次合并了。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git merge dev
Auto<span class="token operator">-</span>merging readme<span class="token punctuation">.</span>md
<span class="token constant">CONFLICT</span> <span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token operator">:</span> Merge conflict <span class="token keyword">in</span> readme<span class="token punctuation">.</span>md
Recorded preimage <span class="token keyword">for</span> <span class="token string">'readme.md'</span>
Automatic merge failed<span class="token punctuation">;</span> <span class="token operator">...</span>
</code></pre></div><p>  查看<code>readme.md</code>文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cat readme<span class="token punctuation">.</span>md
<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span> <span class="token constant">HEAD</span>
hello git
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
hi world
<span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;</span> dev
</code></pre></div><p>  查看<code>.git/rr-cache/0ff6a9/preimage</code>下记录的合并冲突前的版本，其中<code>0ff6a9</code>为此次冲突的校验和。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>
hello git
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
hi world
<span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;</span>
</code></pre></div><p>  处理<code>readme.md</code>，将其标记为已解决并提交。其中<code>Recorded resolution</code>表示记录了此次冲突的解决方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git add readme<span class="token punctuation">.</span>md
git commit <span class="token operator">-</span>m <span class="token string">'D'</span>
Recorded resolution <span class="token keyword">for</span> <span class="token string">'readme.md'</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>master <span class="token operator">...</span><span class="token punctuation">]</span> <span class="token constant">D</span>
</code></pre></div><p>  冲突解决后提交历史如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   <span class="token constant">B</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>hi world<span class="token punctuation">)</span>  <span class="token operator">&lt;</span><span class="token operator">--</span> dev
 <span class="token operator">/</span>                        \
<span class="token constant">A</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>hello world<span class="token punctuation">)</span>   <span class="token constant">D</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>hi git<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
 \                        <span class="token operator">/</span>
   <span class="token constant">C</span> readme<span class="token punctuation">.</span><span class="token function">md</span> <span class="token punctuation">(</span>hello git<span class="token punctuation">)</span>
</code></pre></div><p>  查看<code>.git/rr-cache/0ff6a9/postimage</code>下记录的合并冲突后的版本。本质上当<code>Git</code>看到一个<code>readme.md</code>文件的一个块冲突中有<code>hi world</code>在一边、<code>hello git</code>在另一边，它会将其解决为<code>hi git</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>hi git
</code></pre></div><p>  撤销合并提交<code>D</code>，然后再次合并<code>dev</code>的修改。其中<code>Resolved ... using previous resolution</code>表示使用了之前的合并记录。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git reset <span class="token operator">--</span>hard <span class="token constant">HEAD</span><span class="token operator">^</span>
git merge dev
Auto<span class="token operator">-</span>merging readme<span class="token punctuation">.</span>md
<span class="token constant">CONFLICT</span> <span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token operator">:</span> Merge conflict <span class="token keyword">in</span> readme<span class="token punctuation">.</span>md
Resolved <span class="token string">'readme.md'</span> using previous resolution<span class="token punctuation">.</span>
Automatic merge failed<span class="token punctuation">;</span> <span class="token operator">...</span>
</code></pre></div><p>  查看使用了合并记录后的<code>readme.md</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cat readme<span class="token punctuation">.</span>md
hi git
</code></pre></div><p>  执行<code>git merge --abort</code>撤销本次合并，回到合并前的状态。再来看看将<code>dev</code>的修改变基到<code>master</code>的情况。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git <span class="token keyword">switch</span> dev
git rebase master
<span class="token operator">...</span>
Resolved <span class="token string">'readme.md'</span> using previous resolution<span class="token punctuation">.</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
</code></pre></div><p>  执行<code>git add</code>将文件标记为已解决，执行<code>git rebase --continue</code>继续变基，此次变基记录记为<code>B'</code>，<code>master</code>成为<code>dev</code>分支的直接上游。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">B</span>' <span class="token operator">&lt;</span><span class="token operator">--</span> dev <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
<span class="token operator">|</span>
<span class="token constant">C</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master
<span class="token operator">|</span>  <span class="token constant">B</span>
<span class="token operator">|</span> <span class="token operator">/</span>
<span class="token constant">A</span>
</code></pre></div><h4 id="恢复冲突"><a href="#恢复冲突" class="header-anchor">#</a> 恢复冲突</h4> <p>  ;<code>Git</code>自动解决冲突，但是可能你已经忘记冲突时<code>readme.md</code>的状态了，运行如下命令，恢复至冲突时的<code>readme.me</code>状态。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git checkout <span class="token operator">--</span>conflict<span class="token operator">=</span>merge readme<span class="token punctuation">.</span>md
cat readme<span class="token punctuation">.</span>md
<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span> ours
hello git
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
hi world
<span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;</span> theirs
</code></pre></div><h4 id="应用场景"><a href="#应用场景" class="header-anchor">#</a> 应用场景</h4> <p>  分支提交历史如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>         <span class="token constant">E</span> —— <span class="token constant">F</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
       <span class="token operator">/</span>
<span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master
</code></pre></div><p>  某种情况下要合并<code>master</code>分支的修改，来测试<code>dev</code>分支的修改是否影响了<code>master</code>分支的部分功能。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>         <span class="token constant">E</span> —— <span class="token constant">F</span> —— <span class="token constant">G</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
       <span class="token operator">/</span>         <span class="token operator">/</span>
<span class="token constant">A</span> —— <span class="token constant">B</span> ———————— <span class="token constant">C</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master
</code></pre></div><p>  可能多次从<code>master</code>分支合并至<code>dev</code>分支进行测试，最终<code>master</code>分支合并了<code>dev</code>分支的修改。查看<code>master</code>分支提交历史，可能看见很多的合并记录，历史树看起来并不直观。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>         <span class="token constant">E</span> —— <span class="token constant">F</span> —— <span class="token constant">G</span> —— <span class="token constant">H</span> —— <span class="token constant">K</span> —— <span class="token constant">L</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
       <span class="token operator">/</span>         <span class="token operator">/</span>          <span class="token operator">/</span>      \
<span class="token constant">A</span> —— <span class="token constant">B</span> ———————— <span class="token constant">C</span> ———————— <span class="token constant">J</span> —— <span class="token constant">M</span> —— <span class="token constant">N</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master
</code></pre></div><p>  其实<code>dev</code>分支每次合并<code>master</code>分支完成测试后，可以丢弃掉那次合并记录，因为<code>rerere</code>已经记录了冲突的解决方法，不必担心以后再次合并，最终<code>dev</code>分支完成开发合并至<code>master</code>，提交历史树如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>         <span class="token constant">E</span> —— <span class="token constant">F</span> —— <span class="token constant">H</span> —— <span class="token constant">L</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
       <span class="token operator">/</span>                 \
<span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token constant">J</span> —— <span class="token constant">M</span> —— <span class="token constant">N</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master
</code></pre></div><h3 id="还原提交"><a href="#还原提交" class="header-anchor">#</a> 还原提交</h3> <p>  提交包括常规提交、合并提交，常规提交只有一个父提交对象，而合并提交有两个或者多个的父提交对象。<code>git reset --hard</code>可取消某次提交的修改，但是对于已经推送至远程仓库的提交，会造成很大的问题。另一种解决方式就是还原提交，即生成一个新的提交，此提交将会撤销指定的某次提交的修改。</p> <h4 id="常规提交"><a href="#常规提交" class="header-anchor">#</a> 常规提交</h4> <p>  若分支提交历史如下，其中<code>HEAD</code>指向<code>master</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">A</span> —— <span class="token constant">B</span> <span class="token punctuation">(</span><span class="token number">24e888</span><span class="token punctuation">)</span> —— <span class="token constant">C</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
</code></pre></div><p>  执行如下命令取消<code>B</code>的修改，也可执行<code>git revert HEAD^</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git revert <span class="token number">24e888</span>
</code></pre></div><p>  运行后<code>Git</code>会打开<code>Vim</code>编辑器，可修改此次新提交的提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Revert <span class="token string">&quot;B&quot;</span>

This reverts commit <span class="token number">24e888</span><span class="token operator">...</span><span class="token punctuation">.</span>

# Please enter the commit message <span class="token keyword">for</span> your changes<span class="token punctuation">.</span> Lines starting
# <span class="token keyword">with</span> <span class="token string">'#'</span> will be ignored<span class="token punctuation">,</span> and an empty message aborts the commit<span class="token punctuation">.</span>
#
# On branch master
<span class="token operator">...</span>
</code></pre></div><p>  最终提交历史如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token operator">^</span><span class="token constant">B</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
</code></pre></div><h4 id="合并提交"><a href="#合并提交" class="header-anchor">#</a> 合并提交</h4> <p>  各分支的提交历史大致如下，<code>HEAD</code>指向<code>master</code>分支，其中<code>D</code>为合并提交，其余均为常规提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token constant">D</span> <span class="token punctuation">(</span>110c0d6<span class="token punctuation">)</span> —— <span class="token constant">G</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
      \       <span class="token operator">/</span>
       <span class="token constant">E</span> —— <span class="token constant">F</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
</code></pre></div><p>  某些情况下发现<code>dev</code>分支合并进来的修改存在重大缺陷，需要丢弃掉<code>dev</code>分支的修改，即<code>E</code>、<code>F</code>两次提交的修改。若运行<code>git resert 110c0d6</code>撤销提交<code>D</code>，但是<code>Git</code>不知道撤销哪一个分支的修改，此时需告诉<code>Git</code>保留哪一个分支的修改，而另一个分支的修改将被撤销。运行如下命令创建还原提交<code>^D</code>，其中<code>-m</code>表示此次取消的是一次合并提交，<code>1</code>表示保留提交<code>D</code>的第一父提交<code>C</code>的修改并撤销<code>E</code>、<code>F</code>的修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git revert <span class="token operator">-</span>m <span class="token number">1</span> 110c0d6

<span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token constant">D</span> <span class="token punctuation">(</span>110c0d6<span class="token punctuation">)</span> —— <span class="token constant">G</span> —— <span class="token operator">^</span><span class="token constant">D</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
      \       <span class="token operator">/</span>
       <span class="token constant">E</span> —— <span class="token constant">F</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
</code></pre></div><p>  当<code>dev</code>分支的重大缺陷修复后，可再次合并进<code>master</code>。可能直觉上觉得<code>E</code>、<code>F</code>、<code>H</code>的修改均合并进了<code>master</code>分支，但是注意由于提交<code>^D</code>撤销了<code>E</code>、<code>F</code>的修改，所以<code>master</code>并不包含<code>E</code>、<code>F</code>的修改，即只有<code>H</code>的修改合并进了<code>master</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token constant">D</span> —— <span class="token constant">G</span> —— <span class="token operator">^</span><span class="token constant">D</span> —— <span class="token constant">I</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
      \       <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">               </span><span class="token regex-delimiter">/</span></span>
       <span class="token constant">E</span> —— <span class="token constant">F</span> —————————————— <span class="token constant">H</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
</code></pre></div><p>  解决上述情况的办法也很容易，用撤销解决撤销，即先撤销<code>^D</code>的修改。其中<code>d6d7365</code>为提交<code>^D</code>的部分校验和，也可执行<code>git revert HEAD</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git revert d6d7365

<span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token constant">D</span> —— <span class="token constant">G</span> —— <span class="token operator">^</span><span class="token constant">D</span> <span class="token punctuation">(</span>d6d7365<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
      \       <span class="token operator">/</span>
       <span class="token constant">E</span> —— <span class="token constant">F</span> ——— <span class="token constant">H</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
</code></pre></div><p>  再执行<code>git merge</code>合并<code>dev</code>的修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token constant">D</span> —— <span class="token constant">G</span> —— <span class="token operator">^</span><span class="token constant">D</span> —— <span class="token operator">^</span><span class="token operator">^</span><span class="token constant">D</span> —— <span class="token constant">I</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
      \       <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">                      </span><span class="token regex-delimiter">/</span></span>
       <span class="token constant">E</span> —— <span class="token constant">F</span> ————————————————————— <span class="token constant">H</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dev
</code></pre></div><h3 id="调试工具"><a href="#调试工具" class="header-anchor">#</a> 调试工具</h3> <h4 id="文件标注"><a href="#文件标注" class="header-anchor">#</a> 文件标注</h4> <p>  查看某一文件每一行的最后一次修改的提交。输出的每一行中第一个字段是最后一次修改此行的提交的部分校验和，<code>^</code>开头表示的是此文件第一次加入项目时的提交。括号中的字段分别为作者、提交时间（含时区）、行号。最后为某一行的内容。</p> <p>  查看文件第二行到第五行。其中<code>-L</code>表示范围，<code>2,5</code>表示第二行到第五行，都是闭区间，不指定<code>-L</code>参数和范围则查看文件所有行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git blame <span class="token operator">-</span><span class="token constant">L</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span> readme<span class="token punctuation">.</span>md
<span class="token operator">^</span><span class="token number">4832</span><span class="token function">fe2</span> <span class="token punctuation">(</span>xx <span class="token number">2021</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">12</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">31</span><span class="token operator">:</span><span class="token number">28</span> <span class="token operator">+</span><span class="token number">0800</span> <span class="token number">2</span><span class="token punctuation">)</span>   hello
<span class="token number">9</span><span class="token function">f6560e4</span> <span class="token punctuation">(</span>xx <span class="token number">2021</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">29</span> <span class="token operator">+</span><span class="token number">0800</span> <span class="token number">3</span><span class="token punctuation">)</span>   world
<span class="token function">cd564aa5</span> <span class="token punctuation">(</span>xx <span class="token number">2021</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">14</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">33</span><span class="token operator">:</span><span class="token number">30</span> <span class="token operator">+</span><span class="token number">0800</span> <span class="token number">4</span><span class="token punctuation">)</span>   and
<span class="token number">7</span><span class="token function">f3a6645</span> <span class="token punctuation">(</span>xx <span class="token number">2021</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">15</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">31</span> <span class="token operator">+</span><span class="token number">0800</span> <span class="token number">5</span><span class="token punctuation">)</span>   git
</code></pre></div><p>  范围也可指定行的个数，<code>+</code>表示往下，<code>-</code>表示往上。如下表示从第二行往下三行，则输出行号为<code>2</code>、<code>3</code>、<code>4</code>的行的提交信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git blame <span class="token operator">-</span><span class="token constant">L</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">+</span><span class="token number">3</span> readme<span class="token punctuation">.</span>md
</code></pre></div><h4 id="二分查找"><a href="#二分查找" class="header-anchor">#</a> 二分查找</h4> <p>  ;<code>bisect</code>命令会对提交历史进行二分查找来帮助尽快找到是哪一个提交引入了问题。</p> <p>  提交历史如下，提交<code>C101</code>收到了<code>bug</code>反馈，但是在提交<code>C1</code>并未存在此<code>bug</code>，可以确定的是在提交<code>C1</code>与<code>C101</code>之间的提交引入了<code>bug</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">C1</span> <span class="token punctuation">(</span>d564aa<span class="token punctuation">)</span> —— <span class="token constant">C2</span> ··· <span class="token constant">C50</span> ··· <span class="token constant">C100</span> —— <span class="token constant">C101</span> <span class="token operator">&lt;</span><span class="token operator">--</span> master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
</code></pre></div><p>  运行如下命令，选择<code>C1</code>到<code>C101</code>的提交历史进行二分查找排查，代码库会切换到范围正当中的那一次提交<code>C51</code>，其中<code>d564aa</code>为提交<code>C1</code>的部分校验和。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bisect start <span class="token constant">HEAD</span> d564aa
</code></pre></div><p>  提交<code>C51</code>下复现<code>bug</code>，并不存在，说明在<code>C52</code>到<code>C101</code>之间，<code>good</code>表示本次提交<code>C51</code>没有问题。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bisect good
</code></pre></div><p>  ;<code>Git</code>自动切换到<code>C52</code>与<code>C101</code>的中点提交<code>C76</code>，<code>bad</code>表示本次提交<code>C76</code>有问题。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bisect bad
</code></pre></div><p>  不断重复此过程，最终查找到出问题的那次提交，并打印出那次提交的详细信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">857293.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> is the first bad commit
commit <span class="token number">857293.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token literal-property property">Author</span><span class="token operator">:</span> <span class="token operator">...</span>
<span class="token literal-property property">Date</span><span class="token operator">:</span>   <span class="token operator">...</span>
</code></pre></div><p>  执行如下命令，退出查错，回到最近一次的代码提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bisect reset
</code></pre></div><h3 id="打包"><a href="#打包" class="header-anchor">#</a> 打包</h3> <p>  ;<code>Git</code>可将分支内容打包成一个二进制文件，用于邮件或其他方式传输。</p> <p>  打包<code>master</code>分支所有提交历史，其中<code>repo.bundle</code>为打包生成的二进制文件名。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bundle create repo<span class="token punctuation">.</span>bundle <span class="token constant">HEAD</span> master
</code></pre></div><p>  克隆打包生成的二进制文件，其中<code>repos</code>为自定义的仓库名，也可不指定，如下则默认为<code>repo</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clone repo<span class="token punctuation">.</span>bundle repos
</code></pre></div><p>  打包区间范围的提交记录，其中<code>HEAD^^..HEAD</code>左开右闭区间，即<code>D</code>、<code>E</code>两次提交记录。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bundle create repo<span class="token punctuation">.</span>bundle <span class="token constant">HEAD</span><span class="token operator">^</span><span class="token operator">^</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token constant">HEAD</span> master

<span class="token constant">A</span> —— <span class="token constant">B</span> —— <span class="token constant">C</span> —— <span class="token constant">D</span> —— <span class="token constant">E</span> <span class="token operator">&lt;</span><span class="token operator">--</span>master <span class="token operator">&lt;</span><span class="token operator">--</span> <span class="token constant">HEAD</span>
</code></pre></div><p>  检查文件是否是合法的<code>Git</code>包，是否拥有共同的祖先从而导入。其中<code>The bundle requires this ref</code>表示此包父提交对象校验和为<code>99884a</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bundle verify repo<span class="token punctuation">.</span>bundle
<span class="token operator">...</span>
The bundle requires <span class="token keyword">this</span> <span class="token literal-property property">ref</span><span class="token operator">:</span>
99884a<span class="token operator">...</span>
</code></pre></div><p>  查看包可导入的分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git bundle list<span class="token operator">-</span>heads repo<span class="token punctuation">.</span>bundle
</code></pre></div><p>  导入包中<code>master</code>分支的提交到本地<code>dev</code>分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git fetch repo<span class="token punctuation">.</span>bundle master<span class="token operator">:</span>dev
</code></pre></div><h3 id="凭据存储"><a href="#凭据存储" class="header-anchor">#</a> 凭据存储</h3> <p>  ;<code>Git</code>使用<code>HTTP</code>协议访问远程仓库进行操作时，每一个连接都是需要用户名和密码的。</p> <p>  倘若每次推送或者拉取都输入用户名和密码，显得非常繁琐，<code>Git</code>提供了一个凭据系统来解决此种问题，部分选项如下。</p> <ul><li>默认：凭据都不缓存，每一次连接都会询问用户名和密码</li> <li><code>cache</code>：将凭据存放在内存中一段时间，密码不会被存储在磁盘中，并且<code>15</code>分钟后从内存中清除。注意此选项不适用于<code>windows</code>系统，因为此选项是通过<code>unix</code>套接字进行通信</li> <li><code>store</code>：凭据明文存放在磁盘中永不过期。默认路径为<code>C:/Users/{username}/.git-credentials</code></li> <li><code>manager</code>：凭据管理至<code>windows</code>系统中的凭据管理器，可在控制面板中的用户账户的凭据管理器中查看</li></ul> <p>  运行如下命令配置上述选项。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git config <span class="token operator">--</span>global credential<span class="token punctuation">.</span>helper <span class="token punctuation">[</span>cache<span class="token operator">|</span>store<span class="token operator">|</span>manager<span class="token punctuation">]</span>
</code></pre></div><p>  一般安装<code>Git</code>会默认使用<code>manager</code>方式，其中<code>Enable Git Credential Manager</code>即开启<code>manager</code>方式</p> <p><img src="/other/git/middle-setup.png" alt=""></p> <p>  如下窗口输入用户名和密码会被凭据管理器记录。</p> <p><img src="/other/git/middle-window.png" alt=""></p> <h2 id="子模块"><a href="#子模块" class="header-anchor">#</a> 子模块</h2> <p>  子模块即一个<code>Git</code>仓库作为另一个<code>Git</code>仓库的子目录，两个仓库相互独立，同时一个仓库又依赖另一个仓库。</p> <h3 id="添加"><a href="#添加" class="header-anchor">#</a> 添加</h3> <p>  仓库添加子模块，默认子模块会放到与仓库同名的目录中，即主项目中会生成子目录<code>subrepo</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule add https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
</code></pre></div><p>  也可在命令结尾指定子目录名称或路径，如下主项目中会生成子目录<code>subrepos</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule add https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git subrepos
</code></pre></div><p>  注意子模块默认克隆仓库的<code>master</code>分支，运行如下命令克隆具体分支，其中<code>-b</code>为<code>--branch</code>简写，<code>dev</code>为远程仓库<code>subrepo</code>的分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule add <span class="token operator">-</span>b dev https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
</code></pre></div><h3 id="查看-2"><a href="#查看-2" class="header-anchor">#</a> 查看</h3> <p>  主项目下运行<code>git status</code>查看状态，注意首次添加子模块，会生成<code>.gitmodules</code>文件且均为暂存状态，同时<code>.gitmodules</code>也会被<code>Git</code>跟踪并管理。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git status
<span class="token operator">...</span>
Changes to be committed<span class="token operator">:</span>
  <span class="token operator">...</span>
        <span class="token keyword">new</span> <span class="token class-name">file</span><span class="token operator">:</span>   <span class="token punctuation">.</span>gitmodules
        <span class="token keyword">new</span> <span class="token class-name">file</span><span class="token operator">:</span>   subrepo
</code></pre></div><p>  其中<code>.gitmodules</code>文件保存了子模块项目<code>URL</code>和本地目录之间的映射关系。注意主项目中有多个子模块，<code>.gitmodules</code>就会存在多条记录。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cat <span class="token punctuation">.</span>gitmodules
<span class="token punctuation">[</span>submodule <span class="token string">&quot;subrepo&quot;</span><span class="token punctuation">]</span>
        path <span class="token operator">=</span> subrepo
        url <span class="token operator">=</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
</code></pre></div><p>  查看暂存区与最近版本库之间的差异，虽然<code>subrepo</code>是主项目目录的子目录，但是<code>Git</code>并不会跟踪它的内容，而是将其看做仓库中的一个特殊提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git diff <span class="token operator">--</span>cached
<span class="token operator">...</span>
<span class="token operator">+</span><span class="token punctuation">[</span>submodule <span class="token string">&quot;subrepo&quot;</span><span class="token punctuation">]</span>
<span class="token operator">+</span>       path <span class="token operator">=</span> subrepo
<span class="token operator">+</span>       url <span class="token operator">=</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
<span class="token operator">...</span>
<span class="token operator">+</span>Subproject commit 3b8ad09<span class="token operator">...</span>
</code></pre></div><p>  也可指定<code>--submodule</code>选项查看差异。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git diff <span class="token operator">--</span>cached <span class="token operator">--</span>submodule
<span class="token operator">...</span>
<span class="token operator">+</span><span class="token punctuation">[</span>submodule <span class="token string">&quot;subrepo&quot;</span><span class="token punctuation">]</span>
<span class="token operator">+</span>       path <span class="token operator">=</span> subrepo
<span class="token operator">+</span>       url <span class="token operator">=</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
Submodule subrepo <span class="token number">0000000.</span><span class="token punctuation">.</span><span class="token number">.3</span><span class="token function">b8ad09</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">submodule</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="提交-2"><a href="#提交-2" class="header-anchor">#</a> 提交</h3> <p>  主项目下运行<code>git commit</code>提交，其中<code>160000</code>是<code>Git</code>中一种特殊模式，本质上是子模块目录指向某次提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git commit <span class="token operator">-</span>am <span class="token string">'message'</span>
<span class="token operator">...</span>
 create mode <span class="token number">100644</span> <span class="token punctuation">.</span>gitmodules
 create mode <span class="token number">160000</span> subrepo
</code></pre></div><p>  运行如下命令，查看当前提交树对象，其中子目录<code>subrepo</code>中的当前版本指向提交记录<code>3b8ad09</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git ls<span class="token operator">-</span>tree <span class="token operator">-</span>r <span class="token constant">HEAD</span>
<span class="token number">100644</span> blob 9a5259<span class="token operator">...</span>    <span class="token punctuation">.</span>gitmodules
<span class="token number">160000</span> commit 3b8ad09<span class="token operator">...</span>  subrepo
</code></pre></div><h3 id="克隆"><a href="#克隆" class="header-anchor">#</a> 克隆</h3> <p>  克隆仓库<code>repo</code>，其中仓库<code>repo</code>含有子模块<code>subrepo</code>，克隆后默认会包含子模块目录<code>subrepo</code>，但是其中都没有文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clone https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>repo<span class="token punctuation">.</span>git
</code></pre></div><p>  运行如下命令，初始化本地配置。若想验证此方式的执行情况，提供一种思路，首先克隆仓库<code>repo</code>，然后进入仓库内<code>.git</code>文件夹，运行<code>git init</code>，暂存所有文件并提交，即用<code>Git</code>跟踪<code>Git</code>的改动，然后返回上级，执行如下命令，最后进入<code>.git</code>并执行<code>git diff</code>，则能看到此命令执行后相关文件改动，此种方式也可验证<code>Git</code>其他命令的执行情况。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule init
Submodule <span class="token string">'subrepo'</span> <span class="token punctuation">(</span> <span class="token operator">...</span> <span class="token punctuation">)</span> registered <span class="token keyword">for</span> path <span class="token string">'subrepo'</span>
</code></pre></div><p>  初始化本地配置后，运行如下命令，抓取子模块内对应版本的文件。注意<code>Git</code>将会获得这些改动并更新子目录中的文件，但是会将子仓库留在一个游离的<code>HEAD</code>的状态，即子仓库不存在分支，没有本地分支来跟踪改动，执行<code>git checkout</code>检出其相应的工作分支即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule update
</code></pre></div><p>  也可运行如下命令，自动初始化并更新仓库中每一个子模块。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git clone <span class="token operator">--</span>recursive https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>repo<span class="token punctuation">.</span>git
</code></pre></div><h3 id="更新"><a href="#更新" class="header-anchor">#</a> 更新</h3> <p>  可能仅使用子模块项目并不时地获取更新，但是并不在子模块进行修改。</p> <p>  如下分别在子模块内部和外部更新，其中主项目<code>repo</code>下包括子模块目录<code>subrepo</code>。</p> <h4 id="内部"><a href="#内部" class="header-anchor">#</a> 内部</h4> <p>  子模块<code>subrepo</code>运行<code>git fetch</code>和<code>git merge</code>合并最新代码，也可查看子模块<code>subrepo</code>的代码提交历史和差异。注意若此时无法<code>fetch</code>最新代码，可能由于子模块<code>subrepo</code>处于游离的<code>HEAD</code>状态，需运行<code>git checkout</code>检出工作分支。</p> <p>  合并更新后返回主项目<code>repo</code>，子模块<code>subrepo</code>的更新会被仓库<code>repo</code>记录为一次新的特殊修改，可运行<code>git status</code>查看工作目录状态，或者运行如下命令，查看目录<code>subrepo</code>指向的提交记录的改变以及当前指向的提交的提交信息。其中<code>6cc07e3..81afae7</code>表示子模块<code>subrepo</code>指向的提交记录由<code>6cc07e3</code>更新为<code>81afae7</code>，当前提交记录<code>81afae7</code>的提交信息为<code>update subrepo readme.md</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git diff <span class="token operator">--</span>submodule
Submodule subrepo 6cc07e3<span class="token punctuation">.</span><span class="token punctuation">.</span>81afae7<span class="token operator">:</span>
  <span class="token operator">&gt;</span> update subrepo readme<span class="token punctuation">.</span>md
</code></pre></div><h4 id="外部"><a href="#外部" class="header-anchor">#</a> 外部</h4> <p>  主项目<code>repo</code>中再进入目录<code>subrepo</code>更新代码，稍微显得麻烦，运行如下命令，在仓库<code>repo</code>下更新所有子模块的代码。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule update <span class="token operator">--</span>remote
</code></pre></div><p>  可能子模块较多，仅仅只需要更新某一个子模块，如下仅更新子模块<code>subrepo</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule update <span class="token operator">--</span>remote subrepo
</code></pre></div><p>  运行如下命令，将子模块<code>subrepo</code>的版本映射修改为另一个分支，其中<code>dev</code>为分支名，修改后再运行<code>git submodule update --remote subrepo</code>更新即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git config <span class="token operator">-</span>f <span class="token punctuation">.</span>gitmodules submodule<span class="token punctuation">.</span>subrepo<span class="token punctuation">.</span>branch dev
</code></pre></div><h3 id="推送"><a href="#推送" class="header-anchor">#</a> 推送</h3> <p>  子模块<code>subrepo</code>修改部分文件，若仓库<code>subrepo</code>处于游离的<code>HEAD</code>状态，也需检出相应的工作分支，提交后不推送改动。在主项目<code>repo</code>中提交并推送，其他人更新子模块<code>subrepo</code>时，无法获取到子模块所依赖的改动，那些改动只存在本地拷贝中。</p> <p>  运行如下命令，<code>Git</code>在推送主项目前会检查子模块是否已经推送，若任何子模块的改动没有推送则<code>push</code>会失败。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git push <span class="token operator">--</span>recurse<span class="token operator">-</span>submodules<span class="token operator">=</span>check
The following submodule paths contain changes that can
not be found on any remote<span class="token operator">:</span>
  subrepo
<span class="token operator">...</span>
</code></pre></div><p>  运行如下命令，在推送主项目前推送子模块的改动。注意若子模块因为某些原因推送失败，主项目也会推送失败。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git push <span class="token operator">--</span>recurse<span class="token operator">-</span>submodules<span class="token operator">=</span>on<span class="token operator">-</span>demand
</code></pre></div><h3 id="合并"><a href="#合并" class="header-anchor">#</a> 合并</h3> <p>  其他人同时改动了子模块的引用，可能会遇到部分问题，需要做一些工作来修复。</p> <h4 id="快进式"><a href="#快进式" class="header-anchor">#</a> 快进式</h4> <p>  若主项目<code>repo</code>下包括子项目<code>subrepo</code>，用户<code>A</code>和用户<code>B</code>均克隆了远程仓库<code>repo</code>。用户<code>A</code>修改子项目下文件，提交并推送了<code>subrepo</code>和<code>repo</code>。用户<code>B</code>不做任何修改，执行<code>git pull</code>，子项目<code>subrepo</code>将做一个快进式合并，<code>Git</code>会选择之后的提交来合并。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git pull
<span class="token operator">...</span>
Fetching submodule subrepo
<span class="token operator">...</span>
Fast<span class="token operator">-</span>forward
 subrepo
</code></pre></div><h4 id="子模块冲突"><a href="#子模块冲突" class="header-anchor">#</a> 子模块冲突</h4> <p>  若主项目<code>repo</code>下包括子项目<code>subrepo</code>，用户<code>A</code>和用户<code>B</code>均克隆了远程仓库<code>repo</code>。其中子项目<code>subrepo</code>含文件<code>readme.md (v1)</code>。</p> <p>  用户<code>A</code>修改<code>readme.md (v2)</code>，同时在<code>repo</code>和<code>subrepo</code>均提交和推送了修改。</p> <p>  用户<code>B</code>修改<code>readme.md (v3)</code>，同时在<code>repo</code>和<code>subrepo</code>均提交了修改，然后再拉取用户<code>A</code>推送的修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git pull
<span class="token operator">...</span>
Failed to merge submodule <span class="token function">subrepo</span> <span class="token punctuation">(</span>merge following commits not found<span class="token punctuation">)</span>
Auto<span class="token operator">-</span>merging subrepo
<span class="token constant">CONFLICT</span> <span class="token punctuation">(</span>submodule<span class="token punctuation">)</span><span class="token operator">:</span> Merge conflict <span class="token keyword">in</span> subrepo
<span class="token operator">...</span>
</code></pre></div><p>  可查看<code>subrepo</code>子模块产生了冲突，其中<code>merge following commits not found</code>表示未找到合并提交记录，即<code>Git</code>未找到子模块内<code>readme.md</code>文件<code>v2</code>和<code>v3</code>的合并提交版本。</p> <p>   运行<code>git diff</code>，查看产生冲突的两个提交记录的校验和，其中<code>2ceb726</code>为用户<code>B</code>的提交校验和，<code>29b9770</code>为用户<code>A</code>的提交校验和。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git diff
index 2ceb726<span class="token punctuation">,</span>29b9770<span class="token punctuation">.</span><span class="token number">.0000000</span>
</code></pre></div><p>  进入子模块目录<code>subrepo</code>，当前应该指向提交<code>2ceb726</code>，运行如下命令创建用户<code>A</code>的修改的一个临时分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git branch theirs 29b9770
</code></pre></div><p>  合并<code>theirs</code>分支，在此得到了一个真正的合并冲突。修改后将文件<code>readme.md (v4)</code>标记为已解决，然后提交并推送子项目<code>subrepo</code>的修改，最后返回至主项目<code>repo</code>提交并推送修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git merge theirs
<span class="token operator">...</span>
<span class="token constant">CONFLICT</span> <span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token operator">:</span> Merge conflict <span class="token keyword">in</span> readme<span class="token punctuation">.</span>md
<span class="token operator">...</span>
</code></pre></div><p>  另一种合并方式即在用户<code>A</code>提交和推送后，用户<code>B</code>的<code>readme.md (v3)</code>修改提交后，执行<code>git pull</code>合并<code>v2</code>和<code>v3</code>为<code>v4</code>，再推送合并版本，然后返回主项目<code>repo</code>提交。</p> <p>  最后执行<code>git pull</code>，此时引入用户<code>A</code>的<code>readme.md (v2)</code>修改，由于<code>Git</code>找到了<code>v2</code>和<code>v3</code>的合并提交版本<code>v4</code>，故此合并仅是一次简单的快进式合并。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git pull
<span class="token operator">...</span>
Fast<span class="token operator">-</span>forwarding submodule subrepo
Auto<span class="token operator">-</span>merging subrepo
Merge made by the <span class="token string">'recursive'</span> strategy<span class="token punctuation">.</span>
</code></pre></div><h3 id="删除"><a href="#删除" class="header-anchor">#</a> 删除</h3> <p>  若主项目<code>repo</code>删除子模块<code>subrepo</code>，首先运行如下命令，<code>Git</code>会删除子模块目录<code>subrepo</code>，并且再更新<code>.gitmodules</code>文件，同时暂存以上修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git rm <span class="token operator">-</span>f subrepo
</code></pre></div><p>  然后在<code>.git/config</code>中删减子模块<code>subrepo</code>相关内容。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span>submodule <span class="token string">&quot;subrepo&quot;</span><span class="token punctuation">]</span>
        url <span class="token operator">=</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
</code></pre></div><p>  最后在主项目<code>repo</code>下提交并推送修改。</p> <h3 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h3> <h4 id="子模块遍历"><a href="#子模块遍历" class="header-anchor">#</a> 子模块遍历</h4> <p>  在主项目中运行如下命令，<code>Git</code>会在每一个子模块中运行<code>git checkout master</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule foreach git checkout master
</code></pre></div><h4 id="切换分支"><a href="#切换分支" class="header-anchor">#</a> 切换分支</h4> <p>  主项目<code>repo</code>暂不添加子模块，检出一个新分支<code>dev</code>后再添加子模块<code>subrepo</code>并提交。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git checkout <span class="token operator">-</span>b dev
git submodule add https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
git commit <span class="token operator">-</span>am <span class="token string">'message'</span>
</code></pre></div><p>  此时切换到<code>master</code>分支，警告不能删除非空目录<code>subrepo</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git checkout master
<span class="token literal-property property">warning</span><span class="token operator">:</span> unable to rmdir <span class="token string">'subrepo'</span><span class="token operator">:</span> Directory not empty
Switched to branch <span class="token string">'master'</span>
<span class="token operator">...</span>
</code></pre></div><p>  ;<code>master</code>分支应该没有子模块，但是却仍然有一个未跟踪的子模块目录<code>subrepo</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git status
<span class="token operator">...</span>
Untracked files<span class="token operator">:</span>
  <span class="token operator">...</span>
        subrepo<span class="token operator">/</span>
</code></pre></div><p>  运行<code>rm -r subrepo</code>删除此子模块目录即可，再<code>git switch</code>切换回<code>dev</code>分支。但是进入 <code>subrepo</code>目录并没有任何文件，运行如下命令来重新建立和填充子模块<code>subrepo</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule update <span class="token operator">--</span>init
Submodule path <span class="token string">'subrepo'</span><span class="token operator">:</span> checked out <span class="token operator">...</span>
</code></pre></div><h4 id="子目录"><a href="#子目录" class="header-anchor">#</a> 子目录</h4> <p>  若仓库<code>repo</code>含子目录<code>subrepo</code>，<code>subrepo</code>中含部分文件，仓库<code>repo</code>此时含<code>master</code>和<code>dev</code>分支，当前<code>HEAD</code>指向<code>dev</code>分支。</p> <p>  此时添加子模块<code>subrepo</code>，但是由于<code>subrepo</code>目录存在，添加失败。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git submodule add https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>subrepo<span class="token punctuation">.</span>git
<span class="token string">'subrepo'</span> already exists <span class="token keyword">in</span> the index
</code></pre></div><p>  运行如下命令，删除<code>subrepo</code>目录后再添加子模块，然后提交修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git rm <span class="token operator">-</span>r subrepo
</code></pre></div><p>  切换分支到<code>master</code>，注意子目录<code>subrepo</code>中的文件与<code>dev</code>分支的子模块中的文件合并了。</p> <p>  解决方式如下，首先删除<code>subrepo</code>目录，然后撤销修改，最终<code>master</code>分支的<code>subrepo</code>目录恢复。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>rm <span class="token operator">-</span>r subrepo
git checkout <span class="token punctuation">.</span>
</code></pre></div><p><a href="/pages/other/git/upper.html">上一篇</a></p> <p><a href="/pages/other/git/lower.html">下一篇</a></p> <h2 id="🎉-写在最后"><a href="#🎉-写在最后" class="header-anchor">#</a> 🎉 写在最后</h2> <p>🍻伙伴们，如果你已经看到了这里，觉得这篇文章有帮助到你的话不妨点赞👍或 <a href="https://github.com/dongwei1125/blog" target="_blank" rel="noopener noreferrer">Star<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ✨支持一下哦！</p> <p>手动码字，如有错误，欢迎在评论区指正💬~</p> <p>你的支持就是我更新的最大动力💪~</p> <p><a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> / <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer">Gitee<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://dongwei1125.github.io/" target="_blank" rel="noopener noreferrer">GitHub Pages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer">掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer">CSDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 同步更新，欢迎关注😉~</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">3/6/2022, 9:06:37 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0aa97f73.js" defer></script><script src="/assets/js/2.f850a8ef.js" defer></script><script src="/assets/js/57.8bcda68a.js" defer></script>
  </body>
</html>
