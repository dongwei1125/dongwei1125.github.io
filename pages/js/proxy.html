<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES6 Proxy | DonV</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/header.jpg">
    <meta name="description" content="A paper about JavaScript, HTML and CSS.">
    
    <link rel="preload" href="/assets/css/0.styles.87611319.css" as="style"><link rel="preload" href="/assets/js/app.0aa97f73.js" as="script"><link rel="preload" href="/assets/js/2.f850a8ef.js" as="script"><link rel="preload" href="/assets/js/47.a89cf7d2.js" as="script"><link rel="prefetch" href="/assets/js/10.cb041c1b.js"><link rel="prefetch" href="/assets/js/11.1aadbcee.js"><link rel="prefetch" href="/assets/js/12.77cc8e56.js"><link rel="prefetch" href="/assets/js/13.7e8162d9.js"><link rel="prefetch" href="/assets/js/14.dea6ba67.js"><link rel="prefetch" href="/assets/js/15.a786d687.js"><link rel="prefetch" href="/assets/js/16.163edf25.js"><link rel="prefetch" href="/assets/js/17.3a0232cb.js"><link rel="prefetch" href="/assets/js/18.91bd2dd7.js"><link rel="prefetch" href="/assets/js/19.a36993f8.js"><link rel="prefetch" href="/assets/js/20.30dd9f79.js"><link rel="prefetch" href="/assets/js/21.5e3c83a3.js"><link rel="prefetch" href="/assets/js/22.88d5e321.js"><link rel="prefetch" href="/assets/js/23.b54a65a7.js"><link rel="prefetch" href="/assets/js/24.51df379f.js"><link rel="prefetch" href="/assets/js/25.79342bd2.js"><link rel="prefetch" href="/assets/js/26.643d5441.js"><link rel="prefetch" href="/assets/js/27.54b7d7b4.js"><link rel="prefetch" href="/assets/js/28.d01a4aee.js"><link rel="prefetch" href="/assets/js/29.7d932073.js"><link rel="prefetch" href="/assets/js/3.31ebf682.js"><link rel="prefetch" href="/assets/js/30.4c2f5636.js"><link rel="prefetch" href="/assets/js/31.b00c42d5.js"><link rel="prefetch" href="/assets/js/32.e9a0f488.js"><link rel="prefetch" href="/assets/js/33.f510b5fd.js"><link rel="prefetch" href="/assets/js/34.6e78f32f.js"><link rel="prefetch" href="/assets/js/35.04d666a2.js"><link rel="prefetch" href="/assets/js/36.900a3beb.js"><link rel="prefetch" href="/assets/js/37.19ddf8d7.js"><link rel="prefetch" href="/assets/js/38.35f899bd.js"><link rel="prefetch" href="/assets/js/39.fe9ea525.js"><link rel="prefetch" href="/assets/js/4.3c7083a8.js"><link rel="prefetch" href="/assets/js/40.0d116ce0.js"><link rel="prefetch" href="/assets/js/41.6cdce4cf.js"><link rel="prefetch" href="/assets/js/42.ab0bd0d5.js"><link rel="prefetch" href="/assets/js/43.66c8f8eb.js"><link rel="prefetch" href="/assets/js/44.ac02981e.js"><link rel="prefetch" href="/assets/js/45.479814b0.js"><link rel="prefetch" href="/assets/js/46.29956259.js"><link rel="prefetch" href="/assets/js/48.859e3502.js"><link rel="prefetch" href="/assets/js/49.d0fa0b25.js"><link rel="prefetch" href="/assets/js/5.206809f3.js"><link rel="prefetch" href="/assets/js/50.d051084c.js"><link rel="prefetch" href="/assets/js/51.fa831e6a.js"><link rel="prefetch" href="/assets/js/52.3ed98760.js"><link rel="prefetch" href="/assets/js/53.016b1c3c.js"><link rel="prefetch" href="/assets/js/54.c88e06c5.js"><link rel="prefetch" href="/assets/js/55.937bfe09.js"><link rel="prefetch" href="/assets/js/56.03003660.js"><link rel="prefetch" href="/assets/js/57.8bcda68a.js"><link rel="prefetch" href="/assets/js/58.286692ba.js"><link rel="prefetch" href="/assets/js/59.fbfe98aa.js"><link rel="prefetch" href="/assets/js/6.6f9d9bda.js"><link rel="prefetch" href="/assets/js/60.0975844e.js"><link rel="prefetch" href="/assets/js/61.0af6cf48.js"><link rel="prefetch" href="/assets/js/62.66c23699.js"><link rel="prefetch" href="/assets/js/63.7fda9b3f.js"><link rel="prefetch" href="/assets/js/7.6f64fba1.js"><link rel="prefetch" href="/assets/js/8.a163349f.js"><link rel="prefetch" href="/assets/js/9.9058d3cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87611319.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header.jpg" alt="DonV" class="logo"> <span class="site-name can-hide">DonV</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  å…¶å®ƒ
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  åº”ç”¨
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…³äº" class="dropdown-title"><span class="title">å…³äº</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…³äº" class="mobile-dropdown-title"><span class="title">å…³äº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æ˜é‡‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  å…¶å®ƒ
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  åº”ç”¨
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…³äº" class="dropdown-title"><span class="title">å…³äº</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…³äº" class="mobile-dropdown-title"><span class="title">å…³äº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æ˜é‡‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ES6 Proxy</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/js/proxy.html#å‰è¨€" class="sidebar-link">å‰è¨€</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/js/proxy.html#è¯­æ³•" class="sidebar-link">è¯­æ³•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#get" class="sidebar-link">get</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#set" class="sidebar-link">set</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#has" class="sidebar-link">has</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#deleteproperty" class="sidebar-link">deleteProperty</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#ownkeys" class="sidebar-link">ownKeys</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#getownpropertydescriptor" class="sidebar-link">getOwnPropertyDescriptor</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#defineproperty" class="sidebar-link">defineProperty</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#preventextensions" class="sidebar-link">preventExtensions</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#isextensible" class="sidebar-link">isExtensible</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#getprototypeof" class="sidebar-link">getPrototypeOf</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#setprototypeof" class="sidebar-link">setPrototypeOf</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#apply" class="sidebar-link">apply</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#construct" class="sidebar-link">construct</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#proxy-revocable" class="sidebar-link">Proxy.revocable</a></li></ul></li><li><a href="/pages/js/proxy.html#çº¦æŸ" class="sidebar-link">çº¦æŸ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#å†…éƒ¨æ–¹æ³•" class="sidebar-link">å†…éƒ¨æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#å¯¹æ¯”" class="sidebar-link">å¯¹æ¯”</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#ä¸å˜é‡" class="sidebar-link">ä¸å˜é‡</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#å°ç»“-2" class="sidebar-link">å°ç»“</a></li></ul></li><li><a href="/pages/js/proxy.html#åº”ç”¨åœºæ™¯" class="sidebar-link">åº”ç”¨åœºæ™¯</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#æ•°ç»„è´Ÿç´¢å¼•" class="sidebar-link">æ•°ç»„è´Ÿç´¢å¼•</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#éšè—å†…éƒ¨å±æ€§" class="sidebar-link">éšè—å†…éƒ¨å±æ€§</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#åˆ›å»ºåªè¯»å¯¹è±¡" class="sidebar-link">åˆ›å»ºåªè¯»å¯¹è±¡</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#æ”¯æŒé“¾å¼å±æ€§" class="sidebar-link">æ”¯æŒé“¾å¼å±æ€§</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#å±æ€§å€¼æ ¡éªŒ" class="sidebar-link">å±æ€§å€¼æ ¡éªŒ</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#ç®¡é“" class="sidebar-link">ç®¡é“</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#æ•°æ®ç›‘å¬" class="sidebar-link">æ•°æ®ç›‘å¬</a></li></ul></li><li><a href="/pages/js/proxy.html#å¸¸è§é—®é¢˜" class="sidebar-link">å¸¸è§é—®é¢˜</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#ä¸ºä»€ä¹ˆ-proxy-å¤§å¤šä¸-reflect-ç»“åˆä½¿ç”¨" class="sidebar-link">ä¸ºä»€ä¹ˆ Proxy å¤§å¤šä¸ Reflect ç»“åˆä½¿ç”¨ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#proxy-å¦‚ä½•ä»£ç†-map" class="sidebar-link">Proxy å¦‚ä½•ä»£ç† Mapï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#polyfill-åŸç†æ˜¯ä»€ä¹ˆ" class="sidebar-link">Polyfill åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/pages/js/proxy.html#proxy-ä¸ç±»å‹è½¬æ¢" class="sidebar-link">Proxy ä¸ç±»å‹è½¬æ¢</a></li></ul></li><li><a href="/pages/js/proxy.html#å°ç»“-4" class="sidebar-link">å°ç»“</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/js/proxy.html#å‚è€ƒ" class="sidebar-link">å‚è€ƒ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/js/proxy.html#ğŸ‰-å†™åœ¨æœ€å" class="sidebar-link">ğŸ‰ å†™åœ¨æœ€å</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="es6-proxy"><a href="#es6-proxy" class="header-anchor">#</a> ES6 Proxy</h1> <p><img src="/js/proxy/banner.jpg" alt=""></p> <h2 id="å‰è¨€"><a href="#å‰è¨€" class="header-anchor">#</a> å‰è¨€</h2> <p>â€ƒâ€ƒå…¨æ–‡å…±è®¡<code>5</code>ä¸‡å­—å·¦å³ï¼Œå¤§çº¦å¯é˜…è¯»ä¸¤å°æ—¶ï¼Œå¹¶ä¸å®šæ—¶æŒç»­æ›´æ–°ä¸­ã€‚</p> <p>â€ƒâ€ƒæ­¤æ–‡å¯èƒ½æ˜¯å…³äº<code>Proxy</code>ç›¸å¯¹è¾ƒå…¨çš„æ–‡ç« ä¹‹ä¸€ï¼Œæ€»ç»“äº†<code>Proxy</code>ä»£ç†å‡ ä¹æ‰€æœ‰çš„ç”¨æ³•ã€ç¤ºä¾‹å’Œæ³¨æ„äº‹é¡¹ï¼Œä¹Ÿæœ‰å¯¹éƒ¨åˆ†ä»£ç çš„ç»†èŠ‚åˆ†æã€‚ç»“åˆè¯­æ³•å’Œ<code>ECMAScript</code>è§„èŒƒï¼Œç³»ç»Ÿæ€§åœ°é˜é‡Šäº†<code>JavaScript</code>å¯¹è±¡çš„å†…éƒ¨æ–¹æ³•å’Œå†…éƒ¨æ§½ï¼Œå¯¹æ¯”äº†æ™®é€šå¯¹è±¡ä¸ä»£ç†å¯¹è±¡ä¹‹é—´çš„å·®å¼‚å’Œå…±åŒç‚¹ã€‚å¦å¤–ä¹ŸåŒ…æ‹¬ä¸€äº›è¿ç”¨åœºæ™¯ï¼Œå¦‚ä½•åˆ†æä»£ç†çš„é”™è¯¯é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•ä¼˜åŒ–è§£å†³ç­‰ç­‰ã€‚</p> <p>â€ƒâ€ƒå»ºè®®é˜…è¯»ä¸­æ ¹æ®ç›®å½•ç»†åŒ–æ‹†åˆ†ï¼Œå¹¶è¯•ç€å›ç­”ä»¥ä¸‹é—®é¢˜ã€‚</p> <ul><li>ä»€ä¹ˆæ˜¯<code>trap</code>ï¼Ÿ</li> <li>å†…éƒ¨æ–¹æ³•ä¸<code>trap</code>ã€ä¸å˜é‡ä¸‰è€…çš„å…³ç³»</li> <li><code>Proxy</code>ä¸<code>Reflect</code>ä¹‹é—´çš„è”ç³»å’Œä½œç”¨</li> <li>å®ä¾‹å¦‚ä½•åœ¨è§„èŒƒå±‚é¢è·å–ç§æœ‰å±æ€§</li> <li><code>Proxy</code>çš„ç¼ºç‚¹å’Œå±€é™æ€§</li></ul> <h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="header-anchor">#</a> è¯­æ³•</h2> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy" target="_blank" rel="noopener noreferrer">Proxy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸ºæ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»ºä»£ç†å¯¹è±¡ã€‚å‚æ•°<code>target</code>ä¸ºè¢«ä»£ç†çš„å¯¹è±¡ï¼Œ<code>handler</code>ä¸ºé…ç½®å¯¹è±¡ï¼Œç”¨äºè‡ªå®šä¹‰ä¸åŒçš„ä»£ç†è¡Œä¸ºã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre></div><p>â€ƒâ€ƒä¸¤ä¸ªå‚æ•°éƒ½ä¸èƒ½ä¸ºéå¯¹è±¡ï¼Œå¦åˆ™å°†æŠ›å‡ºé”™è¯¯ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: Cannot create proxy with a non-object as target or handler</span>
</code></pre></div><p>â€ƒâ€ƒ;<code>Proxy</code>æ„é€ å‡½æ•°ä¸èƒ½ç»§æ‰¿ï¼ŒåŸå› åœ¨äº<code>Proxy</code>ä¸Šæ²¡æœ‰<code>prototype</code>åŸå‹å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">P</span> <span class="token keyword">extends</span> <span class="token class-name">Proxy</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// Uncaught TypeError: Class extends value does not have valid prototype property undefined</span>
</code></pre></div><p>â€ƒâ€ƒæ‰‹åŠ¨æ·»åŠ ä¸Š<code>prototype</code>å±æ€§åˆ™å¯ä»¥ç»§æ‰¿ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Proxy</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">P</span> <span class="token keyword">extends</span> <span class="token class-name">Proxy</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">P</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Proxy {}</span>
</code></pre></div><h3 id="get"><a href="#get" class="header-anchor">#</a> get</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/get" target="_blank" rel="noopener noreferrer">get(target, property, receiver)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†å¯¹è±¡çš„è¯»å–æ“ä½œï¼ŒåŒ…æ‹¬<code>proxy[prop]</code>æˆ–è€…<code>proxy.prop</code>ã€<code>Object.create(proxy)[prop]</code>æˆ–è€…<code>Reflect.get(proxy, property)</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">15</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token comment">// 15</span>
</code></pre></div><p>â€ƒâ€ƒå‡½æ•°å‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>property</code>ä¸ºå±æ€§åç§°ï¼Œ<code>receiver</code>ä¸ºä»£ç†å¯¹è±¡ï¼Œæˆ–è€…ç»§æ‰¿ä»£ç†å¯¹è±¡çš„å¯¹è±¡ã€‚</p> <p>â€ƒâ€ƒ;<code>receiver</code>ä¸ºä»£ç†å¯¹è±¡<code>proxy</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> receiver
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">===</span> proxy <span class="token comment">// true</span>
</code></pre></div><p>â€ƒâ€ƒå¯¹è±¡<code>o</code>ä¸å­˜åœ¨<code>value</code>å±æ€§ï¼Œå°†æ²¿ç€åŸå‹é“¾è¯»å–<code>proxy</code>çš„<code>value</code>å±æ€§ï¼Œè¿›è€Œè¢«<code>get</code>å‡½æ•°ä»£ç†ï¼Œ<code>receiver</code>åˆ™ä¸ºç»§æ‰¿ä»£ç†å¯¹è±¡<code>proxy</code>çš„å¯¹è±¡<code>o</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> receiver
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>

o<span class="token punctuation">.</span>value <span class="token operator">===</span> o <span class="token comment">// true</span>
</code></pre></div><p>â€ƒâ€ƒè§‚å¯Ÿå‘ç°ï¼Œåœ¨æ‰§è¡Œ<code>proxy.value</code>æˆ–<code>o.value</code>æ—¶ï¼Œç‚¹è¿ç®—ç¬¦ï¼ˆ<code>.</code>ï¼‰å·¦è¾¹çš„å¯¹è±¡æ˜¯è°ï¼Œ<code>receiver</code>å°±æŒ‡å‘è°ã€‚</p> <p>â€ƒâ€ƒæ¢å¥è¯è¯´<code>receiver</code>æ˜¯è§¦å‘è¯»å–æ“ä½œæ—¶çš„å¯¹è±¡ã€‚</p> <h3 id="set"><a href="#set" class="header-anchor">#</a> set</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/set" target="_blank" rel="noopener noreferrer">set(target, property, value, receiver)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†å¯¹è±¡å±æ€§çš„èµ‹å€¼æ“ä½œï¼ŒåŒ…æ‹¬<code>proxy.prop = value</code>æˆ–è€…<code>proxy[prop] = value</code>ã€<code>Object.create(proxy)[prop] = value</code>æˆ–è€…<code>Reflect.set(proxy, property, value)</code>ã€‚è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®æˆåŠŸã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    object<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">15</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>

proxy<span class="token punctuation">.</span>value <span class="token comment">// 15</span>
</code></pre></div><p>â€ƒâ€ƒå‡½æ•°å‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>property</code>ä¸ºå±æ€§åç§°ï¼Œ<code>value</code>ä¸ºè®¾ç½®çš„å±æ€§å€¼ï¼Œ<code>receiver</code>ä¸ºä»£ç†å¯¹è±¡ï¼Œæˆ–è€…ç»§æ‰¿ä»£ç†å¯¹è±¡çš„å¯¹è±¡ã€‚</p> <p>â€ƒâ€ƒ;<code>receiver</code>ä¸<code>get</code>ä¸€è‡´ï¼Œç‚¹è¿ç®—ç¬¦å·¦è¾¹çš„å¯¹è±¡æ˜¯è°ï¼Œ<code>receiver</code>å°±æ˜¯è°ï¼Œå³è§¦å‘èµ‹å€¼æ“ä½œæ—¶çš„å¯¹è±¡ã€‚</p> <p>â€ƒâ€ƒä¸¥æ ¼æ¨¡å¼ä¸‹è‹¥è¿”å›<code>false</code>ï¼Œå°†æŠ›å‡ºé”™è¯¯ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'use strict'</span>

<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">15</span>
<span class="token comment">// Uncaught TypeError: 'set' on proxy: trap returned falsish for property 'value'</span>
</code></pre></div><h3 id="has"><a href="#has" class="header-anchor">#</a> has</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/has" target="_blank" rel="noopener noreferrer">has(target, property)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰å±æ€§ï¼Œä¾‹å¦‚<code>in</code>å’Œ<code>with</code>ï¼ŒåŒ…æ‹¬<code>prop in proxy</code>æˆ–è€…<code>prop in Object.create(proxy)</code>ã€<code>with(proxy){ prop; }</code>æˆ–è€…<code>with(Object.create(proxy)){ prop; }</code>ã€<code>Reflect.has(proxy, property)</code>ã€‚è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æœ‰å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">has</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token string">'value'</span> <span class="token keyword">in</span> proxy <span class="token comment">// true</span>
</code></pre></div><p>â€ƒâ€ƒå‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>property</code>ä¸ºå±æ€§åã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">has</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token comment">// Uncaught TypeError: Cannot read properties of undefined (reading 'log')</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒç®€å•åˆ†æä»¥ä¸Šä»£ç çš„æŠ¥é”™åŸå› ï¼Œæ‰§è¡Œåˆ°<code>console.log</code>è¯­å¥æ—¶ï¼Œå¼•æ“ä¼šç¡®è®¤<code>proxy</code>ä¸Šæ˜¯å¦æœ‰<code>console</code>å±æ€§ã€‚æ­¤æ—¶å°†è°ƒç”¨<code>handler.has()</code>æ–¹æ³•ï¼Œé»˜è®¤è¿”å›<code>true</code>ï¼Œè¡¨ç¤º<code>proxy</code>ä¸Šå­˜åœ¨<code>console</code>å±æ€§ã€‚</p> <p>â€ƒâ€ƒç„¶åå»è·å–<code>proxy.console</code>çš„å±æ€§å€¼ï¼Œå³<code>undefined</code>ï¼Œç´§æ¥ç€æ‰§è¡Œ<code>undefined.log</code>ï¼Œç”±äº<code>undefined</code>ä¸Šå¹¶æ— <code>log</code>æ–¹æ³•ï¼Œå°†æŠ›å‡ºé”™è¯¯ã€‚</p> <p>â€ƒâ€ƒå¯é€‰é“¾<code>?.</code>æ¯”è¾ƒé€‚ç”¨æ­¤åœºæ™¯ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">with</span> <span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token operator">?.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="deleteproperty"><a href="#deleteproperty" class="header-anchor">#</a> deleteProperty</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/deleteProperty" target="_blank" rel="noopener noreferrer">deleteProperty(target, property)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†<code>delete</code>æ“ä½œï¼ŒåŒ…æ‹¬<code>delete proxy.prop</code>æˆ–è€…<code>delete proxy[prop]</code>ã€<code>Reflect.deleteProperty(proxy, property)</code>ã€‚è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦åˆ é™¤æˆåŠŸã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">delete</span> proxy<span class="token punctuation">.</span>value <span class="token comment">// true</span>
</code></pre></div><p>â€ƒâ€ƒå‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>property</code>ä¸ºå±æ€§åã€‚</p> <h3 id="ownkeys"><a href="#ownkeys" class="header-anchor">#</a> ownKeys</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/ownKeys" target="_blank" rel="noopener noreferrer">ownKeys(target)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†æšä¸¾å¯¹è±¡å±æ€§çš„æ“ä½œï¼ŒåŒ…æ‹¬ã€‚</p> <ul><li><code>for...in</code></li> <li><code>Object.keys(proxy) / Object.values(proxy) / Object.entries(proxy)</code></li> <li><code>Object.getOwnPropertyNames(proxy)</code></li> <li><code>Object.getOwnPropertySymbols(proxy)</code></li> <li><code>Reflect.ownKeys(proxy)</code></li></ul> <h4 id="for-in"><a href="#for-in" class="header-anchor">#</a> for...in</h4> <p>â€ƒâ€ƒ;<code>for...in</code>è¿”å›å¯¹è±¡è‡ªèº«å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼Œä¸åŒ…æ‹¬<code>Symbol</code>å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">m</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  <span class="token comment">// x</span>
  <span class="token comment">// m</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒä»£ç†<code>for...in</code>æ—¶ï¼Œæœ‰ä¸‰ç§å±æ€§ä¼šè¢«<code>ownKeys</code>è¿‡æ»¤ï¼ŒåŒ…æ‹¬ã€‚</p> <ul><li>ç›®æ ‡å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§</li> <li><code>Symbol</code>å±æ€§</li> <li>ç›®æ ‡å¯¹è±¡ä¸Šä¸å¯æšä¸¾ï¼ˆ<code>non-enumerable</code>ï¼‰çš„å±æ€§</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> proxy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  <span class="token comment">// x</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="object-keys"><a href="#object-keys" class="header-anchor">#</a> Object.keys</h4> <p>â€ƒâ€ƒ;<code>Object.keys</code>è¿”å›å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§ï¼Œä¸åŒ…æ‹¬<code>Symbol</code>å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token comment">// ['x']</span>
</code></pre></div><p>â€ƒâ€ƒä»£ç†<code>Object.keys</code>æ—¶ï¼Œä¸<code>for...in</code>ä¸€è‡´ï¼Œä¹Ÿä¼šè¢«<code>ownKeys</code>è¿‡æ»¤ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// ['x']</span>
Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// [1]</span>
Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// [['x', 1]]</span>
</code></pre></div><p>â€ƒâ€ƒæ³¨æ„<code>Object.values</code>å’Œ<code>Object.entries</code>ä¹Ÿä¼šè¢«<code>ownKeys</code>ä»£ç†ï¼Œä¸”ä¼šè¢«è¿‡æ»¤ã€‚</p> <h4 id="object-getownpropertynames"><a href="#object-getownpropertynames" class="header-anchor">#</a> Object.getOwnPropertyNames</h4> <p>â€ƒâ€ƒ;<code>Object.getOwnPropertyNames</code>è¿”å›å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œä¸åŒ…æ‹¬<code>Symbol</code>å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token comment">// ['x', 'z']</span>
</code></pre></div><p>â€ƒâ€ƒä¸<code>for...in</code>å’Œ<code>Object.keys</code>çš„åŒºåˆ«åœ¨äºï¼Œä»£ç†<code>Object.getOwnPropertyNames</code>å¯è¿”å›ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// ['x', 'y']</span>
</code></pre></div><h4 id="object-getownpropertysymbols"><a href="#object-getownpropertysymbols" class="header-anchor">#</a> Object.getOwnPropertySymbols</h4> <p>â€ƒâ€ƒ;<code>Object.getOwnPropertySymbols</code>è¿”å›å¯¹è±¡è‡ªèº«çš„<code>Symbol</code>å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token comment">// [Symbol(y), Symbol(z)]</span>
</code></pre></div><p>â€ƒâ€ƒä»£ç†<code>Object.getOwnPropertySymbols</code>ä¹Ÿå¯è¿”å›ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„<code>Symbol</code>å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// [Symbol(x), Symbol(y)]</span>
</code></pre></div><h4 id="reflect-ownkeys"><a href="#reflect-ownkeys" class="header-anchor">#</a> Reflect.ownKeys</h4> <p>â€ƒâ€ƒ;<code>Reflect.ownKeys</code>è¿”å›å¯¹è±¡è‡ªèº«æ‰€æœ‰å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token comment">// ['x', 'z', Symbol(y)]</span>
</code></pre></div><p>â€ƒâ€ƒä»£ç†<code>Reflect.ownKeys</code>ä¹Ÿå¯è¿”å›ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">,</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">,</span> y<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// ['v', Symbol(w), 'x', Symbol(y)]</span>
</code></pre></div><h4 id="å°ç»“"><a href="#å°ç»“" class="header-anchor">#</a> å°ç»“</h4> <table><thead><tr><th style="text-align:center;">è¯­å¥</th> <th style="text-align:center;">ç‰¹æ€§</th> <th style="text-align:center;"><code>ownKeys</code>æ˜¯å¦è¿‡æ»¤</th> <th style="text-align:center;"><code>ownKeys</code>æ˜¯å¦å¯è¿”å›ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§</th></tr></thead> <tbody><tr><td style="text-align:center;"><code>for...in</code></td> <td style="text-align:center;">å¯¹è±¡è‡ªèº«å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼Œä¸å«<code>Symbol</code>å±æ€§</td> <td style="text-align:center;">æ˜¯</td> <td style="text-align:center;">å¦</td></tr> <tr><td style="text-align:center;"><code>Object.keys</code></td> <td style="text-align:center;">å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§ï¼Œä¸å«<code>Symbol</code>å±æ€§</td> <td style="text-align:center;">æ˜¯</td> <td style="text-align:center;">å¦</td></tr> <tr><td style="text-align:center;"><code>Object.getOwnPropertyNames</code></td> <td style="text-align:center;">å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼Œä¸å«<code>Symbol</code>å±æ€§</td> <td style="text-align:center;">å¦</td> <td style="text-align:center;">æ˜¯</td></tr> <tr><td style="text-align:center;"><code>Object.getOwnPropertySymbols</code></td> <td style="text-align:center;">å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰<code>Symbol</code>å±æ€§</td> <td style="text-align:center;">å¦</td> <td style="text-align:center;">æ˜¯</td></tr> <tr><td style="text-align:center;"><code>Reflect.ownKeys</code></td> <td style="text-align:center;">å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§</td> <td style="text-align:center;">å¦</td> <td style="text-align:center;">æ˜¯</td></tr></tbody></table> <p>â€ƒâ€ƒå…³ç³»å›¾ã€‚</p> <p><img src="/js/proxy/forin.png" alt=""></p> <h3 id="getownpropertydescriptor"><a href="#getownpropertydescriptor" class="header-anchor">#</a> getOwnPropertyDescriptor</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/getOwnPropertyDescriptor" target="_blank" rel="noopener noreferrer">getOwnPropertyDescriptor(target, property)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†è·å–å¯¹è±¡å±æ€§æè¿°ç¬¦çš„æ“ä½œï¼ŒåŒ…æ‹¬<code>Object.getOwnPropertyDescriptor(proxy, prop)</code>æˆ–è€…<code>Reflect.getOwnPropertyDescriptor(proxy, prop)</code>ã€<code>Object.getOwnPropertyDescriptors(proxy)</code>ã€‚è¿”å›å€¼ä¸ºæè¿°ç¬¦å¯¹è±¡æˆ–è€…<code>undefined</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   value: 2,</span>
<span class="token comment">//   configurable: false,</span>
<span class="token comment">//   writable: false,</span>
<span class="token comment">//   enumerable: false,</span>
<span class="token comment">// }</span>
</code></pre></div><p>â€ƒâ€ƒå‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>property</code>ä¸ºå±æ€§åã€‚</p> <p>â€ƒâ€ƒ;<code>Object.getOwnPropertyDescriptors</code>å†…éƒ¨ä¾èµ–äº<code>Object.getOwnPropertyDescriptor</code>ï¼Œåˆ™ä¹Ÿå¯ä»£ç†<code>Object.getOwnPropertyDescriptors</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   x: {</span>
<span class="token comment">//     value: 2,</span>
<span class="token comment">//     configurable: true,</span>
<span class="token comment">//     writable: false,</span>
<span class="token comment">//     enumerable: false,</span>
<span class="token comment">//   },</span>
<span class="token comment">//   y: {</span>
<span class="token comment">//     value: 2,</span>
<span class="token comment">//     configurable: true,</span>
<span class="token comment">//     writable: false,</span>
<span class="token comment">//     enumerable: false,</span>
<span class="token comment">//   },</span>
<span class="token comment">// }</span>
</code></pre></div><h3 id="defineproperty"><a href="#defineproperty" class="header-anchor">#</a> defineProperty</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/defineProperty" target="_blank" rel="noopener noreferrer">defineProperty(target, property, descriptor)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†å®šä¹‰å±æ€§çš„æ“ä½œï¼ŒåŒ…æ‹¬<code>Object.defineProperty(proxy, prop, descriptor)</code>æˆ–è€…<code>Reflect.defineProperty(proxy, prop, descriptor)</code>ã€<code>Object.defineProperties(proxy, descriptors)</code>ã€<code>proxy.prop = value</code>æˆ–è€…<code>proxy[prop] = value</code>ã€‚è¿”å›å€¼ä¸ºå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span>
	<span class="token comment">// {</span>
	<span class="token comment">//   configurable: true,</span>
	<span class="token comment">//   enumerable: true,</span>
	<span class="token comment">//   value: 1,</span>
	<span class="token comment">//   writable: true,</span>
	<span class="token comment">// }</span>

    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
</code></pre></div><p>â€ƒâ€ƒå‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>property</code>ä¸ºå±æ€§åï¼Œ<code>descriptor</code>ä¸ºå±æ€§æè¿°ç¬¦ã€‚</p> <p>â€ƒâ€ƒè‹¥<code>handler</code>ä¸­<code>set</code>ä¸<code>defineProperty</code>éƒ½å­˜åœ¨ï¼Œå°†ä¼˜å…ˆæ‰§è¡Œ<code>set</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'defineProperty'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment">// 'set'</span>
</code></pre></div><p>â€ƒâ€ƒä¸<code>set</code>ä¸€è‡´ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹è‹¥è¿”å›<code>false</code>ï¼Œå°†æŠ›å‡ºé”™è¯¯ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'use strict'</span>

<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment">// Uncaught TypeError: 'defineProperty' on proxy: trap returned falsish for property 'value'</span>
</code></pre></div><h3 id="preventextensions"><a href="#preventextensions" class="header-anchor">#</a> preventExtensions</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/preventExtensions" target="_blank" rel="noopener noreferrer">preventExtensions(target)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†é˜»æ­¢å¯¹è±¡æ‹“å±•çš„æ“ä½œï¼ŒåŒ…æ‹¬<code>Object.preventExtensions(proxy)</code>æˆ–è€…<code>Reflect.preventExtensions(proxy)</code>ã€‚è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºé˜»æ­¢æˆåŠŸã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">preventExtensions</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'preventExtensions'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// 'preventExtensions'</span>
</code></pre></div><h3 id="isextensible"><a href="#isextensible" class="header-anchor">#</a> isExtensible</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/isExtensible" target="_blank" rel="noopener noreferrer">isExtensible(target)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯æ‹“å±•çš„æ“ä½œï¼ŒåŒ…æ‹¬<code>Object.isExtensible(proxy)</code>æˆ–è€…<code>Reflect.isExtensible(proxy)</code>ã€‚è¿”å›å€¼å°†è½¬æ¢ä¸ºå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å¯æ‹“å±•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">isExtensible</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">isExtensible</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="getprototypeof"><a href="#getprototypeof" class="header-anchor">#</a> getPrototypeOf</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/getPrototypeOf" target="_blank" rel="noopener noreferrer">getPrototypeOf(target)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†è·å–å¯¹è±¡åŸå‹çš„æ“ä½œï¼ŒåŒ…æ‹¬ã€‚</p> <ul><li><code>Object.getPrototypeOf(proxy)</code></li> <li><code>Reflect.getPrototypeOf(proxy)</code></li> <li><code>proxy.__proto__</code></li> <li><code>Object.prototype.isPrototypeOf(proxy)</code></li> <li><code>proxy instanceof Object</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// Number {1}</span>
Reflect<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// Number {1}</span>
proxy<span class="token punctuation">.</span>__proto__ <span class="token comment">// Number {1}</span>
<span class="token class-name">Number</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// true</span>
proxy <span class="token keyword">instanceof</span> <span class="token class-name">Number</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="setprototypeof"><a href="#setprototypeof" class="header-anchor">#</a> setPrototypeOf</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/setPrototypeOf" target="_blank" rel="noopener noreferrer">setPrototypeOf(target, prototype)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†è®¾ç½®åŸå‹çš„æ“ä½œï¼ŒåŒ…æ‹¬<code>Object.setPrototypeOf(proxy, prototype)</code>æˆ–è€…<code>Reflect.setPrototypeOf(proxy, prototype)</code>ã€‚è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®æˆåŠŸã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> prototype</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Reflect<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>â€ƒâ€ƒå‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>prototype</code>ä¸ºåŸå‹å¯¹è±¡æˆ–è€…<code>null</code>ã€‚</p> <h3 id="apply"><a href="#apply" class="header-anchor">#</a> apply</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/apply" target="_blank" rel="noopener noreferrer">apply(target, thisArg, args)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†å‡½æ•°çš„æ™®é€šè°ƒç”¨ï¼ŒåŒ…æ‹¬<code>proxy(args)</code>ã€<code>proxy.call(thisArg, args)</code>æˆ–è€…<code>proxy.apply(thisArg, args)</code>ã€<code>Reflect.apply(proxy, thisArg, args)</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> thisArg<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Reflect</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> thisArg<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token function">proxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 9</span>
<span class="token function">proxy</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// 21</span>
<span class="token function">Reflect</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 33</span>
</code></pre></div><p>â€ƒâ€ƒå‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>thisArg</code>ä¸ºè¢«è°ƒç”¨æ—¶çš„ä¸Šä¸‹æ–‡å¯¹è±¡<code>this</code>ï¼Œ<code>args</code>ä¸ºè¢«è°ƒç”¨æ—¶çš„å‚æ•°æ•°ç»„ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 21</span>
</code></pre></div><p>â€ƒâ€ƒåˆ†æä»¥ä¸Šè¯­å¥ï¼Œä¹Ÿå°±æ˜¯<code>Function.prototype.apply</code>å‡½æ•°æ‰§è¡Œäº†<code>call</code>æ–¹æ³•ï¼Œå‡½æ•°å†…éƒ¨<code>this</code>æŒ‡å‘äº†<code>proxy</code>ï¼Œå‚æ•°ä¸º<code>null</code> <code>[3, 4]</code>ï¼Œå³<code>Function.prototype.apply(null, [3, 4])</code>ï¼ˆå†…éƒ¨<code>this</code>ä¸º<code>proxy</code>ï¼‰ï¼Œç­‰ä»·äºè¿è¡Œ<code>proxy.apply(null, [3, 4])</code>ã€‚</p> <h3 id="construct"><a href="#construct" class="header-anchor">#</a> construct</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/construct" target="_blank" rel="noopener noreferrer">construct(target, args, newTarget)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºä»£ç†æ„é€ å‡½æ•°çš„<code>new</code>è°ƒç”¨ï¼ŒåŒ…æ‹¬<code>new proxy(args)</code>æˆ–è€…<code>Reflect.construct(proxy, args, newTarget)</code>ã€‚è¿”å›å€¼ä¸ºå¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
<span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">construct</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> args<span class="token punctuation">,</span> newTarget</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newTarget <span class="token operator">===</span> Ctr<span class="token punctuation">)</span> <span class="token comment">// true</span>

    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">,</span> newTarget<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> Ctr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token constant">F</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Ctr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// F {x: 1, y: 2}</span>
</code></pre></div><p>â€ƒâ€ƒå‚æ•°<code>target</code>ä¸ºç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰ï¼Œ<code>args</code>ä¸ºè¢«è°ƒç”¨æ—¶çš„å‚æ•°æ•°ç»„ï¼Œ<code>newTarget</code>ä¸º<code>new</code>å‘½ä»¤ä½œç”¨çš„æ„é€ å‡½æ•°ã€‚</p> <h3 id="proxy-revocable"><a href="#proxy-revocable" class="header-anchor">#</a> Proxy.revocable</h3> <p>â€ƒâ€ƒ;<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/revocable" target="_blank" rel="noopener noreferrer">Proxy.revocable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”¨äºåˆ›å»ºå¯æ’¤é”€çš„ä»£ç†å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> revocable <span class="token operator">=</span> Proxy<span class="token punctuation">.</span><span class="token function">revocable</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre></div><p>â€ƒâ€ƒè¿”å›å€¼ä¸ºå¯¹è±¡ï¼ŒåŒ…æ‹¬<code>proxy</code>å’Œ<code>revoke</code>å±æ€§ï¼Œ<code>proxy</code>ä¸ºæ–°ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ï¼Œ<code>revoke</code>ä¸ºæ’¤é”€ä»£ç†çš„æ–¹æ³•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token punctuation">{</span> proxy<span class="token punctuation">,</span> revoke <span class="token punctuation">}</span> <span class="token operator">=</span> Proxy<span class="token punctuation">.</span><span class="token function">revocable</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   [[Handler]]: Object,</span>
<span class="token comment">//   [[Target]]: Object,</span>
<span class="token comment">//   [[IsRevoked]]: false,</span>
<span class="token comment">// }</span>

<span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   [[Handler]]: null,</span>
<span class="token comment">//   [[Target]]: null,</span>
<span class="token comment">//   [[IsRevoked]]: true,</span>
<span class="token comment">// }</span>
</code></pre></div><p>â€ƒâ€ƒä»£ç†å¯¹è±¡è¢«æ’¤é”€åï¼Œæ‰§è¡Œä»»ä½•çš„å¯ä»£ç†æ“ä½œéƒ½å°†æŠ›å‡ºé”™è¯¯ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token punctuation">{</span> proxy<span class="token punctuation">,</span> revoke <span class="token punctuation">}</span> <span class="token operator">=</span> Proxy<span class="token punctuation">.</span><span class="token function">revocable</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token comment">// 1</span>

<span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token comment">// Uncaught TypeError: Cannot perform 'get' on a proxy that has been revoked</span>
</code></pre></div><h2 id="çº¦æŸ"><a href="#çº¦æŸ" class="header-anchor">#</a> çº¦æŸ</h2> <h3 id="å†…éƒ¨æ–¹æ³•"><a href="#å†…éƒ¨æ–¹æ³•" class="header-anchor">#</a> å†…éƒ¨æ–¹æ³•</h3> <p>â€ƒâ€ƒ;<code>JavaScript</code>ä¸­åˆ›å»ºçš„å¯¹è±¡ï¼Œä¼šè¢«å¼•æ“èµ‹äºˆå¾ˆå¤š <a href="https://262.ecma-international.org/13.0/#sec-object-internal-methods-and-internal-slots" target="_blank" rel="noopener noreferrer">å†…éƒ¨æ–¹æ³•<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œåœ¨å¼€å‘è€…å±‚é¢æ˜¯ä¸å¯è§çš„ã€‚</p> <p>â€ƒâ€ƒæ™®é€šå¯¹è±¡ä¸Šå…±æœ‰<code>11</code>ä¸ªå†…éƒ¨æ–¹æ³•ã€‚</p> <ul><li><code>[[GetPrototypeOf]]()</code></li> <li><code>[[SetPrototypeOf]](V)</code></li> <li><code>[[IsExtensible]]()</code></li> <li><code>[[PreventExtensions]]()</code></li> <li><code>[[GetOwnProperty]](P)</code></li> <li><code>[[DefineOwnProperty]](P, Desc)</code></li> <li><code>[[HasProperty]](P)</code></li> <li><code>[[Get]](P, Receiver)</code></li> <li><code>[[Set]](P, V, Receiver)</code></li> <li><code>[[Delete]](P)</code></li> <li><code>[[OwnPropertyKeys]]()</code></li></ul> <p>â€ƒâ€ƒå†…éƒ¨æ–¹æ³•ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒä¸¾ä¸ªä¾‹å­ï¼Œåœ¨åˆ é™¤å¯¹è±¡å±æ€§æ—¶ï¼Œå¼•æ“ä¼šå»æ‰§è¡Œå¯¹è±¡ä¸Šçš„<code>[[Delete]](P)</code>å†…éƒ¨æ–¹æ³•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">delete</span> object<span class="token punctuation">.</span>prop
</code></pre></div><p>â€ƒâ€ƒå‡½æ•°ä½œä¸ºä¸€ç±»ç‰¹æ®Šå¯¹è±¡ï¼Œè¿˜æ‹“å±•äº†éƒ¨åˆ†å†…éƒ¨æ–¹æ³•ã€‚åœ¨æ™®é€šè°ƒç”¨æ—¶ï¼Œå¼•æ“ä¼šå»æ‰§è¡Œ<code>[[Call]]</code>å†…éƒ¨æ–¹æ³•ã€‚ä½œä¸ºæ„é€ å‡½æ•°ï¼Œè¢«<code>new</code>è°ƒç”¨æ—¶ï¼Œå¼•æ“ä¼šå»æ‰§è¡Œ<code>[[Construct]]</code>å†…éƒ¨æ–¹æ³•ã€‚</p> <p>â€ƒâ€ƒä¾‹å¦‚ç®­å¤´å‡½æ•°åªæ‹“å±•äº†<code>[[Call]]</code>ï¼Œæ²¡æœ‰æ‹“å±•<code>[[Construct]]</code>å†…éƒ¨æ–¹æ³•ã€‚å› æ­¤åªèƒ½æ™®é€šè°ƒç”¨ï¼Œä¸èƒ½é€šè¿‡<code>new</code>è°ƒç”¨ï¼Œå®é™…ä¹Ÿå°±æ˜¯ç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°çš„æ ¹æœ¬åŸå› ã€‚</p> <h3 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="header-anchor">#</a> å¯¹æ¯”</h3> <p>â€ƒâ€ƒé‚£å¼€å‘è€…èƒ½è°ƒç”¨å†…éƒ¨æ–¹æ³•å—ï¼Ÿ</p> <p>â€ƒâ€ƒç­”æ¡ˆæ˜¯ä¸èƒ½ï¼Œå†…éƒ¨æ–¹æ³•æ˜¯å¼•æ“å±‚é¢çš„ä¸œè¥¿ã€‚</p> <p>â€ƒâ€ƒè™½ç„¶ä¸èƒ½è°ƒç”¨ï¼Œä½†æ˜¯æœ‰æ›¿ä»£å®ç°ï¼Œå³<code>ES6</code>æ–°å¼•å…¥çš„<code>Proxy</code>ä»£ç†å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨<code>JavaScript</code>ä»£ç ï¼Œè‡ªå®šä¹‰åˆšåˆšé‚£<code>13</code>ä¸ªå†…éƒ¨æ–¹æ³•ã€‚</p> <p>â€ƒâ€ƒä»¥è·å–å±æ€§å€¼ä¸ºä¾‹ï¼Œå¯¹æ¯”æ™®é€šå¯¹è±¡å’Œä»£ç†å¯¹è±¡çš„å·®å¼‚ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
object<span class="token punctuation">.</span>value

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
proxy<span class="token punctuation">.</span>value
</code></pre></div><p>â€ƒâ€ƒæ™®é€šå¯¹è±¡åœ¨è·å–å±æ€§å€¼æ—¶ï¼Œå¼•æ“ä¼šå»æ‰§è¡Œå¯¹è±¡ä¸Šçš„<code>[[Get]](P, Receiver)</code>å†…éƒ¨æ–¹æ³•ã€‚è€Œä»£ç†å¯¹è±¡åœ¨è·å–å±æ€§å€¼æ—¶ï¼Œå°†ä¼šå»æ‰§è¡Œ<code>handler</code>å¯¹è±¡ä¸Šçš„<code>get</code>æ–¹æ³•ã€‚</p> <p><img src="/js/proxy/get.png" alt=""></p> <p>â€ƒâ€ƒ;<code>handler</code>å¯¹è±¡ä¸­çš„<code>13</code>ä¸ªæ–¹æ³•åˆšå¥½å¯¹åº”äº†å¼•æ“å±‚é¢çš„<code>13</code>ä¸ªå†…éƒ¨æ–¹æ³•ã€‚</p> <table><thead><tr><th style="text-align:center;"><code>Handler Method</code></th> <th style="text-align:center;"><code>Internal Method</code></th></tr></thead> <tbody><tr><td style="text-align:center;"><code>getPrototypeOf</code></td> <td style="text-align:center;"><code>[[GetPrototypeOf]]()</code></td></tr> <tr><td style="text-align:center;"><code>setPrototypeOf</code></td> <td style="text-align:center;"><code>[[SetPrototypeOf]](V)</code></td></tr> <tr><td style="text-align:center;"><code>isExtensible</code></td> <td style="text-align:center;"><code>[[IsExtensible]]()</code></td></tr> <tr><td style="text-align:center;"><code>preventExtensions</code></td> <td style="text-align:center;"><code>[[PreventExtensions]]()</code></td></tr> <tr><td style="text-align:center;"><code>getOwnPropertyDescriptor</code></td> <td style="text-align:center;"><code>[[GetOwnProperty]](P)</code></td></tr> <tr><td style="text-align:center;"><code>defineProperty</code></td> <td style="text-align:center;"><code>[[DefineOwnProperty]](P, Desc)</code></td></tr> <tr><td style="text-align:center;"><code>has</code></td> <td style="text-align:center;"><code>[[HasProperty]](P)</code></td></tr> <tr><td style="text-align:center;"><code>get</code></td> <td style="text-align:center;"><code>[[Get]](P, Receiver)</code></td></tr> <tr><td style="text-align:center;"><code>set</code></td> <td style="text-align:center;"><code>[[Set]](P, V, Receiver)</code></td></tr> <tr><td style="text-align:center;"><code>deleteProperty</code></td> <td style="text-align:center;"><code>[[Delete]](P)</code></td></tr> <tr><td style="text-align:center;"><code>ownKeys</code></td> <td style="text-align:center;"><code>[[OwnPropertyKeys]]()</code></td></tr> <tr><td style="text-align:center;"><code>apply</code></td> <td style="text-align:center;"><code>[[Call]]</code></td></tr> <tr><td style="text-align:center;"><code>construct</code></td> <td style="text-align:center;"><code>[[Construct]]</code></td></tr></tbody></table> <h3 id="ä¸å˜é‡"><a href="#ä¸å˜é‡" class="header-anchor">#</a> ä¸å˜é‡</h3> <p>â€ƒâ€ƒä½ å¯èƒ½å‘ç°äº†å›¾ç¤ºä¸­çš„<code>invariant</code>ï¼Œæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒ;<code>ECMA-262</code>è§„èŒƒä¸­çš„ç¬¬ <a href="https://262.ecma-international.org/13.0/#sec-invariants-of-the-essential-internal-methods" target="_blank" rel="noopener noreferrer">6.1.7.3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å°èŠ‚ç»™å‡ºäº†ç­”æ¡ˆã€‚</p> <blockquote><p><code>6.1.7.3 Invariants of the Essential Internal Methods</code><br> <code>The Internal Methods of Objects of an ECMAScript engine must conform to the list of invariants specified below. Ordinary ECMAScript Objects as well as all standard exotic objects in this specification maintain these invariants. <strong>ECMAScript Proxy objects maintain these invariants by means of runtime checks on the result of traps invoked on the [[ProxyHandler]] object.</strong></code><br> <code>Any implementation provided exotic objects must also maintain these invariants for those objects. Violation of these invariants may cause ECMAScript code to have unpredictable behaviour and create security issues. However, violation of these invariants must never compromise the memory safety of an implementation.</code></p></blockquote> <p>â€ƒâ€ƒå¤§è‡´è¯­ä¹‰ä¸ºï¼Œ<code>ECMAScript</code>ä¸­å†…éƒ¨æ–¹æ³•æœ‰ä¸€äº›é™åˆ¶è§„åˆ™ï¼Œç§°ä¹‹ä¸ºä¸å˜é‡ï¼ˆ<code>invariant</code>ï¼‰ã€‚ç›®çš„æ˜¯ä¸ºäº†é¿å…ä»£ç å‡ºç°ä¸å¯é¢„æµ‹çš„è¡Œä¸ºä»è€Œå¯¼è‡´äº§ç”Ÿå®‰å…¨é—®é¢˜ã€‚</p> <p>â€ƒâ€ƒæˆ‘ä»¬æ¥ç»†è¯»è§„èŒƒä¸­<code>[[Construct]]()</code>çš„ä¸å˜é‡ã€‚</p> <blockquote><p><code>[[Construct]]()</code><br> <code>The normal return type is Object.</code><br> <code>The target must also have a [[Call]] internal method.</code></p></blockquote> <p>â€ƒâ€ƒç¬¬ä¸€æ¡æ˜¯æ–¹æ³•è¿”å›ç±»å‹å¿…é¡»ä¸ºå¯¹è±¡ï¼Œç¬¬äºŒæ¡æ˜¯ç›®æ ‡å¯¹è±¡å¿…é¡»æœ‰<code>[[Call]]</code>å†…éƒ¨æ–¹æ³•ã€‚</p> <p>â€ƒâ€ƒæ¥ç€å†æ¥çœ‹çœ‹åˆšæ‰å¼•ç”¨ä¸­åŠ ç²—çš„éƒ¨åˆ†ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒå³æ˜¯è¯´<code>ECMAScript</code>ä»£ç†å¯¹è±¡åœ¨è¿è¡Œ<code>trap</code>æ—¶ï¼Œä¼šæ£€æµ‹è¿”å›ç»“æœæ˜¯å¦ç¬¦åˆå¯¹åº”çš„ä¸å˜é‡ï¼Œä»¥ä¿æŒä¸å†…éƒ¨æ–¹æ³•çš„ç»Ÿä¸€æ€§ã€‚</p> <blockquote><p><code>trap</code>ï¼Œå³<code>Handler Method</code>ï¼Œä¹Ÿå°±æ˜¯é…ç½®å¯¹è±¡<code>handler</code>ä¸Šçš„æ–¹æ³•</p></blockquote> <p>â€ƒâ€ƒæ¢å¥è¯è¯´ï¼Œä¸ç®¡æ˜¯å†…éƒ¨æ–¹æ³•ï¼ˆ<code>Internal Method</code>ï¼‰è¿˜æ˜¯ä»£ç†æ–¹æ³•ï¼ˆ<code>Handler Method</code>ï¼‰ï¼Œéƒ½è¦ç¬¦åˆè§„èŒƒä¸­ç‰¹å®šçš„ä¸å˜é‡ã€‚</p> <p>â€ƒâ€ƒæ‰€ä»¥<code>handler.construct()</code>æ–¹æ³•ä¹Ÿè¦ç¬¦åˆ<code>[[Construct]]()</code>çš„ä¸å˜é‡ï¼Œä¾‹å¦‚ç¬¬ä¸€æ¡ä¸­è¿”å›å€¼å¿…é¡»ä¸ºå¯¹è±¡ã€‚åœ¨è¿è¡Œæ—¶ï¼Œä¸ç¬¦åˆå°†æŠ›å‡ºé”™è¯¯ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token constant">P</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">P</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'construct' on proxy: trap returned non-object ('1')</span>
</code></pre></div><h4 id="get-2"><a href="#get-2" class="header-anchor">#</a> get</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§æ˜¯ä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰ä¸”ä¸å¯å†™ï¼ˆ<code>non-writable</code>ï¼‰çš„ï¼Œåˆ™è¿”å›å€¼å¿…é¡»ä¸ç›®æ ‡å¯¹è±¡çš„å±æ€§å€¼ç›¸åŒã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">3</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value
<span class="token comment">// Uncaught TypeError: 'get' on proxy: property 'value' is a read-only and non-configurable data property on the proxy target but the proxy did not return its actual value (expected '2' but got '3')</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸ºä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰ä¸”æ²¡æœ‰<code>get</code>æè¿°ç¬¦ï¼Œåˆ™è¿”å›å€¼å¿…é¡»ä¸º<code>undefined</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">3</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value
<span class="token comment">// Uncaught TypeError: 'get' on proxy: property 'value' is a non-configurable accessor property on the proxy target and does not have a getter function, but the trap did not return 'undefined' (got '3')</span>
</code></pre></div><p>â€ƒâ€ƒä¸ªäººè®¤ä¸ºï¼Œå±æ€§ä¸ºä¸å¯é…ç½®ä¸”ä¸å¯å†™ï¼Œæˆ–è€…ä¸ºä¸å¯é…ç½®ä¸”æ²¡æœ‰<code>get</code>ï¼Œè·å–å±æ€§å€¼æ—¶éƒ½å°†è¿”å›å›ºå®šå€¼ã€‚è€Œå±æ€§è¯»å–çš„ä»£ç†æ“ä½œï¼Œå®é™…ä¹Ÿå°±æ²¡æœ‰æ„ä¹‰ï¼Œä¸ºäº†ä¸€è‡´æ€§åˆ™çº¦æŸè¿”å›å€¼ä¸åŸå€¼ç›¸åŒã€‚</p> <h4 id="set-2"><a href="#set-2" class="header-anchor">#</a> set</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§æ˜¯ä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰ä¸”ä¸å¯å†™ï¼ˆ<code>non-writable</code>ï¼‰çš„ï¼Œåˆ™å¿…é¡»è¿”å›<code>false</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">15</span>
<span class="token comment">// Uncaught TypeError: 'set' on proxy: trap returned truish for property 'value' which exists in the proxy target as a non-configurable and non-writable data property with a different value</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸ºä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰ä¸”æ²¡æœ‰<code>set</code>æè¿°ç¬¦ï¼Œåˆ™å¿…é¡»è¿”å›<code>false</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">15</span>
<span class="token comment">// Uncaught TypeError: 'set' on proxy: trap returned truish for property 'value' which exists in the proxy target as a non-configurable and non-writable accessor property without a setter</span>
</code></pre></div><p>â€ƒâ€ƒç±»ä¼¼çš„ï¼Œå±æ€§ä¸ºä¸å¯é…ç½®ä¸”ä¸å¯å†™ï¼Œæˆ–è€…ä¸ºä¸å¯é…ç½®ä¸”æ²¡æœ‰<code>set</code>ï¼Œéƒ½æ„å‘³ç€åŸå¯¹è±¡çš„å±æ€§å€¼æ— æ³•ä¿®æ”¹ã€‚è€Œå±æ€§ä¿®æ”¹çš„ä»£ç†æ“ä½œï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸ä¼šæˆåŠŸï¼Œä¸ºäº†ä¸€è‡´æ€§åˆ™å¿…é¡»è¿”å›<code>false</code>ã€‚</p> <h4 id="has-2"><a href="#has-2" class="header-anchor">#</a> has</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸ºä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰ï¼Œåˆ™å¿…é¡»è¿”å›<code>true</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">has</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token string">'value'</span> <span class="token keyword">in</span> proxy
<span class="token comment">// Uncaught TypeError: 'has' on proxy: trap returned falsish for property 'value' which exists in the proxy target as non-configurable</span>
</code></pre></div><p>â€ƒâ€ƒå±æ€§ä¸ºä¸å¯é…ç½®ï¼ŒåŸå¯¹è±¡çš„å±æ€§ä¸å¯èƒ½è¢«åˆ é™¤ï¼Œä¹Ÿå°±æ„å‘³ç€åŸå¯¹è±¡è‚¯å®šæœ‰æ­¤å±æ€§ã€‚è€Œæ˜¯å¦æœ‰æ­¤å±æ€§çš„ä»£ç†æ“ä½œï¼Œä¹Ÿå°±æ²¡æœ‰ä»»ä½•æ„ä¹‰äº†ï¼Œä¸ºäº†ä¸€è‡´æ€§åˆ™å¿…é¡»è¿”å›<code>true</code>ã€‚</p> <h4 id="deleteproperty-2"><a href="#deleteproperty-2" class="header-anchor">#</a> deleteProperty</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸ºä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰ï¼Œåˆ™å¿…é¡»è¿”å›<code>false</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">delete</span> proxy<span class="token punctuation">.</span>value
<span class="token comment">// Uncaught TypeError: 'deleteProperty' on proxy: trap returned truish for property 'value' which is non-configurable in the proxy target</span>
</code></pre></div><p>â€ƒâ€ƒå±æ€§ä¸ºä¸å¯é…ç½®ï¼ŒåŸå¯¹è±¡çš„å±æ€§ä¸å¯èƒ½è¢«åˆ é™¤ï¼Œè€Œåˆ é™¤å±æ€§çš„ä»£ç†æ“ä½œï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸ä¼šæˆåŠŸï¼Œä¸ºäº†ä¸€è‡´æ€§åˆ™å¿…é¡»è¿”å›<code>false</code>ã€‚</p> <h4 id="ownkeys-2"><a href="#ownkeys-2" class="header-anchor">#</a> ownKeys</h4> <p>â€ƒâ€ƒè¿”å›çš„ç»“æœåˆ—è¡¨ä¸­ï¼Œå¿…é¡»è¦åŒ…å«æ‰€æœ‰ä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰çš„è‡ªèº«å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'ownKeys' on proxy: trap result did not include 'x'</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œåˆ™å¿…é¡»è¿”å›æ‰€æœ‰çš„è‡ªèº«å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'ownKeys' on proxy: trap result did not include 'x'</span>
</code></pre></div><p>â€ƒâ€ƒå¹¶ä¸”ä¸å¯è¿”å›ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'ownKeys' on proxy: trap returned extra keys but proxy target is non-extensible</span>
</code></pre></div><h4 id="getownpropertydescriptor-2"><a href="#getownpropertydescriptor-2" class="header-anchor">#</a> getOwnPropertyDescriptor</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸ºä¸å¯é…ç½®ï¼ˆ<code>non-configurable</code>ï¼‰ï¼Œä¸å¯è¿”å›<code>undefined</code>ï¼Œå¿…é¡»è¿”å›å±æ€§æè¿°ç¬¦ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">undefined</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'getOwnPropertyDescriptor' on proxy: trap returned undefined for property 'value' which is non-configurable in the proxy target</span>
</code></pre></div><p>â€ƒâ€ƒå¹¶ä¸”æè¿°ç¬¦å¿…é¡»ä¸ç›®æ ‡å¯¹è±¡çš„ä¸€è‡´ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'getOwnPropertyDescriptor' on proxy: trap returned descriptor for property 'value' that is incompatible with the existing property in the proxy target</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§å¯é…ç½®ï¼Œè¿”å›çš„å±æ€§æè¿°ç¬¦ä¸­<code>configurable</code>å¿…é¡»ä¸º<code>true</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'getOwnPropertyDescriptor' on proxy: trap reported non-configurability for property 'value' which is either non-existent or configurable in the proxy target</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸å­˜åœ¨ï¼Œè¿”å›çš„å±æ€§æè¿°ç¬¦ä¸­<code>configurable</code>å¿…é¡»ä¸º<code>true</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'getOwnPropertyDescriptor' on proxy: trap reported non-configurability for property 'value' which is either non-existent or configurable in the proxy target</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œä¸”å±æ€§å­˜åœ¨ï¼Œä¸å¯è¿”å›<code>undefined</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">undefined</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'getOwnPropertyDescriptor' on proxy: trap returned undefined for property 'value' which exists in the non-extensible proxy target</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œä¸”å±æ€§ä¸å­˜åœ¨ï¼Œå¿…é¡»è¿”å›<code>undefined</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'getOwnPropertyDescriptor' on proxy: trap returned descriptor for property 'value' that is incompatible with the existing property in the proxy target</span>
</code></pre></div><h4 id="defineproperty-2"><a href="#defineproperty-2" class="header-anchor">#</a> defineProperty</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›<code>false</code>ï¼Œè¡¨ç¤ºä¸å¯æ·»åŠ æ–°å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment">// Uncaught TypeError: 'defineProperty' on proxy: trap returned truish for adding property 'value'  to the non-extensible proxy target</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸å­˜åœ¨ï¼Œå®šä¹‰çš„å±æ€§æè¿°ç¬¦<code>configurable</code>å¿…é¡»ä¸º<code>true</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'defineProperty' on proxy: trap returned truish for defining non-configurable property 'value' which is either non-existent or configurable in the proxy target</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡çš„å±æ€§ä¸ºå¯é…ç½®ï¼ˆ<code>configurable</code>ï¼‰ï¼Œå®šä¹‰çš„å±æ€§æè¿°ç¬¦<code>configurable</code>å¿…é¡»ä¸º<code>true</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'defineProperty' on proxy: trap returned truish for defining non-configurable property 'value' which is either non-existent or configurable in the proxy target</span>
</code></pre></div><h4 id="preventextensions-2"><a href="#preventextensions-2" class="header-anchor">#</a> preventExtensions</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡æ˜¯å¯æ‹“å±•çš„ï¼Œå¿…é¡»è¿”å›<code>false</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">preventExtensions</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'preventExtensions' on proxy: trap returned truish but the proxy target is extensible</span>
</code></pre></div><h4 id="isextensible-2"><a href="#isextensible-2" class="header-anchor">#</a> isExtensible</h4> <p>â€ƒâ€ƒ;<code>Object.isExtensible(proxy)</code>è¿”å›å€¼å¿…é¡»ä¸<code>Object.isExtensible(target)</code>ä¸€è‡´ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">isExtensible</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">isExtensible</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'isExtensible' on proxy: trap result does not reflect extensibility of proxy target (which is 'true')</span>
</code></pre></div><h4 id="getprototypeof-2"><a href="#getprototypeof-2" class="header-anchor">#</a> getPrototypeOf</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›ç›®æ ‡å¯¹è±¡çš„å®é™…åŸå‹ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'getPrototypeOf' on proxy: proxy target is non-extensible but the trap did not return its actual prototype</span>
</code></pre></div><p>â€ƒâ€ƒå¯¹è±¡ä¸å¯æ‹“å±•ï¼Œä¸èƒ½ä¿®æ”¹åŸå‹çš„æŒ‡å‘ï¼Œä¹Ÿå°±æ„å‘³ç€åŸå‹æ˜¯å›ºå®šçš„ã€‚è€Œä»£ç†è·å–åŸå‹çš„æ“ä½œï¼Œä¹Ÿå°±æ²¡æœ‰ä»»ä½•æ„ä¹‰äº†ï¼Œä¸ºäº†ä¸€è‡´æ€§åˆ™å¿…é¡»è¿”å›å¯¹è±¡çš„å®é™…åŸå‹ã€‚</p> <h4 id="setprototypeof-2"><a href="#setprototypeof-2" class="header-anchor">#</a> setPrototypeOf</h4> <p>â€ƒâ€ƒè‹¥ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›<code>false</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>

<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> prototype</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

Reflect<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'setPrototypeOf' on proxy: trap returned truish for setting a new prototype on the non-extensible proxy target</span>
</code></pre></div><p>â€ƒâ€ƒç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œä¸èƒ½ä¿®æ”¹åŸå‹æŒ‡å‘ã€‚è€Œä»£ç†è®¾ç½®åŸå‹çš„æ“ä½œï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸ä¼šæˆåŠŸï¼Œä¸ºäº†ä¸€è‡´æ€§åˆ™å¿…é¡»è¿”å›<code>false</code>ã€‚</p> <h4 id="apply-2"><a href="#apply-2" class="header-anchor">#</a> apply</h4> <p>â€ƒâ€ƒæ— ã€‚</p> <h4 id="construct-2"><a href="#construct-2" class="header-anchor">#</a> construct</h4> <p>â€ƒâ€ƒå¿…é¡»è¿”å›å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">construct</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> thisArg<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> Ctr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token constant">F</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Ctr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: 'construct' on proxy: trap returned non-object ('1')</span>
</code></pre></div><h3 id="å°ç»“-2"><a href="#å°ç»“-2" class="header-anchor">#</a> å°ç»“</h3> <table><thead><tr><th><code>Handler Method</code></th> <th>ä»£ç†è¡Œä¸º</th> <th>ä¸å˜é‡</th></tr></thead> <tbody><tr><td><code>get(target, property, receiver)</code></td> <td align="left"><ul><li><code>proxy[prop]</code></li> <li><code>proxy.prop</code></li> <li><code>Object.create(proxy)[prop]</code></li> <li><code>Reflect.get(proxy, property)</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å¯é…ç½®ä¸”ä¸å¯å†™ï¼Œè¿”å›å€¼å¿…é¡»ä¸ç›®æ ‡å¯¹è±¡çš„å±æ€§å€¼ç›¸åŒ</li> <li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å¯é…ç½®ä¸”æ— <code>get</code>æè¿°ç¬¦ï¼Œè¿”å›å€¼å¿…é¡»ä¸º<code>undefined</code></li></ul></td></tr> <tr><td><code>set(target, property, value, receiver)</code></td> <td align="left"><ul><li><code>proxy.prop = value</code></li> <li><code>proxy[prop] = value</code></li> <li><code>Object.create(proxy)[prop] = value</code></li> <li><code>Reflect.set(proxy, property, value)</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å¯é…ç½®ä¸”ä¸å¯å†™ï¼Œå¿…é¡»è¿”å›<code>false</code></li> <li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å¯é…ç½®ä¸”æ— <code>set</code>æè¿°ç¬¦ï¼Œå¿…é¡»è¿”å›<code>false</code></li></ul></td></tr> <tr><td><code>has(target, property)</code></td> <td align="left"><ul><li><code>prop in proxy</code></li> <li><code>prop in Object.create(proxy)</code></li> <li><code>with(proxy){ prop; }</code></li> <li><code>with(Object.create(proxy)){ prop; }</code></li> <li><code>Reflect.has(proxy, property)</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å¯é…ç½®ï¼Œå¿…é¡»è¿”å›<code>true</code></li></ul></td></tr> <tr><td><code>deleteProperty(target, property)</code></td> <td align="left"><ul><li><code>delete proxy.prop</code></li> <li><code>delete proxy[prop]</code></li> <li><code>Reflect.deleteProperty(proxy, property)</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å¯é…ç½®ï¼Œå¿…é¡»è¿”å›<code>false</code></li></ul></td></tr> <tr><td><code>ownKeys(target)</code></td> <td align="left"><ul><li><code>for...in</code></li> <li><code>Object.keys(proxy) / Object.values(proxy) / Object.entries(proxy)</code></li> <li><code>Object.getOwnPropertyNames(proxy)</code></li> <li><code>Object.getOwnPropertySymbols(proxy)</code></li> <li><code>Reflect.ownKeys(proxy)</code></li></ul></td> <td align="left"><ul><li>è¿”å›çš„ç»“æœåˆ—è¡¨ï¼Œå¿…é¡»åŒ…å«æ‰€æœ‰ä¸å¯é…ç½®çš„è‡ªèº«å±æ€§</li> <li>ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›æ‰€æœ‰çš„è‡ªèº«å±æ€§ï¼Œä¸”ä¸å¯è¿”å›ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§</li></ul></td></tr> <tr><td><code>getOwnPropertyDescriptor(target, property)</code></td> <td align="left"><ul><li><code>Object.getOwnPropertyDescriptor(proxy, prop)</code></li> <li><code>Reflect.getOwnPropertyDescriptor(proxy, prop)</code></li> <li><code>Object.getOwnPropertyDescriptors(proxy)</code></li></ul></td> <td align="left"><ul><li>
            ç›®æ ‡å¯¹è±¡å±æ€§ä¸å¯é…ç½®ï¼Œä¸å¯è¿”å›<code>undefined</code>ï¼Œå¿…é¡»è¿”å›å±æ€§æè¿°ç¬¦ï¼Œä¸”æè¿°ç¬¦å¿…é¡»ä¸ç›®æ ‡å¯¹è±¡çš„ä¸€è‡´
          </li> <li>ç›®æ ‡å¯¹è±¡å±æ€§å¯é…ç½®ï¼Œè¿”å›çš„å±æ€§æè¿°ç¬¦ä¸­<code>configurable</code>å¿…é¡»ä¸º<code>true</code></li> <li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å­˜åœ¨ï¼Œè¿”å›çš„å±æ€§æè¿°ç¬¦ä¸­<code>configurable</code>å¿…é¡»ä¸º<code>true</code></li> <li>ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œä¸”å±æ€§å­˜åœ¨ï¼Œä¸å¯è¿”å›<code>undefined</code></li> <li>ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œä¸”å±æ€§ä¸å­˜åœ¨ï¼Œå¿…é¡»è¿”å›<code>undefined</code></li></ul></td></tr> <tr><td><code>defineProperty(target, property, descriptor)</code></td> <td align="left"><ul><li><code>Object.defineProperty(proxy, prop, descriptor)</code></li> <li><code>Reflect.defineProperty(proxy, prop, descriptor)</code></li> <li><code>Object.defineProperties(proxy, descriptors)</code></li> <li><code>proxy.prop = value</code></li> <li><code>proxy[prop] = value</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›<code>false</code>ï¼Œå³ä¸å¯æ·»åŠ æ–°å±æ€§</li> <li>ç›®æ ‡å¯¹è±¡å±æ€§ä¸å­˜åœ¨ï¼Œå®šä¹‰çš„å±æ€§æè¿°ç¬¦<code>configurable</code>å¿…é¡»ä¸º<code>true</code></li> <li>ç›®æ ‡å¯¹è±¡å±æ€§å¯é…ç½®ï¼Œå®šä¹‰çš„å±æ€§æè¿°ç¬¦<code>configurable</code>å¿…é¡»ä¸º<code>true</code></li></ul></td></tr> <tr><td><code>preventExtensions(target)</code></td> <td align="left"><ul><li><code>Object.preventExtensions(proxy)</code></li> <li><code>Reflect.preventExtensions(proxy)</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›<code>false</code></li></ul></td></tr> <tr><td><code>isExtensible(target)</code></td> <td align="left"><ul><li><code>Object.isExtensible(proxy)</code></li> <li><code>Reflect.isExtensible(proxy)</code></li></ul></td> <td align="left"><ul><li><code>Object.isExtensible(proxy)</code>è¿”å›å€¼å¿…é¡»ä¸<code>Object.isExtensible(target)</code>ä¸€è‡´
          </li></ul></td></tr> <tr><td><code>getPrototypeOf(target)</code></td> <td align="left"><ul><li><code>Object.getPrototypeOf(proxy)</code></li> <li><code>Reflect.getPrototypeOf(proxy)</code></li> <li><code>proxy.__proto__</code></li> <li><code>Object.prototype.isPrototypeOf(proxy)</code></li> <li><code>proxy instanceof Object</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›ç›®æ ‡å¯¹è±¡çš„å®é™…åŸå‹</li></ul></td></tr> <tr><td><code>setPrototypeOf(target, prototype)</code></td> <td align="left"><ul><li><code>Object.setPrototypeOf(proxy, prototype)</code></li> <li><code>Reflect.setPrototypeOf(proxy, prototype)</code></li></ul></td> <td align="left"><ul><li>ç›®æ ‡å¯¹è±¡ä¸å¯æ‹“å±•ï¼Œå¿…é¡»è¿”å›<code>false</code></li></ul></td></tr> <tr><td><code>apply(target, thisArg, args)</code></td> <td align="left"><ul><li><code>proxy(args)</code></li> <li><code>proxy.call(thisArg, args)</code></li> <li><code>proxy.apply(thisArg, args)</code></li> <li><code>Reflect.apply(proxy, thisArg, args)</code></li></ul></td> <td>-</td></tr> <tr><td><code>construct(target, args, newTarget)</code></td> <td align="left"><ul><li><code>new proxy(args)</code></li> <li><code>Reflect.construct(proxy, args, newTarget)</code></li></ul></td> <td align="left"><ul><li>å¿…é¡»è¿”å›å¯¹è±¡</li></ul></td></tr></tbody></table> <h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="header-anchor">#</a> åº”ç”¨åœºæ™¯</h2> <h3 id="æ•°ç»„è´Ÿç´¢å¼•"><a href="#æ•°ç»„è´Ÿç´¢å¼•" class="header-anchor">#</a> æ•°ç»„è´Ÿç´¢å¼•</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">negative</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> property <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">&amp;&amp;</span> property <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        property <span class="token operator">=</span> target<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token function">Number</span><span class="token punctuation">(</span>property<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token function">negative</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
array<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment">// 3</span>
</code></pre></div><h3 id="éšè—å†…éƒ¨å±æ€§"><a href="#éšè—å†…éƒ¨å±æ€§" class="header-anchor">#</a> éšè—å†…éƒ¨å±æ€§</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>property<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'_'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">undefined</span>

    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>_id <span class="token comment">// undefined</span>
</code></pre></div><h3 id="åˆ›å»ºåªè¯»å¯¹è±¡"><a href="#åˆ›å»ºåªè¯»å¯¹è±¡" class="header-anchor">#</a> åˆ›å»ºåªè¯»å¯¹è±¡</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">readonly</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token function">readonly</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
object<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">2</span>

object<span class="token punctuation">.</span>value <span class="token comment">// 1</span>
</code></pre></div><blockquote><p>å‚è€ƒ <a href="https://cn.vuejs.org/api/reactivity-core.html#readonly" target="_blank" rel="noopener noreferrer">vue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å“åº”å¼<code>api</code>æ ¸å¿ƒæ–¹æ³• <a href="https://github.com/vuejs/core/blob/v3.2.41/packages/reactivity/src/baseHandlers.ts#L222" target="_blank" rel="noopener noreferrer">readonly<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åˆ›å»ºåªè¯»ä»£ç†</p></blockquote> <h3 id="æ”¯æŒé“¾å¼å±æ€§"><a href="#æ”¯æŒé“¾å¼å±æ€§" class="header-anchor">#</a> æ”¯æŒé“¾å¼å±æ€§</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">chaining</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> property<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">chaining</span><span class="token punctuation">(</span><span class="token punctuation">(</span>target <span class="token operator">??</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span>property<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> target
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token comment">// {x: 1}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span>x<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span>x<span class="token punctuation">.</span>y<span class="token punctuation">.</span>z<span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: Cannot read properties of undefined (reading 'z')</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">chaining</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// {x: 1}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">chaining</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">chaining</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">chaining</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">.</span>y<span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre></div><h3 id="å±æ€§å€¼æ ¡éªŒ"><a href="#å±æ€§å€¼æ ¡éªŒ" class="header-anchor">#</a> å±æ€§å€¼æ ¡éªŒ</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter">object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>property <span class="token operator">===</span> <span class="token string">'age'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'The age is not an integer'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18.5</span> <span class="token comment">// Uncaught TypeError: The age is not an integer</span>
</code></pre></div><h3 id="ç®¡é“"><a href="#ç®¡é“" class="header-anchor">#</a> ç®¡é“</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">pipe</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> funcs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> property<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      funcs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>property<span class="token punctuation">]</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> proxy
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> funcs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span> func</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">func</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> proxy
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">double</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> <span class="token number">2</span>
<span class="token keyword">var</span> <span class="token function-variable function">pow</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> n

<span class="token function">pipe</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>double<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 36</span>
</code></pre></div><h3 id="æ•°æ®ç›‘å¬"><a href="#æ•°æ®ç›‘å¬" class="header-anchor">#</a> æ•°æ®ç›‘å¬</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>æŒ‰é’®<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token keyword">function</span> <span class="token function">watch</span><span class="token punctuation">(</span><span class="token parameter">object<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>property<span class="token punctuation">,</span> value<span class="token punctuation">)</span>

      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">watch</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'value'</span><span class="token punctuation">)</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> value
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  proxy<span class="token punctuation">.</span>value<span class="token operator">++</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="header-anchor">#</a> å¸¸è§é—®é¢˜</h2> <h3 id="ä¸ºä»€ä¹ˆ-proxy-å¤§å¤šä¸-reflect-ç»“åˆä½¿ç”¨"><a href="#ä¸ºä»€ä¹ˆ-proxy-å¤§å¤šä¸-reflect-ç»“åˆä½¿ç”¨" class="header-anchor">#</a> ä¸ºä»€ä¹ˆ Proxy å¤§å¤šä¸ Reflect ç»“åˆä½¿ç”¨ï¼Ÿ</h3> <p>â€ƒâ€ƒä»¥å±æ€§èµ‹å€¼æ—¶æ‰“å°æ—¥å¿—ä¸ºä¾‹ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setter'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">// setter</span>
</code></pre></div><p>â€ƒâ€ƒ;<code>Reflect</code>å°†<code>set</code>è¯­ä¹‰é€ä¼ åˆ°ç›®æ ‡å¯¹è±¡ä¸Šï¼Œä¿æŒäº†é»˜è®¤çš„èµ‹å€¼è¡Œä¸ºã€‚</p> <p>â€ƒâ€ƒä»¥ä¸Šä¹Ÿå¯å†™æˆã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setter'</span><span class="token punctuation">)</span>

    target<span class="token punctuation">[</span>property<span class="token punctuation">]</span> <span class="token operator">=</span> value

    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>â€ƒâ€ƒä¸¤è€…æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œä½†æ˜¯æ³¨æ„åƒ<code>set/get</code>æ­¤ç±»<code>trap</code>ç›¸å¯¹å®¹æ˜“ï¼Œæœ‰äº›<code>trap</code>ä¾‹å¦‚<code>ownKeys</code>ï¼Œå¼€å‘è€…å‡ ä¹å¾ˆéš¾ç¼–å†™å‡ºæ¥ã€‚</p> <p>â€ƒâ€ƒç›¸å¯¹åˆç†çš„æ˜¯ï¼Œæ‰€æœ‰<code>trap</code>çš„é»˜è®¤è¡Œä¸ºéƒ½ç»Ÿä¸€ç”±<code>Reflect</code>æ¥åšã€‚æ¢å¥è¯è¯´ï¼Œæ— è®º<code>Proxy</code>ä»£ç†ä½•ç§æ“ä½œï¼Œæ€»æ˜¯å¯ä»¥åœ¨<code>Reflect</code>ä¸Šæ‰¾åˆ°å¯¹åº”çš„é»˜è®¤è¡Œä¸ºï¼Œä¹Ÿè¯´æ˜äº†ä¸ºä»€ä¹ˆ<code>trap</code>ä¸<code>Reflect</code>æ–¹æ³•æ˜¯ä¸€å¯¹ä¸€çš„ã€‚</p> <p>â€ƒâ€ƒå¦å¤–<code>set/get</code>ä¸­é¢å¤–çš„å‚æ•°<code>receiver</code>ï¼Œç”¨æ¥ä¿è¯<code>this</code>çš„æ­£ç¡®ä¼ é€’ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// or target[property]</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

x<span class="token punctuation">.</span>value <span class="token operator">===</span> x <span class="token comment">// true</span>
y<span class="token punctuation">.</span>value <span class="token operator">===</span> y <span class="token comment">// false</span>
</code></pre></div><p>â€ƒâ€ƒç»¼ä¸Šæ‰€è¿°ã€‚</p> <ul><li>ä¿æŒé»˜è®¤è¡Œä¸ºï¼Œé€ä¼ è¯­ä¹‰ï¼Œä¸”æ­£ç¡®ä¼ é€’<code>this</code></li> <li>å‡½æ•°å¼ç¼–ç¨‹ï¼Œè¯­ä¹‰æ¸…æ™°ï¼Œä»£ç å¯è‡ªè§£é‡Š</li> <li>è¯­è¨€å†…éƒ¨æ“ä½œç»Ÿä¸€éƒ¨ç½²è‡³<code>Reflect</code>ï¼Œæœ‰åˆ©äºç®¡ç†å’Œç»´æŠ¤</li></ul> <h3 id="proxy-å¦‚ä½•ä»£ç†-map"><a href="#proxy-å¦‚ä½•ä»£ç†-map" class="header-anchor">#</a> Proxy å¦‚ä½•ä»£ç† Mapï¼Ÿ</h3> <p>â€ƒâ€ƒ;<code>JavaScript</code>å¯¹è±¡é™¤äº†ä¼šè¢«å¼•æ“èµ‹äºˆå†…éƒ¨æ–¹æ³•ï¼Œä¹Ÿä¼šèµ‹äºˆå†…éƒ¨æ§½ã€‚å†…éƒ¨æ§½ä¸æ˜¯å±æ€§ï¼Œç±»ä¼¼å±æ€§ï¼Œç”¨äºåœ¨å¯¹è±¡ä¸Šè®°å½•çŠ¶æ€æˆ–æ•°æ®ã€‚</p> <p>â€ƒâ€ƒä»¥<code>Map</code>ç±»å‹ä¸ºä¾‹ï¼Œå¼•æ“ä¼šèµ‹äºˆå®ä¾‹ <a href="https://262.ecma-international.org/13.0/#sec-properties-of-array-instances" target="_blank" rel="noopener noreferrer">[[MapData]]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å†…éƒ¨æ§½ï¼Œå°†å„æ•°æ®é¡¹å­˜å‚¨åœ¨<code>[[MapData]]</code>ä¸Šã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

map <span class="token comment">// Map(1) {1 =&gt; 2}</span>
</code></pre></div><p>â€ƒâ€ƒè¿è¡Œ<code>map.set(1, 2)</code>æ—¶ï¼Œç”±äºå®ä¾‹ä¸Šæ²¡æœ‰<code>set</code>æ–¹æ³•ï¼Œå°†æ²¿ç€åŸå‹é“¾å¯»æ‰¾åŸå‹æ–¹æ³•ï¼Œåˆ™ç›¸å½“äºè¿è¡Œ<code>Map.prototype.set.call(map, 1, 2)</code>ã€‚ç´§æ¥ç€<code>Map.prototype.set</code>æ–¹æ³•å†…éƒ¨å°†è®¿é—®<code>this</code>å®ä¾‹å¯¹è±¡çš„<code>[[MapData]]</code>å†…éƒ¨æ§½ï¼Œå³<code>this.[[MapData]]</code>ï¼Œä¹Ÿå°±æ˜¯<code>map.[[MapData]]</code>ï¼Œç„¶åæ·»åŠ æ•°æ®é¡¹ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: Method Map.prototype.set called on incompatible receiver #&lt;Map&gt;</span>
</code></pre></div><p>â€ƒâ€ƒè€Œè¿è¡Œ<code>proxy.set(1, 2)</code>æ—¶ï¼Œ<code>handler</code>ä¸ºç©º<code>proxy</code>æœªä»£ç†ä»»ä½•æ“ä½œï¼Œå°†è·å–<code>map.set</code>æ–¹æ³•ï¼Œåˆ™ç›¸å½“äº<code>Map.prototype.set.call(<strong>proxy</strong>, 1, 2)</code>ï¼Œ<code>Map.prototype.set</code>å³è®¿é—®å†…éƒ¨æ§½<code>proxy.[[MapData]]</code>ã€‚ç”±äº<code>proxy</code>å¯¹è±¡æ²¡æœ‰æ­¤å†…éƒ¨æ§½ï¼Œå°†æŠ›å‡ºé”™è¯¯ã€‚</p> <p>â€ƒâ€ƒé‚£å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒå¯å°†<code>set</code>æ–¹æ³•å†…éƒ¨<code>this</code>å›ºå®šä¸º<code>map</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token keyword">instanceof</span> <span class="token class-name">Map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> <span class="token function">value</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> value
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

map <span class="token comment">// Map(1) {1 =&gt; 2}</span>
</code></pre></div><h4 id="å†…ç½®å¯¹è±¡"><a href="#å†…ç½®å¯¹è±¡" class="header-anchor">#</a> å†…ç½®å¯¹è±¡</h4> <p>â€ƒâ€ƒä»¥ä¸Šå¯æ€»ç»“å‡ºï¼Œå³ä½¿<code>Proxy</code>æœªä»£ç†ä»»ä½•æ“ä½œï¼Œä¹Ÿä¼šå°†ç›®æ ‡å¯¹è±¡ä¸Šæ–¹æ³•æˆ–è®¿é—®å™¨å†…éƒ¨<code>this</code>çš„æŒ‡å‘ä¿®æ”¹ä¸ºä»£ç†å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>value <span class="token operator">===</span> proxy <span class="token comment">// true</span>
proxy<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> proxy <span class="token comment">// true</span>
</code></pre></div><p>â€ƒâ€ƒè¿›ä¸€æ­¥çš„ï¼Œåœ¨ç›®æ ‡å¯¹è±¡æ–¹æ³•æˆ–è®¿é—®å™¨å†…éƒ¨ï¼Œè‹¥ä¸¥æ ¼ä¾èµ–<code>this</code>å®ä¾‹å¯¹è±¡ä¸Šçš„å†…éƒ¨æ§½ï¼Œè€Œä»£ç†å¯¹è±¡æ²¡æœ‰ï¼Œè¿è¡Œå¯èƒ½ä¼šé€ æˆé”™è¯¯ã€‚</p> <p>â€ƒâ€ƒä¾‹å¦‚ä»£ç†<code>Set</code>å®ä¾‹ï¼Œ<code>proxy</code>ä¸Šæ²¡æœ‰ <a href="https://262.ecma-international.org/13.0/#sec-properties-of-set-instances" target="_blank" rel="noopener noreferrer">[[SetData]]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å†…éƒ¨æ§½ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>set<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: Method Set.prototype.add called on incompatible receiver #&lt;Set&gt;</span>
</code></pre></div><p>â€ƒâ€ƒä¼˜åŒ–ä¸ºã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>set<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token keyword">instanceof</span> <span class="token class-name">Set</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> <span class="token function">value</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> value
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">set</span> <span class="token comment">// Set(1) {1}</span>
</code></pre></div><p>â€ƒâ€ƒæˆ–è€…ä»£ç†<code>Promise</code>å®ä¾‹ï¼Œ<code>proxy</code>ä¸Šæ²¡æœ‰ <a href="https://262.ecma-international.org/13.0/#sec-properties-of-promise-instances" target="_blank" rel="noopener noreferrer">[[PromiseState]]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å†…éƒ¨æ§½ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught TypeError: Method Promise.prototype.then called on incompatible receiver #&lt;Promise&gt;</span>
</code></pre></div><p>â€ƒâ€ƒä¼˜åŒ–ä¸ºã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> <span class="token function">value</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> value
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><p>â€ƒâ€ƒåˆæˆ–è€…ä»£ç†<code>Date</code>ï¼Œ<code>proxy</code>ä¸Šæ²¡æœ‰ <a href="https://262.ecma-international.org/13.0/#sec-properties-of-date-instances" target="_blank" rel="noopener noreferrer">[[DateValue]]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å†…éƒ¨æ§½ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: this is not a Date object</span>
</code></pre></div><p>â€ƒâ€ƒä¼˜åŒ–ä¸ºã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> <span class="token function">value</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> value
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2022</span>
</code></pre></div><h4 id="ç§æœ‰å±æ€§"><a href="#ç§æœ‰å±æ€§" class="header-anchor">#</a> ç§æœ‰å±æ€§</h4> <p>â€ƒâ€ƒç±»çš„ç§æœ‰å±æ€§ä¸­ä¹Ÿå­˜åœ¨ç±»ä¼¼é—®é¢˜ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  #name <span class="token operator">=</span> <span class="token string">'xxx'</span>
  
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: Cannot read private member #name from an object whose class did not declare it</span>
</code></pre></div><p>â€ƒâ€ƒå…ˆæ¥çœ‹çœ‹<code>ECMA-262</code>è§„èŒƒä¸­ä¸ç§æœ‰å±æ€§æœ‰å…³çš„å†…éƒ¨æ§½ã€‚</p> <blockquote><p><code>6.1.7.2 Object Internal Methods and Internal Slots</code><br> <code>All objects have an internal slot named [[PrivateElements]], which is a List of PrivateElements. This List represents the values of the private fields, methods, and accessors for the object. Initially, it is an empty List.</code></p></blockquote> <p>â€ƒâ€ƒå¤§è‡´è¯­ä¹‰ä¸ºæ‰€æœ‰å¯¹è±¡éƒ½æœ‰<code>[[PrivateElements]]</code>å†…éƒ¨æ§½ï¼Œæ˜¯ä¸€ä¸ª<code>PrivateElements</code>åˆ—è¡¨ï¼Œè®°å½•å¯¹è±¡çš„ç§æœ‰å±æ€§ã€æ–¹æ³•å’Œè®¿é—®å™¨ã€‚</p> <p>â€ƒâ€ƒ;<code>PrivateElements</code>åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p> <blockquote><p><code>6.2.9 The PrivateElement Specification Type</code><br> <code>...</code><br> <code>Values of the PrivateElement type are Record values whose fields are defined by Table 9. Such values are referred to as <strong>PrivateElements</strong>.</code></p></blockquote> <p>â€ƒâ€ƒ;<code>PrivateElement</code>æ˜¯ä¸€ç§è§„èŒƒç±»å‹ï¼Œå­—æ®µåŒ…æ‹¬ã€‚</p> <ul><li><code>[[Key]]</code>ï¼šå±æ€§ã€æ–¹æ³•æˆ–è®¿é—®å™¨çš„åç§°</li> <li><code>[[Kind]]</code>ï¼šç§ç±»ï¼Œå±æ€§ã€æ–¹æ³•æˆ–è®¿é—®å™¨çš„ä¸€ç§</li> <li><code>[[Value]]</code>ï¼šå€¼</li> <li><code>[[Get]]</code>ï¼šè®¿é—®å™¨<code>getter</code></li> <li><code>[[Set]]</code>ï¼šè®¿é—®å™¨<code>setter</code></li></ul> <p>â€ƒâ€ƒ;<code>PrivateElement</code>å­—æ®µä¸å­—æ®µå€¼ä¸€èµ·ç§°ä¸º<code>PrivateElements</code>ã€‚</p> <p>â€ƒâ€ƒä»¥<code>user</code>å®ä¾‹ä¸ºä¾‹ï¼Œç§æœ‰å±æ€§<code>#name</code>å¯¹åº”çš„<code>PrivateElements</code>ä¸ºã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span>Key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> #name<span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span>Kind<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> field<span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span>Value<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒå†…éƒ¨æ§½ä¸ºã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span>PrivateElements<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token punctuation">[</span><span class="token punctuation">[</span>Key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> #name<span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token punctuation">[</span>Kind<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> field<span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token punctuation">[</span>Value<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒè€Œåœ¨<code>this.#name</code>è·å–ç§æœ‰å±æ€§æ—¶ï¼Œå°†æ‰§è¡Œ <a href="https://262.ecma-international.org/13.0/#sec-privateelementfind" target="_blank" rel="noopener noreferrer">PrivateElementFind<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æŠ½è±¡æ–¹æ³•ï¼Œè¿”å›<code>#name</code>å¯¹åº”çš„<code>PrivateElements</code>ã€‚ç„¶åæ‰§è¡Œ <a href="https://262.ecma-international.org/13.0/#sec-privateget" target="_blank" rel="noopener noreferrer">PrivateGet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æŠ½è±¡æ–¹æ³•ï¼Œè¿”å›<code>PrivateElements</code>ä¸Šçš„<code>[[Value]]</code>å­—æ®µå€¼ã€‚</p> <p>â€ƒâ€ƒä»£ç†<code>user</code>å¯¼è‡´<code>getName</code>æ–¹æ³•å†…éƒ¨<code>this</code>æŒ‡å‘<code>proxy</code>ï¼Œ<code>proxy</code>è™½ä¸ºå¯¹è±¡ä¸”æœ‰<code>[[PrivateElements]]</code>å†…éƒ¨æ§½ï¼Œä½†æ˜¯<code>[[PrivateElements]]</code>å€¼ä¸ºç©ºåˆ—è¡¨ï¼Œè·å–å±æ€§æ—¶æŠ½è±¡æ–¹æ³•<code>PrivateElementFind</code>ä¼šè¿”å›<code>empty</code>ç©ºå€¼ã€‚ç»§ç»­æ‰§è¡ŒæŠ½è±¡æ–¹æ³•<code>PrivateGet</code>ï¼Œç©ºå€¼å°†æŠ›å‡ºé”™è¯¯ã€‚</p> <p>â€ƒâ€ƒç±»ä¼¼çš„ä¼˜åŒ–ä¸ºã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  #name <span class="token operator">=</span> <span class="token string">'xxx'</span>

  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> <span class="token function">value</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> value
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// xxx</span>
</code></pre></div><h4 id="æ€§èƒ½å±€é™"><a href="#æ€§èƒ½å±€é™" class="header-anchor">#</a> æ€§èƒ½å±€é™</h4> <p>â€ƒâ€ƒ;<code>Proxy</code>ä¹Ÿå­˜åœ¨ä¸€äº›æ€§èƒ½é—®é¢˜ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">normal</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'normal'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    object<span class="token punctuation">.</span>value<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'normal'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">defaultTrap</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'defaultTrap'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proxy<span class="token punctuation">.</span>value<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'defaultTrap'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">expressionTrap</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> target<span class="token punctuation">[</span>property<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      target<span class="token punctuation">[</span>property<span class="token punctuation">]</span> <span class="token operator">=</span> value

      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'expressionTrap'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proxy<span class="token punctuation">.</span>value<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'expressionTrap'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">reflectTrap</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'reflectTrap'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proxy<span class="token punctuation">.</span>value<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'reflectTrap'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> object<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      object<span class="token punctuation">.</span>value <span class="token operator">=</span> val
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'defineProperty'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proxy<span class="token punctuation">.</span>value<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'defineProperty'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">1000000</span>

<span class="token function">normal</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
<span class="token function">defaultTrap</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
<span class="token function">expressionTrap</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
<span class="token function">reflectTrap</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
<span class="token function">defineProperty</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
</code></pre></div><p>â€ƒâ€ƒ;<code>node</code>ç‰ˆæœ¬<code>v16.14.0</code>æµ‹è¯•ç»“æœï¼Œå…¶ä¸­<code>reflectTrap</code>ç›¸è¾ƒäº<code>normal</code>æ€§èƒ½å·®äº†å¾ˆå¤šã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token literal-property property">normal</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">.</span>681ms
<span class="token literal-property property">defaultTrap</span><span class="token operator">:</span> <span class="token number">386</span><span class="token punctuation">.</span>346ms
<span class="token literal-property property">expressionTrap</span><span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">.</span>572ms
<span class="token literal-property property">reflectTrap</span><span class="token operator">:</span> <span class="token number">430</span><span class="token punctuation">.</span>464ms
<span class="token literal-property property">defineProperty</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">.</span>848ms
</code></pre></div><h3 id="polyfill-åŸç†æ˜¯ä»€ä¹ˆ"><a href="#polyfill-åŸç†æ˜¯ä»€ä¹ˆ" class="header-anchor">#</a> Polyfill åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3> <p>â€ƒâ€ƒ;<code>Proxy</code>çš„ <a href="https://caniuse.com/?search=proxy" target="_blank" rel="noopener noreferrer">å…¼å®¹æ€§<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç›¸å¯¹è¾ƒå¥½ï¼Œä½†<code>IE</code>æµè§ˆå™¨çš„ä»»ä½•ç‰ˆæœ¬éƒ½ä¸æ”¯æŒã€‚</p> <p>â€ƒâ€ƒç›¸å…³<code>polyfill</code>åº“å†…éƒ¨éƒ½æ˜¯ç”¨<code>Object.defineProperty</code>æ¨¡æ‹Ÿ<code>Proxy</code>è¯­æ³•ï¼Œ<code>es6-proxy-polyfill</code>ç›¸å¯¹è¾ƒæ–°ï¼Œé€»è¾‘æ›´åŠ æ¸…æ™°ï¼Œç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹ã€‚</p> <table><thead><tr><th style="text-align:center;"><code>polyfill</code></th> <th style="text-align:center;">å…¼å®¹</th> <th style="text-align:center;"><code>traps</code></th> <th style="text-align:center;">æ”¯æŒåº¦</th> <th style="text-align:center;">è¯´æ˜</th></tr></thead> <tbody><tr><td style="text-align:center;"><a href="https://github.com/GoogleChrome/proxy-polyfill" target="_blank" rel="noopener noreferrer">proxy-polyfill<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:center;"><code>IE9+</code></td> <td style="text-align:center;"><code>get</code>ã€<code>set</code>ã€<code>apply</code>å’Œ<code>construct</code></td> <td style="text-align:center;">å¯¹è±¡ã€å‡½æ•°</td> <td style="text-align:center;">å¯¹è±¡ä»…ä»£ç†å·²å­˜åœ¨å±æ€§ï¼Œæ— æ³•ä»£ç†æ–°å±æ€§</td></tr> <tr><td style="text-align:center;"><a href="https://github.com/ambit-tsai/es6-proxy-polyfill" target="_blank" rel="noopener noreferrer">es6-proxy-polyfill<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:center;"><code>IE6+</code></td> <td style="text-align:center;"><code>get</code>ã€<code>set</code>ã€<code>apply</code>å’Œ<code>construct</code></td> <td style="text-align:center;">å¯¹è±¡ã€å‡½æ•°å’Œæ•°ç»„</td> <td style="text-align:center;">éæ•°ç»„å¯¹è±¡ï¼Œä»…ä»£ç†å·²å­˜åœ¨å±æ€§ï¼Œæ— æ³•ä»£ç†æ–°å±æ€§ã€‚<code>IE8</code>åŠä»¥ä¸‹ä¾èµ–<code>object-defineproperty-ie</code>åº“æ”¯æŒ</td></tr></tbody></table> <p>â€ƒâ€ƒä»¥ä¸‹å°†åˆ†æ<code>es6-proxy-polyfill/src/index.js</code>æ ¸å¿ƒéƒ¨åˆ†ã€‚</p> <h4 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="header-anchor">#</a> å†…éƒ¨ç±»</h4> <p>â€ƒâ€ƒæ„é€ å‡½æ•°<code>Internal</code>åˆ›å»ºå†…éƒ¨å®ä¾‹ï¼Œä¿å­˜ç›®æ ‡å¯¹è±¡<code>target</code>å’Œé…ç½®å¯¹è±¡<code>handler</code>ã€‚å¤–éƒ¨ç»Ÿä¸€è°ƒç”¨å®ä¾‹æ–¹æ³•æ¥ä¿®æ”¹<code>target</code>ï¼ŒåŒ…æ‹¬<code>GET</code>ã€<code>SET</code>ã€<code>CALL</code>å’Œ<code>CONSTRUCT</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">PROXY_TARGET</span> <span class="token operator">=</span> <span class="token string">'[[ProxyTarget]]'</span>
<span class="token keyword">var</span> <span class="token constant">PROXY_HANDLER</span> <span class="token operator">=</span> <span class="token string">'[[ProxyHandler]]'</span>
<span class="token keyword">var</span> <span class="token constant">GET</span> <span class="token operator">=</span> <span class="token string">'[[Get]]'</span>
<span class="token keyword">var</span> <span class="token constant">SET</span> <span class="token operator">=</span> <span class="token string">'[[Set]]'</span>
<span class="token keyword">var</span> <span class="token constant">CALL</span> <span class="token operator">=</span> <span class="token string">'[[Call]]'</span>
<span class="token keyword">var</span> <span class="token constant">CONSTRUCT</span> <span class="token operator">=</span> <span class="token string">'[[Construct]]'</span>

<span class="token keyword">function</span> <span class="token function">Internal</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span> <span class="token operator">=</span> target
  <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_HANDLER</span><span class="token punctuation">]</span> <span class="token operator">=</span> handler
<span class="token punctuation">}</span>

<span class="token class-name">Internal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token constant">GET</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Internal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token constant">SET</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Internal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token constant">CALL</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Internal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token constant">CONSTRUCT</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒä»¥<code>SET</code>ä¿®æ”¹å±æ€§å€¼ä¸ºä¾‹ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Internal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token constant">SET</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span><span class="token punctuation">,</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_HANDLER</span><span class="token punctuation">]</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>handler<span class="token punctuation">.</span>set <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">[</span>property<span class="token punctuation">]</span> <span class="token operator">=</span> value
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> handler<span class="token punctuation">.</span>set <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> handler<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒç¬¬ä¸€ç§æƒ…å†µåœ¨æœªæŒ‡å®š<code>handler.set</code>æ—¶ï¼Œé»˜è®¤ä¿®æ”¹ç›®æ ‡å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
internal<span class="token punctuation">[</span><span class="token constant">SET</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

object <span class="token comment">// {x: 2}</span>
</code></pre></div><p>â€ƒâ€ƒç¬¬äºŒç§æƒ…å†µè‹¥æŒ‡å®šäº†<code>handler.set</code>ï¼Œåˆ™æ­£ç¡®ä¼ é€’å‚æ•°ç”±<code>handler.set</code>æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
internal<span class="token punctuation">[</span><span class="token constant">SET</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

object <span class="token comment">// {x: 6}</span>
</code></pre></div><h4 id="è§‚å¯Ÿå‡½æ•°"><a href="#è§‚å¯Ÿå‡½æ•°" class="header-anchor">#</a> è§‚å¯Ÿå‡½æ•°</h4> <p>â€ƒâ€ƒ;<code>observeProperty</code>è§‚å¯Ÿå¯¹è±¡å·²å­˜åœ¨å±æ€§çš„è¯»å†™æ“ä½œï¼Œè¿”å›å±æ€§æè¿°ç¬¦ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">observeProperty</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> desc <span class="token operator">=</span> <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> desc<span class="token punctuation">.</span>enumerable<span class="token punctuation">,</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> desc<span class="token punctuation">.</span>configurable<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒå…ˆä¸è€ƒè™‘<code>get</code>å’Œ<code>set</code>å†…é€»è¾‘ï¼Œä¿®æ”¹ä¸º<code>log</code>å‡½æ•°ã€‚</p> <p>â€ƒâ€ƒ;<code>observeProperties</code>è§‚å¯Ÿå¯¹è±¡è‡ªèº«æ‰€æœ‰å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">observeProperties</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> names <span class="token operator">=</span> <span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">,</span> descMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> names<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    descMap<span class="token punctuation">[</span>names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">observeProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> internal<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> descMap
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒé…åˆ<code>Object.defineProperties</code>ï¼Œå¯æ‹¦æˆªå¯¹è±¡å±æ€§çš„è¯»å†™æ“ä½œã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> descMap <span class="token operator">=</span> <span class="token function">observeProperties</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> descMap<span class="token punctuation">)</span>

object<span class="token punctuation">.</span>x <span class="token comment">// get</span>
object<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">// set</span>
</code></pre></div><p>â€ƒâ€ƒ;<code>observeProto</code>è§‚å¯Ÿå¯¹è±¡åŸå‹é“¾ä¸Šæ‰€æœ‰å±æ€§ï¼Œè¿”å›å±æ€§æè¿°ç¬¦ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">observeProto</span><span class="token punctuation">(</span><span class="token parameter">internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> descMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> proto <span class="token operator">=</span> internal<span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>proto <span class="token operator">=</span> <span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> props <span class="token operator">=</span> <span class="token function">observeProperties</span><span class="token punctuation">(</span>proto<span class="token punctuation">,</span> internal<span class="token punctuation">)</span>
    <span class="token function">objectAssign</span><span class="token punctuation">(</span>descMap<span class="token punctuation">,</span> props<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> descMap
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒä¾‹å¦‚è§‚å¯Ÿæ•°ç»„åŸå‹ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token function">observeProto</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>
</code></pre></div><p>â€ƒâ€ƒè¿”å›å±æ€§æè¿°ç¬¦ï¼Œç”±æ•°ç»„æ¯ä¸€çº§çš„åŸå‹å¯¹è±¡çš„å±æ€§æ„æˆã€‚</p> <p><img src="/js/proxy/proto.png" alt=""></p> <p>â€ƒâ€ƒæš‚æ—¶ä¸å…³æ³¨<code>observeProto</code>ä½œç”¨ï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚</p> <h4 id="ä¸»å‡½æ•°"><a href="#ä¸»å‡½æ•°" class="header-anchor">#</a> ä¸»å‡½æ•°</h4> <p>â€ƒâ€ƒä»£ç†ç±»å‹åŒ…æ‹¬æ•°ç»„ã€å¯¹è±¡å’Œå‡½æ•°ä¸‰ç§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">ProxyPolyfill</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token keyword">return</span> <span class="token function">createProxy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">createProxy</span><span class="token punctuation">(</span><span class="token parameter">internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> proxy<span class="token punctuation">,</span> target <span class="token operator">=</span> internal<span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proxy <span class="token operator">=</span> <span class="token function">proxyFunction</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proxy <span class="token operator">=</span> <span class="token function">proxyArray</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    proxy <span class="token operator">=</span> <span class="token function">proxyObject</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> proxy
<span class="token punctuation">}</span>

window<span class="token punctuation">.</span>Proxy <span class="token operator">=</span> ProxyPolyfill
</code></pre></div><p>â€ƒâ€ƒåˆ†ç±»å‹çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒè¿”å›å€¼<code>proxy</code>ç±»å‹ä¸ç›®æ ‡å¯¹è±¡<code>target</code>ç±»å‹å­˜åœ¨ä¸€äº›å…³è”ã€‚</p> <p>â€ƒâ€ƒä¾‹å¦‚ä»£ç†å‡½æ•°ï¼Œè‹¥æ”¯æŒ<code>proxy()</code>å‡½æ•°å¼è°ƒç”¨ï¼Œ<code>proxy</code>ç±»å‹ä¸€å®šä¸ºå‡½æ•°ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">proxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="ä»£ç†å¯¹è±¡"><a href="#ä»£ç†å¯¹è±¡" class="header-anchor">#</a> ä»£ç†å¯¹è±¡</h4> <p>â€ƒâ€ƒæˆ‘ä»¬æ¥æ‰‹åŠ¨ç¼–å†™ä¸€ä¸ªä»£ç†å¯¹è±¡å‡½æ•°<code>proxyObject</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">proxyObject</span><span class="token punctuation">(</span><span class="token parameter">internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> descMap<span class="token punctuation">,</span> proxy <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> target <span class="token operator">=</span> internal<span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span>

  descMap <span class="token operator">=</span> <span class="token function">observeProperties</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> internal<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> descMap<span class="token punctuation">)</span>

  <span class="token keyword">return</span> proxy
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒè§‚å¯Ÿå¹¶æ‹¦æˆªäº†å¯¹è±¡è‡ªèº«æ‰€æœ‰å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">proxyObject</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>x <span class="token comment">// get</span>
proxy<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">// set</span>
</code></pre></div><p>â€ƒâ€ƒç„¶åè€ƒè™‘è¡¥å…¨<code>observeProperty</code>å‡½æ•°å†…<code>set</code>å’Œ<code>get</code>ã€‚</p> <p>â€ƒâ€ƒå³ä¿®æ”¹å’Œè¯»å–ç›®æ ‡å¯¹è±¡çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©å†…éƒ¨å®ä¾‹çš„<code>SET</code>å’Œ<code>GET</code>æ–¹æ³•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">observeProperty</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> desc <span class="token operator">=</span> <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> internal<span class="token punctuation">[</span><span class="token constant">GET</span><span class="token punctuation">]</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      internal<span class="token punctuation">[</span><span class="token constant">SET</span><span class="token punctuation">]</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒç‰¹åˆ«æ³¨æ„<code>set</code>å’Œ<code>get</code>å†…<code>this</code>å®ä¾‹é»˜è®¤æŒ‡å‘è°ƒç”¨è€…ï¼Œæ°å¥½ä¼ è‡³å†…éƒ¨å®ä¾‹<code>receiver</code>å‚æ•°ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>proxy<span class="token punctuation">.</span>x <span class="token comment">// 1</span>
proxy<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">3</span>
object <span class="token comment">// {x: 1, y: 3}</span>
</code></pre></div><h4 id="ä»£ç†æ•°ç»„"><a href="#ä»£ç†æ•°ç»„" class="header-anchor">#</a> ä»£ç†æ•°ç»„</h4> <p>â€ƒâ€ƒ;<code>proxyObject</code>ä¹Ÿé€‚ç”¨äºæ•°ç»„ç±»å‹ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">proxyObject</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>

proxy<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">// 3</span>
</code></pre></div><p>â€ƒâ€ƒå”¯ä¸€å·®å¼‚åœ¨äºæ— æ³•ä»£ç†æ•°ç»„çš„åŸå‹æ–¹æ³•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>proxy<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: proxy.join is not a function</span>
</code></pre></div><p>â€ƒâ€ƒå› ä¸º<code>proxy</code>å¹¶æ²¡æœ‰<code>join</code>å±æ€§ï¼Œè¿è¡Œè‚¯å®šæŠ¥é”™ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒé‚£å°±å¾ˆç®€å•äº†ï¼Œ<code>proxy</code>æ·»åŠ <code>join</code>å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">proxyArray</span><span class="token punctuation">(</span><span class="token parameter">internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> descMap<span class="token punctuation">,</span> target <span class="token operator">=</span> internal<span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>

  descMap <span class="token operator">=</span> <span class="token function">observeProperties</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> internal<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> descMap<span class="token punctuation">)</span>

  <span class="token keyword">return</span> proxy
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒæ‹¦æˆªäº†<code>join</code>å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">proxyArray</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span>join <span class="token comment">// get</span>
</code></pre></div><p>â€ƒâ€ƒä»ç„¶å€ŸåŠ©å†…éƒ¨å®ä¾‹æ–¹æ³•ï¼Œè¡¥å…¨<code>get</code>å’Œ<code>set</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> internal<span class="token punctuation">[</span><span class="token constant">GET</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'join'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">set</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    internal<span class="token punctuation">[</span><span class="token constant">GET</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'join'</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³æ— æ³•æ”¯æŒåˆ«çš„æ•°ç»„æ–¹æ³•ï¼Œä¾‹å¦‚<code>pop</code>ã€<code>reverse</code>ç­‰ã€‚</p> <p>â€ƒâ€ƒåˆšæ‰çš„<code>observeProto</code>å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œä¿®æ”¹ä¸‹<code>proxyArray</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">proxyArray</span><span class="token punctuation">(</span><span class="token parameter">internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> descMap<span class="token punctuation">,</span> proxy <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> target <span class="token operator">=</span> internal<span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span>

  descMap <span class="token operator">=</span> <span class="token function">observeProto</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>
  <span class="token keyword">delete</span> descMap<span class="token punctuation">.</span>length
  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> descMap<span class="token punctuation">)</span>

  descMap <span class="token operator">=</span> <span class="token function">observeProperties</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> internal<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> descMap<span class="token punctuation">)</span>

  <span class="token keyword">return</span> proxy
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒå·²ç»æ”¯æŒæ•°ç»„åŸå‹ä¸Šçš„æ‰€æœ‰æ–¹æ³•äº†ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">proxyArray</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>

proxy<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
proxy
<span class="token comment">// {</span>
<span class="token comment">//   0: 1,</span>
<span class="token comment">//   1: 2,</span>
<span class="token comment">//   at: Æ’ at(),</span>
<span class="token comment">//   concat: Æ’ concat(),</span>
<span class="token comment">//   ...</span>
<span class="token comment">//   hasOwnProperty: Æ’ hasOwnProperty(),</span>
<span class="token comment">//   ...</span>
<span class="token comment">//   isPrototypeOf: Æ’ isPrototypeOf(),</span>
<span class="token comment">//   ...</span>
<span class="token comment">//   valueOf: Æ’ valueOf(),</span>
<span class="token comment">//   values: Æ’ values(),</span>
<span class="token comment">// }</span>
</code></pre></div><p>â€ƒâ€ƒç°åœ¨æ¥çœ‹çœ‹<code>es6-proxy-polyfill</code>å†…éƒ¨<code>proxyArray</code>ï¼Œä¸æˆ‘ä»¬ç¼–å†™çš„ç‰ˆæœ¬å¤§åŒå°å¼‚ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">proxyArray</span><span class="token punctuation">(</span><span class="token parameter">internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> descMap<span class="token punctuation">,</span> newProto<span class="token punctuation">,</span> target <span class="token operator">=</span> internal<span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span>

  descMap <span class="token operator">=</span> <span class="token function">observeProto</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>
  newProto <span class="token operator">=</span> <span class="token function">objectCreate</span><span class="token punctuation">(</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">,</span> descMap<span class="token punctuation">)</span>

  descMap <span class="token operator">=</span> <span class="token function">observeProperties</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> internal<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token function">objectCreate</span><span class="token punctuation">(</span>newProto<span class="token punctuation">,</span> descMap<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒå·®å¼‚ä»…åœ¨<code>es6-proxy-polyfill</code>æœªå°†åŸå‹æ–¹æ³•ä½œä¸º<code>proxy</code>çš„å±æ€§ï¼Œä¸ªäººçŒœæµ‹æ˜¯ä¸ºäº†ä¸ç ´å<code>proxy</code>è‡ªèº«å±æ€§ï¼Œå°†åŸå‹æ–¹æ³•åˆå¹¶ä¸ºå¯¹è±¡æ”¾åœ¨<code>proxy</code>çš„åŸå‹é“¾å¤´éƒ¨ï¼Œå¹¶å°†å…¶æŒ‡å‘äº†ç›®æ ‡å¯¹è±¡çš„åŸå‹é“¾ï¼Œå½¢æˆä¸€æ¡æ–°åŸå‹é“¾<code>newProto</code>ï¼Œå¦‚æ©™è‰²ç®­å¤´æŒ‡å‘ã€‚</p> <p><img src="/js/proxy/newProto.png" alt=""></p> <h4 id="ä»£ç†å‡½æ•°"><a href="#ä»£ç†å‡½æ•°" class="header-anchor">#</a> ä»£ç†å‡½æ•°</h4> <h5 id="call-construct"><a href="#call-construct" class="header-anchor">#</a> CALL / CONSTRUCT</h5> <p>â€ƒâ€ƒä»¥ä¸‹ä¸ºå†…éƒ¨å®ä¾‹ä¸Š<code>CALL</code>æ–¹æ³•ï¼Œå…¶ä¸­<code>target.apply(thisArg, argList)</code>ç”¨äºå°†æ•°ç»„<code>argList</code>è½¬æ¢ä¸ºå‚æ•°æ•°åˆ—ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Internal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token constant">CALL</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">thisArg<span class="token punctuation">,</span> argList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span><span class="token punctuation">,</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_HANDLER</span><span class="token punctuation">]</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>handler<span class="token punctuation">.</span>apply <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">target</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">,</span> argList<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> handler<span class="token punctuation">.</span>apply <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> thisArg<span class="token punctuation">,</span> argList<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒç±»ä¼¼çš„åœ¨æœªæŒ‡å®š<code>handler.apply</code>æ—¶ï¼Œé»˜è®¤è°ƒç”¨ç›®æ ‡å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">object</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
internal<span class="token punctuation">[</span><span class="token constant">CALL</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥æŒ‡å®šäº†<code>handler.apply</code>ï¼Œåˆ™æ­£ç¡®ä¼ é€’å‚æ•°ç”±<code>handler.apply</code>æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">object</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> thisArg<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Reflect</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> thisArg<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
internal<span class="token punctuation">[</span><span class="token constant">CALL</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 9</span>
</code></pre></div><p>â€ƒâ€ƒæ¥ç€æ¥çœ‹ä¸‹<code>CONSTRUCT</code>æ–¹æ³•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Internal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span><span class="token constant">CONSTRUCT</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">argList<span class="token punctuation">,</span> newTarget</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> newObj<span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_TARGET</span><span class="token punctuation">]</span><span class="token punctuation">,</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PROXY_HANDLER</span><span class="token punctuation">]</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>handler<span class="token punctuation">.</span>construct <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    newObj <span class="token operator">=</span> <span class="token function">evaluateNew</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> argList<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> handler<span class="token punctuation">.</span>construct <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    newObj <span class="token operator">=</span> handler<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> argList<span class="token punctuation">,</span> newTarget<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> newObj
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œåœ¨æœªæŒ‡å®š<code>handler.construct</code>æ—¶ï¼Œåˆ™é»˜è®¤<code>new</code>ç›®æ ‡å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">object</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
<span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
internal<span class="token punctuation">[</span><span class="token constant">CONSTRUCT</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// object {x: 1, y: 2}</span>
</code></pre></div><p>â€ƒâ€ƒæ³¨æ„<code>ES6</code>æ„é€ å‡½æ•°ä¸­æ•°ç»„è½¬å‚æ•°æ•°åˆ—å¾ˆå®¹æ˜“ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">target</span><span class="token punctuation">(</span><span class="token operator">...</span>argList<span class="token punctuation">)</span>
</code></pre></div><p>â€ƒâ€ƒä½†åœ¨<code>ES5</code>ä¸­è¾ƒå›°éš¾ï¼Œå€ŸåŠ©<code>eval</code>æˆ–è€…<code>new Function</code>æ‹¼æ¥å‚æ•°æ‰å¯å®ç°ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">evaluateNew</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">F</span><span class="token punctuation">,</span> argList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  argList <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>argList<span class="token punctuation">)</span>

  <span class="token keyword">var</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'Ctor'</span><span class="token punctuation">,</span> <span class="token string">'return new Ctor('</span> <span class="token operator">+</span> argList <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token function">executor</span><span class="token punctuation">(</span><span class="token constant">F</span><span class="token punctuation">,</span> argList<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒè‹¥æŒ‡å®šäº†<code>handler.construct</code>ï¼Œåˆ™æ­£ç¡®ä¼ é€’å‚æ•°ç”±<code>handler.construct</code>æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">object</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
<span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">construct</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> args<span class="token punctuation">,</span> newTarget</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">,</span> newTarget<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
internal<span class="token punctuation">[</span><span class="token constant">CONSTRUCT</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// F {x: 1, y: 2}</span>
</code></pre></div><h5 id="proxyfunction"><a href="#proxyfunction" class="header-anchor">#</a> proxyFunction</h5> <p>â€ƒâ€ƒä¸»å‡½æ•°éƒ¨åˆ†æåŠåˆ°ï¼Œ<code>proxy()</code>æ”¯æŒå‡½æ•°å¼è°ƒç”¨ï¼Œåˆ™è¿”å›å€¼ä¸€å®šä¸ºå‡½æ•°ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">proxyFunction</span><span class="token punctuation">(</span><span class="token parameter">internal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">P</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'function'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token constant">P</span>
<span class="token punctuation">}</span>
</code></pre></div><p>â€ƒâ€ƒæ‹¦æˆªäº†å‡½æ•°å¼è°ƒç”¨ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">object</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> internal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Internal</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">proxyFunction</span><span class="token punctuation">(</span>internal<span class="token punctuation">)</span>

<span class="token function">proxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// function</span>
</code></pre></div><p>â€ƒâ€ƒå€ŸåŠ©å†…éƒ¨å®ä¾‹ï¼Œä¿®æ”¹<code>P</code>å‡½æ•°ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token constant">P</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> internal<span class="token punctuation">[</span><span class="token constant">CALL</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">proxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
</code></pre></div><p>â€ƒâ€ƒå¦‚ä½•çŸ¥æ™“å¤–éƒ¨æ˜¯å¦<code>new</code>è°ƒç”¨å‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒåˆ¤æ–­å‡½æ•°<code>P</code>å†…<code>this</code>æ˜¯å¦ä¸º<code>P</code>å‡½æ•°å®ä¾‹å³å¯ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token constant">P</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">P</span>
    <span class="token operator">?</span> internal<span class="token punctuation">[</span><span class="token constant">CONSTRUCT</span><span class="token punctuation">]</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token constant">P</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> internal<span class="token punctuation">[</span><span class="token constant">CALL</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å°ç»“-3"><a href="#å°ç»“-3" class="header-anchor">#</a> å°ç»“</h4> <p>â€ƒâ€ƒä»¥ä¸Šåˆ†æäº†<code>es6-proxy-polyfill</code>æ ¸å¿ƒéƒ¨åˆ†ï¼ŒåŒ…æ‹¬ä»£ç†å¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ä¸‰ç§ç±»å‹ï¼Œå¤„ç†æ–¹å¼å‡å¤§åŒå°å¼‚ï¼Œéƒ½æ˜¯ä¾èµ–<code>Object.defineProperty</code>æˆ–è€…<code>Object.create</code>æ‹¦æˆªå±æ€§çš„ä¿®æ”¹å’Œè¯»å–ï¼Œæ³¨æ„<code>Object.create</code>ç¬¬äºŒä¸ªå‚æ•°ä¸<code>Object.defineProperty</code>ä½œç”¨ç±»ä¼¼ï¼Œå…³äº<code>Object.create</code>æ›´å¤šç»†èŠ‚å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/create" target="_blank" rel="noopener noreferrer">MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p>â€ƒâ€ƒå¤–éƒ¨è¯»å–å±æ€§ã€ä¿®æ”¹å±æ€§æˆ–è€…æ‰§è¡Œæ–¹æ³•ï¼Œéƒ½æ˜¯å€ŸåŠ©å†…éƒ¨å®ä¾‹åŸå‹ä¸Šçš„æ–¹æ³•ã€‚é…ç½®å¯¹è±¡åœ¨æœªæŒ‡å®šå¯¹åº”<code>trap</code>æ—¶ï¼Œé»˜è®¤æ“ä½œç›®æ ‡å¯¹è±¡ã€‚è‹¥æŒ‡å®šäº†å¯¹åº”<code>trap</code>ï¼Œåˆ™æ­£ç¡®ä¼ é€’å‚æ•°ç”±<code>trap</code>å¤„ç†ç›®æ ‡å¯¹è±¡ã€‚</p> <p>â€ƒâ€ƒåœ¨ä»£ç†æ•°ç»„æ—¶ä¹‹æ‰€ä»¥æ”¯æŒæ•°ç»„æ–¹æ³•ï¼Œä¾‹å¦‚<code>proxy.join(',')</code>ã€‚åŸç†æ˜¯å°†æ•°ç»„æ¯ä¸€çº§åŸå‹çš„å±æ€§å–å‡ºå¹¶åˆå¹¶æˆä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸º<code>proxy</code>åŸå‹é“¾çš„å¤´éƒ¨ï¼Œä¸”å°†å¤´éƒ¨æŒ‡å‘äº†ç›®æ ‡å¯¹è±¡ã€‚</p> <h3 id="proxy-ä¸ç±»å‹è½¬æ¢"><a href="#proxy-ä¸ç±»å‹è½¬æ¢" class="header-anchor">#</a> Proxy ä¸ç±»å‹è½¬æ¢</h3> <p>â€ƒâ€ƒç®€å•ä»£ç†å±æ€§çš„è¯»å–æ“ä½œã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>property<span class="token punctuation">,</span> result<span class="token punctuation">)</span>

    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre></div><p>â€ƒâ€ƒæ˜¾å¼åœ°å°†<code>proxy</code>è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>proxy<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// toString Æ’ toString()</span>
<span class="token comment">// Symbol(Symbol.toStringTag) undefined</span>
</code></pre></div><p>â€ƒâ€ƒå‘ç°<code>handler.get</code>è§¦å‘äº†ä¸¤æ¬¡ï¼Œå…¶ä¸­ç¬¬ä¸€æ¬¡æ˜¯è¯»å–<code>proxy.toString</code>å±æ€§ï¼Œå³<code>object.toString</code>å±æ€§ï¼Œæ²¿ç€åŸå‹é“¾æŸ¥æ‰¾å°±æ˜¯<code>Object.prototype.toString</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>proxy<span class="token punctuation">.</span>toString <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString
</code></pre></div><blockquote><p><code>proxy.toString()</code>ç­‰ä»·äº<code>Object.prototype.toString.call(proxy)</code></p></blockquote> <p>â€ƒâ€ƒç¬¬äºŒæ¬¡æ˜¯å¦‚ä½•å‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒæˆ‘ä»¬å¯ä»¥åœ¨<code>ECMA-262</code>è§„èŒƒä¸­ç¬¬ <a href="https://262.ecma-international.org/13.0/#sec-object.prototype.tostring" target="_blank" rel="noopener noreferrer">20.1.3.6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å°èŠ‚å¯»æ‰¾ç­”æ¡ˆã€‚</p> <blockquote><p><code>20.1.3.6 Object.prototype.toString ( )</code><br> <code>...</code><br> <code>3.Let O be ! ToObject(this value).</code><br> <code>...</code><br> <code>13.Else if O has a [[RegExpMatcher]] internal slot, let builtinTag be &quot;RegExp&quot;.</code><br> <code>14.Else, let builtinTag be &quot;Object&quot;.</code><br> <code><strong>15.Let tag be ? Get(O, @@toStringTag).</strong></code><br> <code>16.If Type(tag) is not String, set tag to builtinTag.</code><br> <code>17.Return the string-concatenation of &quot;[object &quot;, tag, and &quot;]&quot;.</code></p></blockquote> <p>â€ƒâ€ƒ;<code>toString</code>æ­¥éª¤å¤§è‡´ä¸ºã€‚</p> <ul><li>æŠŠ<code>this</code>è½¬æ¢ä¸ºå¯¹è±¡<code>O</code>ï¼Œå¹¶åˆ¤æ–­<code>O</code>æ˜¯å¦æœ‰ç‰¹æ®Šçš„å†…éƒ¨æ§½ï¼Œè‹¥æ²¡æœ‰<code>builtinTag</code>é»˜è®¤ä¸º<code>Object</code></li> <li>è¯»å–å¯¹è±¡<code>O[Symbol.toStringTag]</code>å±æ€§å€¼ä¸º<code>tag</code>ï¼Œè‹¥<code>tag</code>ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™<code>tag</code>èµ‹ä¸º<code>builtinTag</code></li> <li>è¿”å›ç”±<code>&quot;[object &quot;</code>ã€<code>tag</code>å’Œ<code>&quot;]&quot;</code>æ‹¼æ¥è€Œæˆçš„å­—ç¬¦ä¸²</li></ul> <p>â€ƒâ€ƒå¿½ç•¥å†…éƒ¨æ§½åˆ¤æ–­ï¼Œæ‰‹åŠ¨ç¼–å†™<code>toString</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token constant">O</span> <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> builtinTag <span class="token operator">=</span> <span class="token string">'Object'</span>
  <span class="token keyword">var</span> tag <span class="token operator">=</span> <span class="token constant">O</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> tag <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tag <span class="token operator">=</span> builtinTag
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[object </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å†…éƒ¨æ§½æ˜¯å¼•æ“å±‚é¢çš„ä¸œè¥¿ï¼Œ<code>JavaScript</code>ä»£ç æ— æ³•å®ç°</p></blockquote> <p>â€ƒâ€ƒæ•…åœ¨<code>proxy.toString()</code>è¿è¡Œæ—¶ï¼Œ<code>toString</code>å†…éƒ¨è¯»å–äº†<code>proxy[Symbol.toStringTag]</code>å±æ€§ï¼Œä»£ç†å¯¼è‡´ç¬¬äºŒæ¬¡è§¦å‘<code>handler.get</code>æ–¹æ³•ã€‚</p> <p>â€ƒâ€ƒå†æ¥çœ‹çœ‹<code>proxy</code>éšå¼è½¬æ¢ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>proxy <span class="token operator">+</span> <span class="token number">1</span>
<span class="token comment">// Symbol(Symbol.toPrimitive) undefined</span>
<span class="token comment">// valueOf Æ’ valueOf()</span>
<span class="token comment">// toString Æ’ toString()</span>
<span class="token comment">// Symbol(Symbol.toStringTag) undefined</span>
</code></pre></div><p>â€ƒâ€ƒä¸ºä»€ä¹ˆè§¦å‘äº†å››æ¬¡<code>handler.get</code>å‘¢ï¼Ÿ</p> <p>â€ƒâ€ƒå‚è€ƒ <a href="/pages/js/symbol.html#symbol-toprimitive">Symbol.toPrimitive</a> æˆ‘ä»¬çŸ¥é“ï¼Œå½¢å¦‚<code>x + y</code>çš„è¡¨è¾¾å¼ï¼Œå°†åˆ†åˆ«å¯¹<code>x</code>å’Œ<code>y</code>æ‰§è¡Œ<code>ToPrimitive(input, preferredType)</code>æŠ½è±¡è¿ç®—ï¼Œè½¬åŒ–ä¸ºåŸå§‹å€¼ã€‚</p> <p>â€ƒâ€ƒ;<code>ToPrimitive(proxy, default)</code>ç®€ç•¥è¿‡ç¨‹ä¸ºã€‚</p> <ul><li>åˆ¤æ–­æ˜¯å¦æœ‰<code>proxy[Symbol.toPrimitive]</code>æ–¹æ³•ï¼Œè¿”å›<code>undefined</code>è¡¨ç¤ºæ²¡æœ‰</li> <li>æ‰§è¡Œ<code>proxy.valueOf()</code>æ–¹æ³•ï¼Œè¿”å›<code>proxy</code>å¯¹è±¡</li> <li>æ‰§è¡Œ<code>proxy.toString()</code>æ–¹æ³•ï¼Œè¿”å›<code>[object Object]</code>ï¼ˆåŸå§‹å€¼ï¼‰</li> <li>æ‹¼æ¥ä¸¤åŸå§‹å€¼è¿”å›<code>[object Object]1</code></li></ul> <h2 id="å°ç»“-4"><a href="#å°ç»“-4" class="header-anchor">#</a> å°ç»“</h2> <ul><li>æ„é€ å‡½æ•°<code>Proxy</code>æ²¡æœ‰<code>prototype</code>åŸå‹å±æ€§ï¼Œæ— æ³•ç»§æ‰¿</li> <li>ä¸ºäº†å†…éƒ¨æ–¹æ³•çš„ç»Ÿä¸€æ€§ï¼Œä¸å˜é‡ä¹Ÿä¼šé™åˆ¶<code>trap</code>çš„è¿”å›ç»“æœ</li> <li>å†…ç½®å¯¹è±¡æˆ–è€…ç§æœ‰å±æ€§ä¸¥æ ¼ä¾èµ–<code>this</code>å®ä¾‹çš„å†…éƒ¨æ§½ï¼Œä»£ç†å¯èƒ½å‡ºé”™</li> <li><code>Proxy</code>ä¹Ÿæœ‰å±€é™æ€§ï¼Œä¾‹å¦‚æ— æ³•ä»£ç†<code>==</code>æˆ–<code>===</code>ç­‰æ“ä½œ</li> <li><code>Proxy</code>å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œå³ä½¿æ²¡æœ‰ä»»ä½•<code>trap</code></li></ul> <h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="header-anchor">#</a> å‚è€ƒ</h2> <ul><li><a href="https://www.zhihu.com/question/330408977/answer/811228034" target="_blank" rel="noopener noreferrer">Trap ç»“æœæ£€æµ‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/460133198" target="_blank" rel="noopener noreferrer">Proxy é‡Œé¢ä¸ºä»€ä¹ˆè¦ç”¨ Reflectï¼Ÿ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/426875859" target="_blank" rel="noopener noreferrer">Proxy æ€æ ·ä»£ç† Mapï¼Ÿ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/460330154" target="_blank" rel="noopener noreferrer">å…³äº Proxy ä»£ç†çš„æ€§èƒ½é—®é¢˜ï¼Ÿ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="ğŸ‰-å†™åœ¨æœ€å"><a href="#ğŸ‰-å†™åœ¨æœ€å" class="header-anchor">#</a> ğŸ‰ å†™åœ¨æœ€å</h2> <p>ğŸ»ä¼™ä¼´ä»¬ï¼Œå¦‚æœä½ å·²ç»çœ‹åˆ°äº†è¿™é‡Œï¼Œè§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©åˆ°ä½ çš„è¯ä¸å¦¨ç‚¹èµğŸ‘æˆ– <a href="https://github.com/dongwei1125/blog" target="_blank" rel="noopener noreferrer">Star<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> âœ¨æ”¯æŒä¸€ä¸‹å“¦ï¼</p> <p>æ‰‹åŠ¨ç å­—ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡æ­£ğŸ’¬~</p> <p>ä½ çš„æ”¯æŒå°±æ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ğŸ’ª~</p> <p><a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> / <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer">Gitee<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€<a href="https://dongwei1125.github.io/" target="_blank" rel="noopener noreferrer">GitHub Pages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€<a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer">æ˜é‡‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€<a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer">CSDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ˜‰~</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">11/27/2022, 9:20:44 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0aa97f73.js" defer></script><script src="/assets/js/2.f850a8ef.js" defer></script><script src="/assets/js/47.a89cf7d2.js" defer></script>
  </body>
</html>
