<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vscode 插件与 npm 包，保存时自动修复代码格式错误 | DonV</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/header.jpg">
    <meta name="description" content="A paper about JavaScript, HTML and CSS.">
    
    <link rel="preload" href="/assets/css/0.styles.87611319.css" as="style"><link rel="preload" href="/assets/js/app.0aa97f73.js" as="script"><link rel="preload" href="/assets/js/2.f850a8ef.js" as="script"><link rel="preload" href="/assets/js/39.fe9ea525.js" as="script"><link rel="prefetch" href="/assets/js/10.cb041c1b.js"><link rel="prefetch" href="/assets/js/11.1aadbcee.js"><link rel="prefetch" href="/assets/js/12.77cc8e56.js"><link rel="prefetch" href="/assets/js/13.7e8162d9.js"><link rel="prefetch" href="/assets/js/14.dea6ba67.js"><link rel="prefetch" href="/assets/js/15.a786d687.js"><link rel="prefetch" href="/assets/js/16.163edf25.js"><link rel="prefetch" href="/assets/js/17.3a0232cb.js"><link rel="prefetch" href="/assets/js/18.91bd2dd7.js"><link rel="prefetch" href="/assets/js/19.a36993f8.js"><link rel="prefetch" href="/assets/js/20.30dd9f79.js"><link rel="prefetch" href="/assets/js/21.5e3c83a3.js"><link rel="prefetch" href="/assets/js/22.88d5e321.js"><link rel="prefetch" href="/assets/js/23.b54a65a7.js"><link rel="prefetch" href="/assets/js/24.51df379f.js"><link rel="prefetch" href="/assets/js/25.79342bd2.js"><link rel="prefetch" href="/assets/js/26.643d5441.js"><link rel="prefetch" href="/assets/js/27.54b7d7b4.js"><link rel="prefetch" href="/assets/js/28.d01a4aee.js"><link rel="prefetch" href="/assets/js/29.7d932073.js"><link rel="prefetch" href="/assets/js/3.31ebf682.js"><link rel="prefetch" href="/assets/js/30.4c2f5636.js"><link rel="prefetch" href="/assets/js/31.b00c42d5.js"><link rel="prefetch" href="/assets/js/32.e9a0f488.js"><link rel="prefetch" href="/assets/js/33.f510b5fd.js"><link rel="prefetch" href="/assets/js/34.6e78f32f.js"><link rel="prefetch" href="/assets/js/35.04d666a2.js"><link rel="prefetch" href="/assets/js/36.900a3beb.js"><link rel="prefetch" href="/assets/js/37.19ddf8d7.js"><link rel="prefetch" href="/assets/js/38.35f899bd.js"><link rel="prefetch" href="/assets/js/4.3c7083a8.js"><link rel="prefetch" href="/assets/js/40.0d116ce0.js"><link rel="prefetch" href="/assets/js/41.6cdce4cf.js"><link rel="prefetch" href="/assets/js/42.ab0bd0d5.js"><link rel="prefetch" href="/assets/js/43.66c8f8eb.js"><link rel="prefetch" href="/assets/js/44.ac02981e.js"><link rel="prefetch" href="/assets/js/45.479814b0.js"><link rel="prefetch" href="/assets/js/46.29956259.js"><link rel="prefetch" href="/assets/js/47.a89cf7d2.js"><link rel="prefetch" href="/assets/js/48.859e3502.js"><link rel="prefetch" href="/assets/js/49.d0fa0b25.js"><link rel="prefetch" href="/assets/js/5.206809f3.js"><link rel="prefetch" href="/assets/js/50.d051084c.js"><link rel="prefetch" href="/assets/js/51.fa831e6a.js"><link rel="prefetch" href="/assets/js/52.3ed98760.js"><link rel="prefetch" href="/assets/js/53.016b1c3c.js"><link rel="prefetch" href="/assets/js/54.c88e06c5.js"><link rel="prefetch" href="/assets/js/55.937bfe09.js"><link rel="prefetch" href="/assets/js/56.03003660.js"><link rel="prefetch" href="/assets/js/57.8bcda68a.js"><link rel="prefetch" href="/assets/js/58.286692ba.js"><link rel="prefetch" href="/assets/js/59.fbfe98aa.js"><link rel="prefetch" href="/assets/js/6.6f9d9bda.js"><link rel="prefetch" href="/assets/js/60.0975844e.js"><link rel="prefetch" href="/assets/js/61.0af6cf48.js"><link rel="prefetch" href="/assets/js/62.66c23699.js"><link rel="prefetch" href="/assets/js/63.7fda9b3f.js"><link rel="prefetch" href="/assets/js/7.6f64fba1.js"><link rel="prefetch" href="/assets/js/8.a163349f.js"><link rel="prefetch" href="/assets/js/9.9058d3cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87611319.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header.jpg" alt="DonV" class="logo"> <span class="site-name can-hide">DonV</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  其它
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  应用
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  其它
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  应用
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vscode 插件与 npm 包，保存时自动修复代码格式错误</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/js/eslint-prettier.html#前言" class="sidebar-link">前言</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/js/eslint-prettier.html#准备工作" class="sidebar-link">准备工作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#工具版本" class="sidebar-link">工具版本</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#vuecli3-功能选择" class="sidebar-link">Vuecli3 功能选择</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#vscode-初始插件" class="sidebar-link">Vscode 初始插件</a></li></ul></li><li><a href="/pages/js/eslint-prettier.html#修复流程" class="sidebar-link">修复流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#vetur-代码风格-jsconfig-json" class="sidebar-link">Vetur 代码风格 / jsconfig.json</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#eslint-错误检查" class="sidebar-link">ESLint 错误检查</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#autofix" class="sidebar-link">Autofix</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#prettier-格式化" class="sidebar-link">Prettier 格式化</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#formatonsave" class="sidebar-link">FormatOnSave</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#解决-eslint-与-prettier-冲突" class="sidebar-link">解决 eslint 与 prettier 冲突</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/pages/js/eslint-prettier.html#git-hook" class="sidebar-link">Git hook</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#husky-v4-与-lint-staged-规范代码" class="sidebar-link">Husky(v4) 与 lint-staged 规范代码</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#commitlint-规范提交说明" class="sidebar-link">Commitlint 规范提交说明</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#husky-v4-迁移-v7" class="sidebar-link">Husky v4 迁移 v7</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#小结-2" class="sidebar-link">小结</a></li></ul></li><li><a href="/pages/js/eslint-prettier.html#常见问题" class="sidebar-link">常见问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#如何关闭或跳过-eslint-校验规则" class="sidebar-link">如何关闭或跳过 eslint 校验规则？</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#旧项目如何接入格式化工具" class="sidebar-link">旧项目如何接入格式化工具？</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#无法格式化的文件如何修复" class="sidebar-link">无法格式化的文件如何修复？</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#提交时如何跳过-lint-阶段" class="sidebar-link">提交时如何跳过 lint 阶段？</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#lint-staged-在-pre-commit-阶段报错" class="sidebar-link">lint-staged 在 pre-commit 阶段报错</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#维护配置文件到-package-json" class="sidebar-link">维护配置文件到 package.json</a></li><li class="sidebar-sub-header"><a href="/pages/js/eslint-prettier.html#如何配置-vue-代码片段" class="sidebar-link">如何配置 vue 代码片段？</a></li></ul></li><li><a href="/pages/js/eslint-prettier.html#🎉-写在最后" class="sidebar-link">🎉 写在最后</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vscode-插件与-npm-包-保存时自动修复代码格式错误"><a href="#vscode-插件与-npm-包-保存时自动修复代码格式错误" class="header-anchor">#</a> vscode 插件与 npm 包，保存时自动修复代码格式错误</h1> <p><img src="/js/eslint-prettier/banner.gif" alt=""></p> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>  日常开发中的绝大多数项目，都是以团队为单位进行的。而由于每个成员的代码习惯和编码差异的不同，最终将导致整个项目的代码参差不齐，出现各式各样风格的代码。</p> <p>  而此差异性会严重导致团队协作效率低下，后期可维护性也会严重降低。例如代码缩进问题，大部分都是以<code>2</code>个或者<code>4</code>个空格为标准，倘若在没有格式化工具的前提下，迭代起来就会显得异常麻烦，只能逐行添加或者删除空格，不仅浪费时间也毫无意义。</p> <p>  因此制定统一规范的代码风格，并以此配置出格式化工具显得尤为重要，并且最好是在开发中就将此问题解决掉，于代码运行之前就检测出错误，保证推送到远端的代码是非常规范的。</p> <p>  此篇文章将以<code>vuecli3</code>脚手架为基础项目，以<code>vscode</code>为代码编辑器，从零开始逐步详细配置相关插件，最终达到保存时自动修复代码格式错误，跟随此篇文章你将了解到。</p> <ul><li><code>vscode</code>编辑器中<code>Vetur</code>插件的主要功能，多种配置<code>vue</code>代码片段的方式</li> <li>解决<code>ESLint</code>的<code>autofix</code>与<code>prettier</code>格式化之间的冲突，了解<code>eslint-config-prettier</code>与<code>eslint-plugin-prettier</code>之间的区别差异</li> <li>旧脚手架项目如何接入格式化工具</li> <li>代码提交时自动格式化并规范提交日志</li> <li><code>git hook</code>工具<code>husky</code>版本由<code>v4</code>迁移至<code>v7</code>时，如何修改相关配置项</li> <li>常见的格式化问题以及处理方式</li></ul> <p>  如果你仅关注如何使用，不关心配置流程和步骤，那么你可以跳过并浏览每个章节的小结部分，或者也可以访问 <a href="https://github.com/dongwei1125/eslint-prettier" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 仓库。</p> <h2 id="准备工作"><a href="#准备工作" class="header-anchor">#</a> 准备工作</h2> <h3 id="工具版本"><a href="#工具版本" class="header-anchor">#</a> 工具版本</h3> <p>  请确保你已经安装了 <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">vscode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 编辑器和 <a href="https://npm.taobao.org/mirrors/node/" target="_blank" rel="noopener noreferrer">node<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 环境，并且你也已经全局安装了 <a href="https://cli.vuejs.org/zh/guide/installation.html" target="_blank" rel="noopener noreferrer">vuecli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 脚手架和 <a href="https://npm.taobao.org/mirrors/git-for-windows/" target="_blank" rel="noopener noreferrer">git<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 工具，此处贴一下相关命令与版本。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>vscode
<span class="token number">1.61</span><span class="token number">.2</span>

node <span class="token operator">--</span>version
v14<span class="token punctuation">.</span><span class="token number">15.0</span>

vue <span class="token operator">--</span>version
@vue<span class="token operator">/</span>cli <span class="token number">4.5</span><span class="token number">.3</span>

git <span class="token operator">--</span>version
git version <span class="token number">2.27</span><span class="token number">.0</span><span class="token punctuation">.</span>windows<span class="token punctuation">.</span><span class="token number">1</span>
</code></pre></div><h3 id="vuecli3-功能选择"><a href="#vuecli3-功能选择" class="header-anchor">#</a> Vuecli3 功能选择</h3> <p>  选择目录或文件夹，开始创建<code>vuecli</code>脚手架，细致部分参考 <a href="https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create" target="_blank" rel="noopener noreferrer">vuecli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，注意最好是启动<code>Powershell</code>来创建。</p> <p>  磁盘根目录下按住<code>Shift</code>键再鼠标右击，选择<code>在此处打开 Powershell 窗口</code>。</p> <p><img src="/js/eslint-prettier/ps.png" alt=""></p> <p>  运行命令<code>vue create app</code>，选择<code>Manually select features</code>来手动设置更多的选项。</p> <blockquote><p>上下键切换选项，<code>Enter</code>确认，空格键选中或取消</p></blockquote> <p><img src="/js/eslint-prettier/pick.png" alt=""></p> <p>  项目功能只选择<code>Vue</code>版本和<code>Babel</code>转译器。</p> <p><img src="/js/eslint-prettier/features.png" alt=""></p> <p>  ;<code>vue</code>版本选择<code>2.x</code>，且各项配置在独立文件中。</p> <p><img src="/js/eslint-prettier/n.png" alt=""></p> <p>  创建成功。</p> <p><img src="/js/eslint-prettier/success.png" alt=""></p> <h3 id="vscode-初始插件"><a href="#vscode-初始插件" class="header-anchor">#</a> Vscode 初始插件</h3> <p>  ;<code>vscode</code>插件仅安装<code>chinese</code>和<code>Reload</code>两种，其中<code>chinese</code>语言拓展插件可安装也可不安装。</p> <blockquote><p>如果你还安装有其它插件，为了保证配置不出错，可以都禁用掉，不必卸载</p></blockquote> <p><img src="/js/eslint-prettier/plugins.png" alt=""></p> <p>  ;<code>Reload</code>插件将在<code>vscode</code>编辑器的右下角状态栏中添加重载按钮，用于快速重载<code>vscode</code>窗口，方便调试。</p> <p><img src="/js/eslint-prettier/reload.png" alt=""></p> <p>  键入<code>Shift + Ctrl + P</code>并输入<code>settings.json</code>打开设置，为了不影响调试效果，你的个性化等其它配置最好都注释掉。</p> <p><img src="/js/eslint-prettier/settings.png" alt=""></p> <h2 id="修复流程"><a href="#修复流程" class="header-anchor">#</a> 修复流程</h2> <h3 id="vetur-代码风格-jsconfig-json"><a href="#vetur-代码风格-jsconfig-json" class="header-anchor">#</a> Vetur 代码风格 / jsconfig.json</h3> <p>  ;<code>vscode</code>打开<code>vuecli3</code>脚手架后，能明显看到<code>App.vue</code>全是文本字体，没有高亮，代码行距也很紧凑，非常难看。</p> <p><img src="/js/eslint-prettier/text.png" alt=""></p> <p>  因此视觉上的代码高亮问题要先解决，于是在<code>vscode</code>中搜索并安装 <a href="https://marketplace.visualstudio.com/items?itemName=octref.vetur" target="_blank" rel="noopener noreferrer">Vetur<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 插件。</p> <p><img src="/js/eslint-prettier/Vetur.png" alt=""></p> <p>  一般在安装完成后<code>vscode</code>右下角会收到警告提示，如果你没有收到，那请点击状态栏<code>Reload</code>按钮，重载后几秒之内你会收到的。</p> <p>  原因在于<code>Vetur</code>会优先查找项目中的<code>tsconfig.json</code>和<code>jsconfig.json</code>文件，如果没有就会查找<code>vetur.config.js</code>文件，如果都没有，<code>Vetur</code>就会抛出此警告。</p> <p><img src="/js/eslint-prettier/jsconfig.png" alt=""></p> <p>  虽然说警告影响不大，但是有没有像我一样看着就来气的，真是气死强迫症。</p> <p>  没有那就创建一个<code>jsconfig.json</code>呗。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// jsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;src/*&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;dist&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  若目录中存在<code>jsconfig.json</code>，则表示此目录是<code>JavaScript</code>项目的根目录，因此包含以下文件的目录就被认为是根目录，更多 <a href="https://code.visualstudio.com/docs/languages/jsconfig" target="_blank" rel="noopener noreferrer">详细参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>├── node_modules
├── <span class="token operator">...</span>
├── jsconfig<span class="token punctuation">.</span>json
├── <span class="token operator">...</span>
├── <span class="token keyword">package</span><span class="token punctuation">.</span>json
├── <span class="token constant">README</span><span class="token punctuation">.</span>md
</code></pre></div><p>  其中<code>exclude</code>用于告知<code>vscode</code>哪些文件不属于源代码，使其<code>IntelliSense</code>（智能感知，即代码自动补全提示等）保持在高性能水平。<code>baseUrl</code>用于指定基础目录，<code>paths</code>表示相对于<code>baseUrl</code>选项计算的路径映射。</p> <p>  因此<code>@/*</code>即映射到当前目录<code>app</code>下的<code>src</code>目录下的文件或文件夹。如果还是没懂可以看如下图片，输入<code>@/</code>后随即智能提示出了<code>src</code>目录下的文件或文件夹。而此智能提示就是刚才配置<code>jsconfig.json</code>的劳动成果。</p> <blockquote><p>可以尝试注释<code>jsconfig.json</code>，<code>Reload</code>重载窗口，再次输入<code>@/</code>查看是否有无智能提示</p></blockquote> <p><img src="/js/eslint-prettier/intellisence.png" alt=""></p> <p>  代码有高亮看着舒服多了，但是稍显紧凑，因此来修改下行距和<code>Tab</code>空格数。</p> <p>  根目录下创建<code>.vscode</code>文件夹，新增<code>settings.json</code>。<code>lineHeight</code>用于指定行高，<code>tabSize</code>用于指定一个<code>Tab</code>键表示几个空格，但是可能会被覆盖。</p> <p>  原因是因为<code>editor.detectIndentation</code>默认为开启状态，表示根据文件内容自动检测出<code>editor.tabSize</code>，若检测出<code>editor.tabSize</code>则将自动覆盖设置项。因此若要强制一个<code>Tab</code>键为几个空格，可以将<code>editor.detecIndentation</code>设置为<code>false</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vscode/settings.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;editor.tabSize&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;editor.lineHeight&quot;</span><span class="token operator">:</span> <span class="token number">24</span>
  <span class="token comment">// &quot;editor.detectIndentation&quot;: false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  修改后<code>App.vue</code>的风格样式。</p> <p><img src="/js/eslint-prettier/style.png" alt=""></p> <h3 id="eslint-错误检查"><a href="#eslint-错误检查" class="header-anchor">#</a> ESLint 错误检查</h3> <p>  ;<code>Vetur</code>对<code>vue</code>中<code>&lt;template&gt;</code>、<code>&lt;style&gt;</code>、<code>&lt;script&gt;</code>都进行了错误检查，内部默认捆绑了 <a href="https://eslint.vuejs.org/" target="_blank" rel="noopener noreferrer">eslint-plugin-vue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 用于模板错误检查。默认情况下<code>Vetur</code>加载 <a href="https://eslint.vuejs.org/rules/#priority-a-essential-error-prevention-for-vue-js-2-x" target="_blank" rel="noopener noreferrer">vue/essential<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规则集用于<code>vue2</code>项目。</p> <p><img src="/js/eslint-prettier/essential.png" alt=""></p> <p>  但是由于<code>essential</code>规则集有限，现在选择官方推荐的 <a href="https://eslint.vuejs.org/rules/#priority-c-recommended-minimizing-arbitrary-choices-and-cognitive-overhead-for-vue-js-2-x" target="_blank" rel="noopener noreferrer">vue/recommended<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规则集来校验代码，因此将自定义<code>Vetur</code>的规则集，下面来自定义错误检查。</p> <p>  首先关闭<code>Vetur</code>的模板验证。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vscode/settings.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;vetur.validation.template&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  模板验证已经关闭。</p> <p><img src="/js/eslint-prettier/close.png" alt=""></p> <p>  然后安装<code>vscode</code>的 <a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint" target="_blank" rel="noopener noreferrer">ESLint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 插件，让<code>ESLint</code>插件来检查错误，而不是<code>Vetur</code>。</p> <p><img src="/js/eslint-prettier/ESLint.png" alt=""></p> <p>  ;<code>ESLint</code>插件将使用项目中的<code>eslint</code>依赖包，若项目内未提供，则<code>ESLint</code>插件会全局查找，因此项目需安装<code>eslint</code>依赖包。而针对<code>vue</code>项目，必然要一套检查<code>vue</code>代码的规则集，而此规则集可由<code>eslint-plugin-vue</code>提供。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i eslint eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>vue <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  ;<code>eslint-plugin-vue</code>有很多种规则集，而<code>ESLint</code>也不知道具体采用何种规则集，因此还要告知<code>ESLint</code>运用哪一套规则集去检查代码，所以根目录下新建<code>.eslintrc.js</code>文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:vue/recommended'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">quotes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>ESLint</code>检测配置文件的步骤如下，更多 <a href="https://cn.eslint.org/docs/user-guide/configuring#configuration-cascading-and-hierarchy" target="_blank" rel="noopener noreferrer">详细参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <ul><li>项目内查找<code>.eslintrc.*</code>或<code>package.json</code>文件（<code>package.json</code>内也可配置相关属性）</li> <li>若未找到，则在父级目录中查找，一直查找至磁盘根目录</li> <li>若在以上两步中发现<code>root: true</code>，则停止往父级目录中查找</li></ul> <p>  另外<code>extends</code>表示启用 <a href="https://eslint.vuejs.org/rules/#priority-c-recommended-minimizing-arbitrary-choices-and-cognitive-overhead-for-vue-js-2-x" target="_blank" rel="noopener noreferrer">vue/recommended<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规则集，<code>rules</code>中可自定义检查规则，<code>['error', 'single']</code>表示字符串仅能使用单引号，若非单引号则将以错误下划线高亮。</p> <blockquote><p><code>['warn', 'single']</code>将以警告下划线高亮</p></blockquote> <p><img src="/js/eslint-prettier/quotes.png" alt=""></p> <p>  新增了配置点击状态栏<code>Reload</code>重载窗口，查看<code>App.vue</code>文件，自定义错误检查已生效。</p> <p><img src="/js/eslint-prettier/custom.png" alt=""></p> <h3 id="autofix"><a href="#autofix" class="header-anchor">#</a> Autofix</h3> <p>  现在已经可以对代码进行检查了，手动尝试下修复代码。</p> <p><img src="/js/eslint-prettier/try-fixed.png" alt=""></p> <p>  但是你可以打开<code>component/HelloWorld.vue</code>浏览看看，通篇的警告就问你慌不慌。像<code>App.vue</code>代码较少，尚可以手动修复，但是<code>HelloWorld.vue</code>难道要一行一行修改不成。</p> <p>  有没有可能<code>ESLint</code>检测出代码，并且还能修复呢，嘿嘿，还真有，即<code>ESLint</code>的<code>autofix</code>功能。</p> <p>  将<code>App.vue</code>还是恢复为以下状态。</p> <p><img src="/js/eslint-prettier/restore.png" alt=""></p> <p>  ;<code>vscode</code>命令行执行以下命令，即修复<code>App.vue</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npx eslint src<span class="token operator">/</span>App<span class="token punctuation">.</span>vue <span class="token operator">--</span>fix
</code></pre></div><p>  修复后的<code>App.vue</code>。</p> <p><img src="/js/eslint-prettier/fixed-after.png" alt=""></p> <p>  此时控制台输出<code>2</code>个错误，大致描述就是<code>v-for</code>的元素需指定<code>key</code>，而<code>item</code>也声明但是未被使用。你要知道的是<code>ESLint</code>仅仅能修复简单的错误，像<code>v-for</code>的<code>key</code>值问题等还是需要你手动修复的。</p> <p><img src="/js/eslint-prettier/errors.png" alt=""></p> <p>  可能你会问，是不是每次代码写完还要针对某个文件执行一次<code>npx eslint ...</code>，如果是那样就真的尴了个大尬。</p> <p>  在<code>settings.json</code>添加如下命令，即在每次文件被保存时，自动执行<code>fix</code>修复。</p> <blockquote><p>可能你会在其它文章中看到<code>source.fixAll</code>，两者区别在于<code>source.fixAll</code>表示针对所有插件开启自动修复，<code>source.fixAll.eslint</code>表示只在<code>ESLint</code>中开启</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vscode/settings.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;source.fixAll.eslint&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>App.vue</code>保存时。</p> <p><img src="/js/eslint-prettier/save.gif" alt=""></p> <h3 id="prettier-格式化"><a href="#prettier-格式化" class="header-anchor">#</a> Prettier 格式化</h3> <p>  于是问题都解决了吗？其实并没有哦，看看如下情况。</p> <p><img src="/js/eslint-prettier/question.gif" alt=""></p> <p>  由于<code>eslint-plugin-vue</code>中提供的规则集<code>vue/recommended</code>中的规则 <a href="https://eslint.vuejs.org/rules/html-indent.html" target="_blank" rel="noopener noreferrer">vue/html-indent<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，此规则对标签强制使用了一致的缩进，因此保存时<code>&lt;template&gt;</code>自动修复了缩进。</p> <p>  但是<code>&lt;script&gt;</code>中却没有修复，因为<code>vue/recommended</code>规则集没有提供用于<code>&lt;script&gt;</code>标签缩进的规则，所以修复时<code>&lt;script&gt;</code>内也就没效果，第一种解决方式很简单，就是添加用于<code>vue</code>文件的<code>&lt;script&gt;</code>缩进的规则 <a href="https://eslint.vuejs.org/rules/script-indent.html" target="_blank" rel="noopener noreferrer">vue/script-indent<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token string-property property">'vue/script-indent'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'baseIndent'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string-property property">'switchCase'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string-property property">'ignores'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">'overrides'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string-property property">'files'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'*.vue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">'rules'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'indent'</span><span class="token operator">:</span> <span class="token string">'off'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  但是此方式不推荐，因为不仅耗时、规则覆盖不全面（可能会少某几条）而且也没必要。其中配置项各参数释义不赘述，更多 <a href="https://eslint.vuejs.org/rules/html-indent.html" target="_blank" rel="noopener noreferrer">详细参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><img src="/js/eslint-prettier/add-rules.gif" alt=""></p> <p>  来看一个有趣的操作，你可以在<code>App.vue</code>右键选择格式化文档（也可键入<code>Shift + Alt + F</code>），紧接着再保存（<code>Ctrl + S</code>），你会发现<code>&lt;template&gt;</code>与<code>&lt;script&gt;</code>中的代码都被修复了。</p> <p><img src="/js/eslint-prettier/action.gif" alt=""></p> <p>  为什么会被修复呢？原因在于 <a href="https://vuejs.github.io/vetur/guide/formatting.html" target="_blank" rel="noopener noreferrer">格式化文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是由<code>Vetur</code>提供的，<code>Vetur</code>默认捆绑了多个格式化程序（例如 <a href="https://github.com/prettier/prettier" target="_blank" rel="noopener noreferrer">prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 等）用来格式化代码。</p> <p>  你应该了解的是 <a href="https://cn.eslint.org/docs/rules/" target="_blank" rel="noopener noreferrer">代码规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 分为两类，代码质量规则和代码风格规则。代码质量出现问题，意味着项目可能没法运转，也可能存在潜在的缺陷。而代码风格不一样，代码风格出现问题，仅仅是代码丑陋，你看着不爽。</p> <p>  代码质量规则。</p> <ul><li><a href="https://cn.eslint.org/docs/rules/no-unused-vars" target="_blank" rel="noopener noreferrer">no-unused-vars<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：禁止出现未使用过的变量</li> <li><a href="https://cn.eslint.org/docs/rules/no-use-before-define" target="_blank" rel="noopener noreferrer">no-use-before-define<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：禁止在变量定义之前使用它</li> <li><a href="https://eslint.vuejs.org/rules/no-v-html.html" target="_blank" rel="noopener noreferrer">no-v-html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：禁止使用<code>v-html</code>来防止<code>XSS</code>攻击</li> <li><code>...</code></li></ul> <p>  代码风格规则。</p> <ul><li><a href="https://cn.eslint.org/docs/rules/max-len" target="_blank" rel="noopener noreferrer">max-len<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：单行的最大长度</li> <li><a href="https://cn.eslint.org/docs/rules/semi" target="_blank" rel="noopener noreferrer">semi<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：强制或禁止使用分号</li> <li><a href="https://cn.eslint.org/docs/rules/indent" target="_blank" rel="noopener noreferrer">indent<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：缩进问题</li> <li><code>...</code></li></ul> <p>  而刚才已经知晓了当前<code>eslint</code>使用的<code>vue/recommended</code>规则集，仅仅包括了<code>&lt;template&gt;</code>中的代码质量（<code>v-for</code>的<code>key</code>值问题等）和代码风格（少部分，包括缩进规则等，例如不包括单行的最大长度等）的检测，但是缺少<code>&lt;script&gt;</code>中的代码风格校验（缩进规则等）。</p> <p>  对于<code>&lt;template&gt;</code>和<code>&lt;script&gt;</code>两部分的代码缩进，<code>vue/recommend</code>规则集已经可以修复<code>&lt;temnplate&gt;</code>的缩进，而<code>&lt;script&gt;</code>的缩进现在让<code>Vetur</code>来做。</p> <p>  ;<code>Vetur</code>是开启了<code>vetur.useWorkspaceDependencies</code>为<code>true</code>，即它可以优先使用根目录下的 <a href="https://www.prettier.cn/" target="_blank" rel="noopener noreferrer">prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 格式化依赖包，因此来自定义<code>Vetur</code>的格式化功能。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i prettier <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  添加<code>.prettierrc.js</code>，加上几条简单的 <a href="https://www.prettier.cn/docs/options.html" target="_blank" rel="noopener noreferrer">规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，<code>printWidth</code>（每行最多多少字符换行）、<code>semi</code>（语句末尾分号）、<code>arrowParens</code>（<code>avoid</code>表示箭头函数是单个参数时，参数周围省略括号）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .prettierrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">semi</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">printWidth</span><span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">,</span>
  <span class="token literal-property property">arrowParens</span><span class="token operator">:</span> <span class="token string">'avoid'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  格式化文档后并保存，可以看到<code>&lt;script&gt;</code>中的缩进已经修复。</p> <p><img src="/js/eslint-prettier/script-fixed.gif" alt=""></p> <h3 id="formatonsave"><a href="#formatonsave" class="header-anchor">#</a> FormatOnSave</h3> <p>  频繁右键格式化麻烦不，有没有可能像<code>ESLint</code>一样保存时自动修复呢，答案肯定是有的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vscode/settings.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;editor.formatOnSave&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  现在代码还原尝试下保存呢（<code>Crtl + S</code>）。</p> <p>  但是意料之外的情况发生了，保存时，起初运行的是<code>ESLint</code>的<code>autofix</code>，紧接着运行了<code>Vetur</code>的格式化，即<code>autofix</code>介于<code>Vetur</code>格式化之前了。</p> <p>  最后导致风格样式按照<code>prettier</code>来了（例如字符串为双引号），显然不符合<code>ESLint</code>的规则。因此格式是修复了，但是却被<code>ESLint</code>检测出错误了。</p> <p><img src="/js/eslint-prettier/error.gif" alt=""></p> <p>  以至于频繁保存会频繁闪烁。</p> <p><img src="/js/eslint-prettier/blink.gif" alt=""></p> <h3 id="解决-eslint-与-prettier-冲突"><a href="#解决-eslint-与-prettier-冲突" class="header-anchor">#</a> 解决 eslint 与 prettier 冲突</h3> <h4 id="eslint-config-prettier"><a href="#eslint-config-prettier" class="header-anchor">#</a> eslint-config-prettier</h4> <p>  频繁闪烁的根本原因在于<code>eslint</code>与<code>prettier</code>一起使用产生了冲突。<code>eslint</code>认为字符串应为单引号，而<code>prettier</code>默认格式化为双引号，所以先来统一单双引号问题，在<code>.prettierrc.js</code>中添加如下规则。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .prettierrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">singleQuote</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  现在还存在换行冲突，<code>prettier</code>认为单行最大长度达到<code>110</code>就可以换行，而<code>eslint</code>认为只要是标签属性都应另起一行。</p> <p><img src="/js/eslint-prettier/conflict.png" alt=""></p> <p>  注意实际代码格式问题已经解决了（例如缩进问题、单行最大长度等），你会想要是禁用掉<code>eslint</code>的 <a href="https://eslint.vuejs.org/rules/max-attributes-per-line.html" target="_blank" rel="noopener noreferrer">vue/max-attributes-per-line<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规则，不要它去检查警告，是不是问题就迎刃而解了。</p> <p>  嘿嘿，没错，你猜对了，还真是这样。</p> <p>  但是不用我们去做了，<a href="https://github.com/prettier/eslint-config-prettier" target="_blank" rel="noopener noreferrer">eslint-config-prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 已经做了，看名字大概也能猜到，<code>config</code>位于<code>eslint</code>与<code>prettier</code>中间，即用于平衡<code>eslint</code>与<code>prettier</code>之间的配置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i eslint<span class="token operator">-</span>config<span class="token operator">-</span>prettier <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  但是是用于平衡哪些配置呢，官方文档给出了答案，即关闭了<code>eslint</code>中所有不必要的或者可能与<code>prettier</code>冲突的那些规则，实际也就是代码风格规则。</p> <p>  ;<code>.eslintrc.js</code>中添加<code>prettier</code>表示启用<code>eslint-config-prettier</code>，注意一定要在最后，确保覆盖之前的同类规则，否则可能不生效。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'plugin:vue/recommended'</span><span class="token punctuation">,</span>
    <span class="token string">'prettier'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  保存时效果，也能看到<code>eslint</code>相关的代码质量规则未被禁用。</p> <p><img src="/js/eslint-prettier/conflict-fixed.gif" alt=""></p> <h4 id="eslint-plugin-prettier"><a href="#eslint-plugin-prettier" class="header-anchor">#</a> eslint-plugin-prettier</h4> <p>  还记得最开始时，<code>&lt;template&gt;</code>中标签缩进错误时，会高亮黄色警告下划波浪线吗。</p> <p><img src="/js/eslint-prettier/start.png" alt=""></p> <p>  如果还是想包含此功能，可以安装一个推荐的可选插件 <a href="https://github.com/prettier/eslint-plugin-prettier" target="_blank" rel="noopener noreferrer">eslint-plugin-prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>  由于插件<code>eslint-config-prettier</code>的原因，代码格式问题已经交给<code>prettier</code>负责，而<code>eslint</code>代码格式相关的检测规则也被禁用了，因此即使代码中出现了格式问题，<code>eslint</code>是不会报错的。</p> <p>  而<code>eslint-plugin-prettier</code>做了一件什么事呢？它将<code>prettier</code>格式问题的相关规则，转换成了对应的<code>eslint</code>规则，并注入到了<code>eslint</code>中，由此代码中的格式问题，<code>eslint</code>也会报错。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>prettier <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  修改<code>.eslintrc.js</code>，其中<code>plugins</code>表示将<code>prettier</code>注册为插件，<code>prettier/pretiier</code>表示将<code>prettier</code>插件提供的规则注入<code>eslint</code>，并且使其在<code>eslint</code>中运行<code>prettier</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:vue/recommended'</span><span class="token punctuation">,</span> <span class="token string">'prettier'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'prettier'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">quotes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">'prettier/prettier'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  有两个不适用的规则。</p> <ul><li><a href="http://eslint.cn/docs/rules/arrow-body-style" target="_blank" rel="noopener noreferrer">arrow-body-style<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：箭头函数体只能为大括号</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span> <span class="token punctuation">}</span>    <span class="token comment">// OK</span>

<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>    <span class="token comment">// ERROR</span>
</code></pre></div><ul><li><a href="http://eslint.cn/docs/rules/prefer-arrow-callback" target="_blank" rel="noopener noreferrer">prefer-arrow-callback<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：使用箭头作为回调函数</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">arg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment">// OK</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment">// ERROR</span>
</code></pre></div><p>  很明显都不是很合理，<code>arrow-body-style</code>规则代码也将不是很优雅，修改<code>.eslintrc.js</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:vue/recommended'</span><span class="token punctuation">,</span> <span class="token string">'prettier'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'prettier'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">quotes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">'prettier/prettier'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'arrow-body-style'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'prefer-arrow-callback'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  而以上配置可以更为便捷地合并为以下，了解更多可参考 <a href="https://github.com/prettier/eslint-plugin-prettier#recommended-configuration" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:vue/recommended'</span><span class="token punctuation">,</span> <span class="token string">'plugin:prettier/recommended'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">quotes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  以上配置完成后，不出意外，你的<code>App.vue</code>或<code>HelloWord.vue</code>等都将会有很多错误提示。</p> <p><img src="/js/eslint-prettier/CR.png" alt=""></p> <p>  是由于行尾换行符造成的，不要紧，<code>.prettierrc.js</code>添加如下规则，更多 <a href="https://www.prettier.cn/docs/options.html#end-of-line" target="_blank" rel="noopener noreferrer">详细参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .prettierrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">endOfLine</span><span class="token operator">:</span> <span class="token string">'crlf'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  至此格式化相关的步骤就都完成了。</p> <p><img src="/js/eslint-prettier/finally.gif" alt=""></p> <h4 id="区别差异"><a href="#区别差异" class="header-anchor">#</a> 区别差异</h4> <p>  ;<code>eslint-config-prettier</code>不仅提供了<code>prettier</code>的格式化规则，同时也禁用了<code>eslint</code>中所有不必要的或者可能与<code>prettier</code>冲突的那些规则。</p> <p>  代码质量检测均由<code>eslint</code>负责，没有代码格式检测。代码质量修复依赖于<code>eslint</code>的<code>autofix</code>，代码格式的修复依赖于<code>prettier</code>。</p> <p>  所以仅安装<code>eslint-config-prettier</code>时，<code>eslint</code>的<code>autofix</code>和<code>prettier</code>的保存格式化两者一定要同时开启，而且根据上文我们也知道<code>eslint</code>的<code>autofix</code>是介于<code>prettier</code>的格式化之前运行的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vscode/settings.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;source.fixAll.eslint&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;editor.formatOnSave&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  仅开启<code>eslint</code>的<code>autofix</code>，能明显看到仅仅修复了代码质量，代码格式并未修复。</p> <p><img src="/js/eslint-prettier/config-diff-autofix.gif" alt=""></p> <p>  仅开启<code>prettier</code>的格式化，代码质量未被修复，代码格式均被修复。</p> <p><img src="/js/eslint-prettier/config-diff-prettier.gif" alt=""></p> <p>  ;<code>eslint-plugin-prettier</code>则是将<code>prettier</code>格式问题的相关规则，转换成了对应的<code>eslint</code>规则，并注入到了<code>eslint</code>中。</p> <p>  代码质量检测均由<code>eslint</code>负责，注意代码质量的规则由<code>eslint</code>和<code>eslint-plugin-vue</code>两者提供，代码格式检测也是由<code>eslint</code>负责，代码格式的规则是由<code>prettier</code>提供，且依赖于<code>eslint-plugin-prettier</code>转换并注入到<code>eslint</code>中。</p> <p>  ;<code>eslint-plugin-prettier</code>还做了另外一件事，即在<code>eslint</code>的<code>autofix</code>后，紧接着继续运行<code>prettier</code>，因此仅开启<code>eslint</code>的<code>autofix</code>就能完成质量和格式的修复。</p> <p>  但是要明确的是，代码质量修复还是依赖于<code>eslint</code>的<code>autofix</code>，代码格式的修复还是依赖于<code>prettier</code>，只是<code>eslint-plugin-prettier</code>在<code>autofix</code>后帮你自动运行了<code>prettier</code>。</p> <p>  仅开启<code>eslint</code>的<code>autofix</code>，代码质量和格式均高亮，且保存时都被修复。</p> <p><img src="/js/eslint-prettier/plugin-diff-autofix.gif" alt=""></p> <p>  仅开启<code>prettier</code>的格式化，代码质量和格式均高亮，但是只修复了格式问题。</p> <p><img src="/js/eslint-prettier/plugin-diff-prettier.gif" alt=""></p> <h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <p>  初始脚手架代码都是文本字体，引入<code>Vetur</code>高亮代码。</p> <p>  ;<code>Vetur</code>会查找项目中<code>jsconfig.json</code>等文件并抛出警告，新建<code>jsconfig.json</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// jsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;src/*&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;dist&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>vscode</code>引入<code>ESLint</code>插件，安装<code>eslint</code>错误检查包和格式化依赖包，其中<code>eslint</code>和<code>eslint-plugin-vue</code>用于错误检查，<code>prettier</code>用于格式化代码，<code>eslint-config-prettier</code>用于解决<code>eslint</code>与<code>prettier</code>之间的冲突，可选插件<code>eslint-plugin-prettier</code>用于注入<code>prettier</code>格式化规则到<code>eslint</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i eslint eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>vue prettier eslint<span class="token operator">-</span>config<span class="token operator">-</span>prettier eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>prettier <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  新建<code>.eslintrc.js</code>，启用<code>eslint-plugin-vue</code>的<code>vue</code>规则集，同时启用<code>eslint-config-prettier</code>，并且启用<code>eslint-config-prettier</code>注入规则。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:vue/recommended'</span><span class="token punctuation">,</span> <span class="token string">'plugin:prettier/recommended'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">quotes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  新建<code>.prettierrc.js</code>，统一部分格式化规则和换行符等。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .prettierrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">semi</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">printWidth</span><span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">,</span>
  <span class="token literal-property property">arrowParens</span><span class="token operator">:</span> <span class="token string">'avoid'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">singleQuote</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">endOfLine</span><span class="token operator">:</span> <span class="token string">'crlf'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  新建<code>settings.json</code>，保存时自动运行<code>eslint</code>的<code>autofix</code>和<code>prettier</code>格式化。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vscode/settings.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;editor.tabSize&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;editor.lineHeight&quot;</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;vetur.validation.template&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;source.fixAll.eslint&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;editor.formatOnSave&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  以上插件和依赖的作用。</p> <ul><li><a href="https://marketplace.visualstudio.com/items?itemName=octref.vetur" target="_blank" rel="noopener noreferrer">Vetur<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：<code>vscode</code>插件，用于高亮<code>Vue</code>代码，提供了代码的错误检查和格式化、代码自动补全提示等</li> <li><a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint" target="_blank" rel="noopener noreferrer">ESLint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：<code>vscode</code>插件，依赖于本地工作区或全局下的<code>eslint</code>依赖包</li> <li><a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer">eslint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：用于检测和修复代码错误，自定义检测规则，引入<code>vue</code>代码检测的规则集</li> <li><a href="https://eslint.vuejs.org/" target="_blank" rel="noopener noreferrer">eslint-plugin-vue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：提供用于检测<code>vue2</code>代码的规则集 <a href="https://eslint.vuejs.org/rules/#priority-c-recommended-minimizing-arbitrary-choices-and-cognitive-overhead-for-vue-js-2-x" target="_blank" rel="noopener noreferrer">vue/recommended<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.prettier.cn/" target="_blank" rel="noopener noreferrer">prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：用于格式化代码，自定义格式规则</li> <li><a href="https://github.com/prettier/eslint-config-prettier" target="_blank" rel="noopener noreferrer">eslint-config-prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：用于解决<code>eslint</code>和<code>prettier</code>在代码格式上的冲突，禁用了<code>eslint</code>中所有不必要的或者可能与<code>prettier</code>冲突的规则</li> <li><a href="https://github.com/prettier/eslint-plugin-prettier" target="_blank" rel="noopener noreferrer">eslint-plugin-prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：将<code>prettier</code>中的代码格式规则，转换为对应的<code>eslint</code>规则并注入到<code>eslint</code>中，使<code>eslint</code>能够检测代码格式问题。另外让<code>eslint</code>在执行<code>autofix</code>后再运行<code>prettier</code></li></ul> <h2 id="git-hook"><a href="#git-hook" class="header-anchor">#</a> Git hook</h2> <p>  引入诸多插件都是为了在开发阶段规范或者修复代码，但是都是以<code>vscode</code>编辑器为前提的，倘若其它成员使用的是<code>webstorm</code>等其它编辑器，那么之前做的事情就都白费了。</p> <p>  还好远端是利用<code>git</code>在管理代码，大家提交代码的方式是一致的，编辑器不能做到完全规范代码，但是可以在提交时统一代码。</p> <p>  来了解一下<code>git hook</code>，<code>git hook</code>即<code>git</code>钩子，<code>git</code>在特定事件发生时会触发对应的脚本（类似于<code>vue</code>的生命周期），<code>git init</code>初始化后的仓库中，<code>.git/hooks</code>目录下默认包括很多示例脚本（都是以<code>.sample</code>结尾），删除掉<code>.sample</code>后缀可启用。</p> <p>  常用的钩子包括<code>pre-commit</code>、<code>commit-msg</code>等。</p> <ul><li><code>pre-commit</code>：暂存中的文件被提交前触发，或者说在你<code>git commit ...</code>之前触发。若此钩子以非零值退出，<code>git</code>将放弃此次提交（可利用<code>git commit --no-verify</code>跳过），一般可利用此钩子来检查代码风格等</li> <li><code>commit-msg</code>：输入提交说明后且于<code>pre-commit</code>后触发。若此钩子以非零值退出，<code>git</code>也将放弃提交，一般用于校验提交说明是否符合规范</li></ul> <h3 id="husky-v4-与-lint-staged-规范代码"><a href="#husky-v4-与-lint-staged-规范代码" class="header-anchor">#</a> Husky(v4) 与 lint-staged 规范代码</h3> <p>  思路应该是很清晰了，即在代码提交时，触发对应的钩子来检测并规范代码，因此先初始化一个<code>git</code>仓库。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git init
</code></pre></div><p>  然后再来了解一下 <a href="https://typicode.github.io/husky/#/" target="_blank" rel="noopener noreferrer">husky<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，<code>husky</code>是一个为<code>git</code>客户端添加<code>hook</code>的工具，安装<code>v4</code>版本（<code>v4.3.8</code>及之前的版本）后，<code>husky</code>默认会在<code>.git/hooks</code>目录下生成所有类型的<code>git hook</code>。然后在<code>git</code>工作的每个阶段都会调用<code>husky</code>所生成的脚本，在脚本中<code>husky</code>会检查用户是否配置有此钩子，如果有就运行用户配置的命令，没有就继续往后执行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i husky@<span class="token number">4.3</span><span class="token number">.8</span> <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  安装完成后，目录<code>.git/hooks</code>下生成了很多的<code>hook</code>。</p> <p><img src="/js/eslint-prettier/dir.png" alt=""></p> <p>  来测试一下<code>husky</code>，新建<code>.huskyrc.json</code>，其中<code>pre-commit</code>钩子触发将运行<code>echo hello husky</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .huskyrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo hello husky&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  修改代码并提交。</p> <p><img src="/js/eslint-prettier/hello-husky.png" alt=""></p> <p>  已经可以在提交时触发钩子了，现在来考虑一个问题，是在提交前规范目录中所有代码，还是仅仅规范暂存中的代码呢。显然只规范暂存中的代码就可以了，不仅避免检查整个项目，提高运行效率，也避免了修改到其它文件。</p> <p>  而插件 <a href="https://github.com/okonet/lint-staged" target="_blank" rel="noopener noreferrer">lint-staged<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 就是对暂存中的文件执行检查的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i lint<span class="token operator">-</span>staged <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  新建<code>.lintstagedrc.json</code>，注意源码一般位于<code>src</code>目录下，因此仅对<code>src</code>目录下的<code>js</code>和<code>vue</code>文件执行<code>eslint --fix</code>即可，格式修复完成后再执行<code>git add</code>暂存。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .lintstagedrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;src/**/*.{js,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;git add&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  修改<code>.huskyrc.json</code>，即<code>pre-commit</code>钩子触发时，将运行<code>.lintstagedrc.json</code>中的命令。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .huskyrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  关闭<code>eslint</code>的<code>autofix</code>和<code>prettier</code>的格式化，打乱<code>App.vue</code>中代码样式，暂存并提交，可以看到在<code>pre-commit</code>时<code>lint-staged</code>对<code>App.vue</code>进行了检测和修复。</p> <p><img src="/js/eslint-prettier/pre-commit.png" alt=""></p> <h3 id="commitlint-规范提交说明"><a href="#commitlint-规范提交说明" class="header-anchor">#</a> Commitlint 规范提交说明</h3> <p>  安装 <a href="https://github.com/conventional-changelog/commitlint" target="_blank" rel="noopener noreferrer">commitlint/cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和常规配置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i @commitlint<span class="token operator">/</span>cli @commitlint<span class="token operator">/</span>config<span class="token operator">-</span>conventional <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  新增<code>commitlint.config.js</code>引入提交规范集。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// commitlint.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  修改<code>.huskyrc.json</code>，即<code>commit-msg</code>钩子触发时，将运行对应的命令。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .huskyrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commitlint -E HUSKY_GIT_PARAMS&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  再次暂存并提交，可以看到<code>commit-msg</code>钩子触发时<code>commitlint</code>对提交说明进行了验证。</p> <p><img src="/js/eslint-prettier/commit-msg.png" alt=""></p> <h3 id="husky-v4-迁移-v7"><a href="#husky-v4-迁移-v7" class="header-anchor">#</a> Husky v4 迁移 v7</h3> <p>  先来说说<code>husky</code>为什么由<code>v4</code>破坏性地更新到<code>v7</code>了，<code>v4</code>版本的<code>husky</code>会生成所有类型的<code>git hook</code>，其好处就是无论用户设置任何类型的<code>git hook</code>，<code>husky</code>都能保证其正常运行，但是坏处也很明显，即用户不设置任何<code>git hook</code>，<code>husky</code>也向<code>git</code>添加了所有类型的<code>git hook</code>。</p> <p>  ;<code>v4</code>版本缺陷的根本原因在于，任何一个完整的<code>git hook</code>功能，一是要在<code>.git/hooks</code>添加相应的<code>hook</code>，二是要在根目录添加<code>.huskyrc.json</code>文件或<code>package.json</code>中配置此<code>hook</code>要执行的命令，但是作者没有很好的办法来同步它们。</p> <p>  还好<code>git 2.9</code>版本引入了<code>core.hooksPath</code>，此属性可指定<code>git hook</code>所在目录。<code>husky</code>启用<code>git</code>钩子后，将会把<code>git hook</code>的目录指定为<code>.husky</code>，此方式好处就在于，需要什么<code>hook</code>，就在<code>.husky</code>文件夹添加什么<code>hook</code>，不需要什么都不用添加，更多 <a href="https://blog.typicode.com/husky-git-hooks-javascript-config/" target="_blank" rel="noopener noreferrer">详细参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>  现在由<code>v4</code>版本迁移至<code>v7</code>版本，请卸载目录下<code>husky(v4)</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm un husky
</code></pre></div><p>  然后安装最新版本的<code>husky</code>（目前<code>v7.0.4</code>）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i husky <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  启用<code>git</code>钩子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npx husky install
</code></pre></div><p>  启用后将在根目录生成<code>.husky</code>文件夹，其中默认包括<code>_</code>文件夹、<code>.gitignore</code>和<code>husky.sh</code>。</p> <p><img src="/js/eslint-prettier/husky.png" alt=""></p> <p>  同时<code>.git/config</code>文件中将添加如下属性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .git/config</span>
<span class="token punctuation">[</span>core<span class="token punctuation">]</span>
  <span class="token operator">...</span>
  hooksPath <span class="token operator">=</span> <span class="token punctuation">.</span>husky
</code></pre></div><p>  ;<code>.husky</code>目录下新建<code>pre-commit</code>文件，其中<code>--no-install</code>表示强制<code>npx</code>使用本地模块，不下载远程模块，但是本地模块不存在时将会报错。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .husky/pre-commit</span>
#<span class="token operator">!</span><span class="token operator">/</span>bin<span class="token operator">/</span>sh
<span class="token punctuation">.</span> <span class="token string">&quot;$(dirname &quot;</span>$0<span class="token string">&quot;)/_/husky.sh&quot;</span>

echo <span class="token string">'husky &gt; pre-commit'</span>
npx <span class="token operator">--</span>no<span class="token operator">-</span>install lint<span class="token operator">-</span>staged
</code></pre></div><p>  验证提交说明的迁移也是一样，在<code>.husky</code>下新建<code>commit-msg</code>钩子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .husky/commit-msg</span>
#<span class="token operator">!</span><span class="token operator">/</span>bin<span class="token operator">/</span>sh
<span class="token punctuation">.</span> <span class="token string">&quot;$(dirname &quot;</span>$0<span class="token string">&quot;)/_/husky.sh&quot;</span>

echo <span class="token string">'husky &gt; commit-msg'</span>
npx <span class="token operator">--</span>no<span class="token operator">-</span>install commitlint <span class="token operator">--</span>edit $1
</code></pre></div><p>  最后根目录下的<code>.huskyrc.json</code>也可以删除了，因为<code>v7</code>版本已经不依赖这一层映射关系了，<code>.husky</code>目录内<code>hook</code>将直接运行命令，这也就是<code>v7</code>版本更新后的优点，缺点也很明显，无端增加了用户的学习成本。</p> <h3 id="小结-2"><a href="#小结-2" class="header-anchor">#</a> 小结</h3> <h4 id="husky-v4-版本"><a href="#husky-v4-版本" class="header-anchor">#</a> Husky v4 版本</h4> <p>  由于是利用<code>git</code>来管理代码，因此先要保证项目已经初始化为<code>git</code>仓库。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git init
</code></pre></div><p>  安装<code>git hook</code>工具和检查工具、提交说明检查工具和检查规则集，其中<code>husky</code>用于为<code>git</code>添加<code>hook</code>工具，<code>lint-staged</code>用于检查暂存中的文件，<code>commitlint</code>用于检查提交说明，<code>config-conventional</code>用于提供检查规则集。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i husky@<span class="token number">4.3</span><span class="token number">.8</span> lint<span class="token operator">-</span>staged @commitlint<span class="token operator">/</span>cli @commitlint<span class="token operator">/</span>config<span class="token operator">-</span>conventional <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  新建<code>.lintstagedrc.json</code>，用于修复暂存中的文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .lintstagedrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;src/**/*.{js,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;git add&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  新建<code>commitlint.config.js</code>，启用<code>config-conventional</code>规则集。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// commitlint.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  新建<code>.huskyrc.json</code>，<code>git</code>钩子触发时执行相应的命令。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .huskyrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commitlint -E HUSKY_GIT_PARAMS&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="husky-v7-版本"><a href="#husky-v7-版本" class="header-anchor">#</a> Husky v7 版本</h4> <p>  ;<code>v4</code>迁移<code>v7</code>请卸载<code>husky(v4)</code>版本。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm un husky
</code></pre></div><p>  安装最新版本<code>husky</code>（目前<code>v7.0.4</code>）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i husky <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>  启用<code>git</code>钩子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npx husky intall
</code></pre></div><p>  新建<code>pre-commit</code>、<code>commit-msg</code>钩子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .husky/pre-commit</span>
#<span class="token operator">!</span><span class="token operator">/</span>bin<span class="token operator">/</span>sh
<span class="token punctuation">.</span> <span class="token string">&quot;$(dirname &quot;</span>$0<span class="token string">&quot;)/_/husky.sh&quot;</span>

echo <span class="token string">'husky &gt; pre-commit'</span>
npx <span class="token operator">--</span>no<span class="token operator">-</span>install lint<span class="token operator">-</span>staged

<span class="token comment">// .husky/commit-msg</span>
#<span class="token operator">!</span><span class="token operator">/</span>bin<span class="token operator">/</span>sh
<span class="token punctuation">.</span> <span class="token string">&quot;$(dirname &quot;</span>$0<span class="token string">&quot;)/_/husky.sh&quot;</span>

echo <span class="token string">'husky &gt; commit-msg'</span>
npx <span class="token operator">--</span>no<span class="token operator">-</span>install commitlint <span class="token operator">--</span>edit $1
</code></pre></div><p>  再删除<code>.huskyrc.json</code>文件即可。</p> <h4 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h4> <p>  以上插件的作用。</p> <ul><li><a href="https://typicode.github.io/husky/#/" target="_blank" rel="noopener noreferrer">husky<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：为<code>git</code>客户端添加<code>hook</code>工具，<code>v4</code>（<code>v4.3.8</code>及之前版本）将在<code>.git/hooks</code>中注入所有类型的<code>hook</code>，而<code>v7</code>版本将指定<code>git hook</code>目录为<code>.husky</code></li> <li><a href="https://github.com/okonet/lint-staged" target="_blank" rel="noopener noreferrer">lint-staged<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：仅对暂存中的文件执行相应的命令，提高运行效率</li> <li><a href="https://github.com/conventional-changelog/commitlint" target="_blank" rel="noopener noreferrer">@commitlint/cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：用于检查提交说明</li> <li><a href="https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/config-conventional" target="_blank" rel="noopener noreferrer">@commitlint/config-conventional<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：提供检查提交说明的规则集</li></ul> <h2 id="常见问题"><a href="#常见问题" class="header-anchor">#</a> 常见问题</h2> <h3 id="如何关闭或跳过-eslint-校验规则"><a href="#如何关闭或跳过-eslint-校验规则" class="header-anchor">#</a> 如何关闭或跳过 eslint 校验规则？</h3> <p>  有些项目并不能很好地适用<code>eslint</code>的规则集，例如 <a href="https://eslint.vuejs.org/rules/#priority-c-recommended-minimizing-arbitrary-choices-and-cognitive-overhead-for-vue-js-2-x" target="_blank" rel="noopener noreferrer">vue/recommended<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规则集中 <a href="https://eslint.vuejs.org/rules/no-v-html.html" target="_blank" rel="noopener noreferrer">vue/no-v-html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 禁用了<code>v-html</code>指令，但是有时又不得已会使用<code>v-html</code>。</p> <p>  第一种方式可在<code>.eslintrc.js</code>中关闭此规则。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token string-property property">'vue/no-v-html'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>告警级别分为三种，<code>0/off</code>表示忽略问题，<code>1/warn</code>表示警告，<code>2/error</code>表示报错</p></blockquote> <p>  第二种方式是利用 <a href="https://eslint.vuejs.org/rules/comment-directive.html#vue-comment-directive" target="_blank" rel="noopener noreferrer">vue/comment-directive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规则，即通过注释来跳过某一行或多行的校验。</p> <p>  此规则支持的注释包括。</p> <ul><li><code>eslint-disable</code>：关闭校验</li> <li><code>eslint-enable</code>：开启校验，配合<code>eslint-disabled</code>可关闭多行校验</li> <li><code>eslint-disable-line</code>：关闭当前行校验</li> <li><code>eslint-disable-next-line</code>：关闭下一行校验</li></ul> <p>  关闭多行校验，其中<code>6</code>和<code>7</code>行的<code>v-html</code>校验已跳过。</p> <p><img src="/js/eslint-prettier/eslint-disable.png" alt=""></p> <p>  关闭当前行的校验，其中<code>32</code>行中的语句末尾分号校验已跳过。</p> <p><img src="/js/eslint-prettier/eslint-disable-line.png" alt=""></p> <p>  关闭下一行校验。</p> <p><img src="/js/eslint-prettier/eslint-disable-next-line.png" alt=""></p> <p>  注意以上注释会关闭掉所有<code>eslint</code>校验规则，建议在注释后添加禁用的规则名称，更多 <a href="https://eslint.vuejs.org/rules/comment-directive.html#vue-comment-directive" target="_blank" rel="noopener noreferrer">详细参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><img src="/js/eslint-prettier/eslint-disable-rules.png" alt=""></p> <h3 id="旧项目如何接入格式化工具"><a href="#旧项目如何接入格式化工具" class="header-anchor">#</a> 旧项目如何接入格式化工具？</h3> <p>  旧项目通常情况下源文件格式都会存在问题，但是不可能每个文件都去<code>Ctrl + S</code>手动修复格式，可在<code>package.json</code>中添加命令来修复<code>src</code>内源文件。</p> <p>  但是强烈不推荐你这么做，因为格式化可能会造成潜在的问题。如果源文件较少，且能够保证做全量测试，那么你可以这样做。但是源文件较多，建议只格式化你修改的文件，其余不相关的文件还是不要动。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token string-property property">&quot;eslint:fix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint src/**/*.js src/**/*.vue --fix&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>注意<code>eslint:fix</code>仅能修复简单的错误，其它例如组件<code>props</code>默认值的情况，还是需要你手动修复</p></blockquote> <h3 id="无法格式化的文件如何修复"><a href="#无法格式化的文件如何修复" class="header-anchor">#</a> 无法格式化的文件如何修复？</h3> <p>  部分文件保存时无法格式化，频繁闪烁。</p> <p><img src="/js/eslint-prettier/format-disable.gif" alt=""></p> <p>  此情况最好是对某个文件执行<code>eslint</code>的<code>fix</code>功能，如果文件较多，建议执行<code>npm run eslint:fix</code>命令。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npx eslint src<span class="token operator">/</span>main<span class="token punctuation">.</span>js <span class="token operator">--</span>fix
</code></pre></div><h3 id="提交时如何跳过-lint-阶段"><a href="#提交时如何跳过-lint-阶段" class="header-anchor">#</a> 提交时如何跳过 lint 阶段？</h3> <p>  如果你觉得在执行<code>git commit -m ...</code>提交时非常耗时，你可以执行以下命令来跳过<code>lint-staged</code>和<code>commitlint</code>两个阶段。</p> <p>  但是还是建议不要这样做，因为你无法保证提交到远端的代码是非常规范的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git commit <span class="token operator">-</span>m <span class="token string">'xxx'</span> <span class="token operator">--</span>no<span class="token operator">-</span>verify
</code></pre></div><h3 id="lint-staged-在-pre-commit-阶段报错"><a href="#lint-staged-在-pre-commit-阶段报错" class="header-anchor">#</a> lint-staged 在 pre-commit 阶段报错</h3> <p>  在<code>node</code>版本较低的情况下，且安装了<code>lint-staged</code>的<code>v12</code>版本（目前<code>v12.3.4</code>）。</p> <p>  ;<code>node</code>版本为<code>v12.14.1</code>时，提交时抛出以下错误。</p> <p><img src="/js/eslint-prettier/fs.png" alt=""></p> <p>  ;<code>node</code>版本为<code>v14.10.1</code>时，提交时抛出以下错误。</p> <p><img src="/js/eslint-prettier/esm.png" alt=""></p> <p>  ;<a href="https://github.com/okonet/lint-staged#migration" target="_blank" rel="noopener noreferrer">官方<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>明确了所支持的<code>node</code>版本。</p> <p><img src="/js/eslint-prettier/v12.png" alt=""></p> <p>  两种解决方式，方式一可升级<code>node</code>版本，方式二则可安装<code>lint-staged</code>的<code>v11.2.6</code>及以下版本，推荐方式二。</p> <h3 id="维护配置文件到-package-json"><a href="#维护配置文件到-package-json" class="header-anchor">#</a> 维护配置文件到 package.json</h3> <p>  诸如<code>.eslintrc.js</code>和<code>.prettierrc.js</code>等配置文件，都维护在开发目录下，显得多而复杂，另外后期此类文件都是不用修改的，还有另外一种配置方式，就是维护至<code>package.json</code>下。</p> <p>  ;<code>eslint</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:vue/recommended'</span><span class="token punctuation">,</span> <span class="token string">'plugin:prettier/recommended'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">quotes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;root&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;plugin:vue/recommended&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;plugin:prettier/recommended&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;quotes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;single&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>prettier</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .prettierrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">semi</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">printWidth</span><span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">,</span>
  <span class="token literal-property property">singleQuote</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">endOfLine</span><span class="token operator">:</span> <span class="token string">'crlf'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">arrowParens</span><span class="token operator">:</span> <span class="token string">'avoid'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;semi&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;printWidth&quot;</span><span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;singleQuote&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;endOfLine&quot;</span><span class="token operator">:</span> <span class="token string">&quot;crlf&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;arrowParens&quot;</span><span class="token operator">:</span> <span class="token string">&quot;avoid&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>husky</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .huskyrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commitlint -E HUSKY_GIT_PARAMS&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commitlint -E HUSKY_GIT_PARAMS&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>lint-staged</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .lintstagedrc.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;src/**/*.{js,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;git add&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;src/**/*.{js,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;git add&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>commitlint</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// commitlint.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;commitlint&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;@commitlint/config-conventional&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>babel</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// babel.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;babel&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;@vue/cli-plugin-babel/preset&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>browserslist</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .browserslistrc</span>
<span class="token operator">&gt;</span> <span class="token number">1</span><span class="token operator">%</span>
last <span class="token number">2</span> versions
not dead

<span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;browserslist&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;&gt; 1%&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;last 2 versions&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;not dead&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="如何配置-vue-代码片段"><a href="#如何配置-vue-代码片段" class="header-anchor">#</a> 如何配置 vue 代码片段？</h3> <p>  ;<code>vetur</code>提供了代码片段用来提高开发效率。</p> <p><img src="/js/eslint-prettier/snippet.png" alt=""></p> <h4 id="vscode-中-vue-json-文件"><a href="#vscode-中-vue-json-文件" class="header-anchor">#</a> vscode 中 vue.json 文件</h4> <p>  ;<code>vscode</code>中键入<code>Shift + Ctrl + P</code>，输入<code>snippets</code>，选择配置用户代码片段。</p> <p>  然后输入<code>vue</code>，选择<code>vue.json</code>。</p> <p><img src="/js/eslint-prettier/vue-json.png" alt=""></p> <p>  删除掉所有注释，添加以下内容。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// vue.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;Vue Component&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cpt&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;&lt;template&gt;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;  $1&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&lt;/template&gt;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&lt;script&gt;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;export default {&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;}&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&lt;/script&gt;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&lt;style&gt;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&lt;/style&gt;&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Vue 组件模板&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>vue</code>单文件内输入<code>cpt</code>，代码片段已生效。</p> <p>  此方式配置在<code>vscode</code>中，在任何项目中都能生效，但是配置起来很麻烦，<code>vue.json</code>中要一行一行添加。</p> <p><img src="/js/eslint-prettier/cpt.png" alt=""></p> <h4 id="项目级模板"><a href="#项目级模板" class="header-anchor">#</a> 项目级模板</h4> <p>  项目根目录下<code>.vscode</code>目录结构如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>├── <span class="token punctuation">.</span>vscode
│   ├── settings<span class="token punctuation">.</span>json
│   ├── vetur
│   │   ├── snippets
│   │   │   ├── template<span class="token punctuation">.</span>vue
</code></pre></div><p>  可在<code>snippets</code>文件夹下添加<code>template.vue</code>文件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vscode/vetur/snippets/template.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    $<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre></div><p>  此方式新增<code>vue</code>文件后，<code>Reload</code>重载后可生效，此方式相对<code>vue.json</code>文件，仅设置单文件即可，不需要一行一行添加。</p> <p><img src="/js/eslint-prettier/template.png" alt=""></p> <h4 id="vscode-插件目录"><a href="#vscode-插件目录" class="header-anchor">#</a> vscode 插件目录</h4> <p>  ;<code>vscode</code>键入<code>Shift + Ctrl + P</code>，输入<code>extensions folder</code>，选择打开拓展文件夹。</p> <p>  打开<code>octref.vetur-xx.xx.xx</code>目录，进入<code>server/dist/veturSnippets</code>文件夹。</p> <p><img src="/js/eslint-prettier/Vetur-dir.png" alt=""></p> <p>  添加自定义代码片段，也可复制<code>default.vue</code>然后修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// veturSnippets/page.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  $<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">''</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre></div><p>  ;<code>Reload</code>重载后生效。</p> <p><img src="/js/eslint-prettier/page.png" alt=""></p> <h2 id="🎉-写在最后"><a href="#🎉-写在最后" class="header-anchor">#</a> 🎉 写在最后</h2> <p>🍻伙伴们，如果你已经看到了这里，觉得这篇文章有帮助到你的话不妨点赞👍或 <a href="https://github.com/dongwei1125/blog" target="_blank" rel="noopener noreferrer">Star<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ✨支持一下哦！</p> <p>手动码字，如有错误，欢迎在评论区指正💬~</p> <p>你的支持就是我更新的最大动力💪~</p> <p><a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> / <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer">Gitee<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://dongwei1125.github.io/" target="_blank" rel="noopener noreferrer">GitHub Pages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer">掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer">CSDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 同步更新，欢迎关注😉~</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">5/30/2022, 10:00:14 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0aa97f73.js" defer></script><script src="/assets/js/2.f850a8ef.js" defer></script><script src="/assets/js/39.fe9ea525.js" defer></script>
  </body>
</html>
