<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue element web 表单设计工具 | DonV</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/header.jpg">
    <meta name="description" content="A paper about JavaScript, HTML and CSS.">
    
    <link rel="preload" href="/assets/css/0.styles.87611319.css" as="style"><link rel="preload" href="/assets/js/app.0aa97f73.js" as="script"><link rel="preload" href="/assets/js/2.f850a8ef.js" as="script"><link rel="preload" href="/assets/js/10.cb041c1b.js" as="script"><link rel="prefetch" href="/assets/js/11.1aadbcee.js"><link rel="prefetch" href="/assets/js/12.77cc8e56.js"><link rel="prefetch" href="/assets/js/13.7e8162d9.js"><link rel="prefetch" href="/assets/js/14.dea6ba67.js"><link rel="prefetch" href="/assets/js/15.a786d687.js"><link rel="prefetch" href="/assets/js/16.163edf25.js"><link rel="prefetch" href="/assets/js/17.3a0232cb.js"><link rel="prefetch" href="/assets/js/18.91bd2dd7.js"><link rel="prefetch" href="/assets/js/19.a36993f8.js"><link rel="prefetch" href="/assets/js/20.30dd9f79.js"><link rel="prefetch" href="/assets/js/21.5e3c83a3.js"><link rel="prefetch" href="/assets/js/22.88d5e321.js"><link rel="prefetch" href="/assets/js/23.b54a65a7.js"><link rel="prefetch" href="/assets/js/24.51df379f.js"><link rel="prefetch" href="/assets/js/25.79342bd2.js"><link rel="prefetch" href="/assets/js/26.643d5441.js"><link rel="prefetch" href="/assets/js/27.54b7d7b4.js"><link rel="prefetch" href="/assets/js/28.d01a4aee.js"><link rel="prefetch" href="/assets/js/29.7d932073.js"><link rel="prefetch" href="/assets/js/3.31ebf682.js"><link rel="prefetch" href="/assets/js/30.4c2f5636.js"><link rel="prefetch" href="/assets/js/31.b00c42d5.js"><link rel="prefetch" href="/assets/js/32.e9a0f488.js"><link rel="prefetch" href="/assets/js/33.f510b5fd.js"><link rel="prefetch" href="/assets/js/34.6e78f32f.js"><link rel="prefetch" href="/assets/js/35.04d666a2.js"><link rel="prefetch" href="/assets/js/36.900a3beb.js"><link rel="prefetch" href="/assets/js/37.19ddf8d7.js"><link rel="prefetch" href="/assets/js/38.35f899bd.js"><link rel="prefetch" href="/assets/js/39.fe9ea525.js"><link rel="prefetch" href="/assets/js/4.3c7083a8.js"><link rel="prefetch" href="/assets/js/40.0d116ce0.js"><link rel="prefetch" href="/assets/js/41.6cdce4cf.js"><link rel="prefetch" href="/assets/js/42.ab0bd0d5.js"><link rel="prefetch" href="/assets/js/43.66c8f8eb.js"><link rel="prefetch" href="/assets/js/44.ac02981e.js"><link rel="prefetch" href="/assets/js/45.479814b0.js"><link rel="prefetch" href="/assets/js/46.29956259.js"><link rel="prefetch" href="/assets/js/47.a89cf7d2.js"><link rel="prefetch" href="/assets/js/48.859e3502.js"><link rel="prefetch" href="/assets/js/49.d0fa0b25.js"><link rel="prefetch" href="/assets/js/5.206809f3.js"><link rel="prefetch" href="/assets/js/50.d051084c.js"><link rel="prefetch" href="/assets/js/51.fa831e6a.js"><link rel="prefetch" href="/assets/js/52.3ed98760.js"><link rel="prefetch" href="/assets/js/53.016b1c3c.js"><link rel="prefetch" href="/assets/js/54.c88e06c5.js"><link rel="prefetch" href="/assets/js/55.937bfe09.js"><link rel="prefetch" href="/assets/js/56.03003660.js"><link rel="prefetch" href="/assets/js/57.8bcda68a.js"><link rel="prefetch" href="/assets/js/58.286692ba.js"><link rel="prefetch" href="/assets/js/59.fbfe98aa.js"><link rel="prefetch" href="/assets/js/6.6f9d9bda.js"><link rel="prefetch" href="/assets/js/60.0975844e.js"><link rel="prefetch" href="/assets/js/61.0af6cf48.js"><link rel="prefetch" href="/assets/js/62.66c23699.js"><link rel="prefetch" href="/assets/js/63.7fda9b3f.js"><link rel="prefetch" href="/assets/js/7.6f64fba1.js"><link rel="prefetch" href="/assets/js/8.a163349f.js"><link rel="prefetch" href="/assets/js/9.9058d3cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87611319.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header.jpg" alt="DonV" class="logo"> <span class="site-name can-hide">DonV</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  其它
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  应用
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/js/nav.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/pages/html/nav.html" class="nav-link">
  HTML
</a></div><div class="nav-item"><a href="/pages/css/nav.html" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/pages/other/nav.html" class="nav-link">
  其它
</a></div><div class="nav-item"><a href="/pages/app/nav.html" class="nav-link">
  应用
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/~dongwei1125" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NPM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue element web 表单设计工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/app/form-making.html#工具概述" class="sidebar-link">工具概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#项目预览" class="sidebar-link">项目预览</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#示意图" class="sidebar-link">示意图</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#文件目录配置" class="sidebar-link">文件目录配置</a></li></ul></li><li><a href="/pages/app/form-making.html#初始化" class="sidebar-link">初始化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#脚手架初始化" class="sidebar-link">脚手架初始化</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#页面布局" class="sidebar-link">页面布局</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#vuedraggable-拖动与-transition-group" class="sidebar-link">vuedraggable 拖动与 transition-group</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#elements-元素参数和-vuex" class="sidebar-link">Elements 元素参数和 vuex</a></li></ul></li><li><a href="/pages/app/form-making.html#表单元素操作" class="sidebar-link">表单元素操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#全局表单配置" class="sidebar-link">全局表单配置</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#动态组件" class="sidebar-link">动态组件</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#公共字段属性和公共视图" class="sidebar-link">公共字段属性和公共视图</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#元素拷贝、删除和伪元素" class="sidebar-link">元素拷贝、删除和伪元素</a></li></ul></li><li><a href="/pages/app/form-making.html#elementcate-组件" class="sidebar-link">ElementCate 组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#单行文本" class="sidebar-link">单行文本</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#多行文本" class="sidebar-link">多行文本</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#计数器" class="sidebar-link">计数器</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#单选框组" class="sidebar-link">单选框组</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#多选框组" class="sidebar-link">多选框组</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#时间选择器" class="sidebar-link">时间选择器</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#日期选择器" class="sidebar-link">日期选择器</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#评分" class="sidebar-link">评分</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#颜色选择器" class="sidebar-link">颜色选择器</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#下拉选择器" class="sidebar-link">下拉选择器</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#开关" class="sidebar-link">开关</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#滑块" class="sidebar-link">滑块</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#文字" class="sidebar-link">文字</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#html" class="sidebar-link">html</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#级联选择器" class="sidebar-link">级联选择器</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#分割线" class="sidebar-link">分割线</a></li></ul></li><li><a href="/pages/app/form-making.html#栅格布局" class="sidebar-link">栅格布局</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/app/form-making.html#dialog-公共对话框和-aceeditor" class="sidebar-link">Dialog 公共对话框和 AceEditor</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/app/form-making.html#tinymce-富文本编辑器" class="sidebar-link">Tinymce 富文本编辑器</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/app/form-making.html#blank-自定义区域" class="sidebar-link">blank 自定义区域</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/app/form-making.html#表单功能" class="sidebar-link">表单功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#重置" class="sidebar-link">重置</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#校验规则" class="sidebar-link">校验规则</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#生成代码" class="sidebar-link">生成代码</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#html-默认值" class="sidebar-link">HTML 默认值</a></li></ul></li><li><a href="/pages/app/form-making.html#发布维护" class="sidebar-link">发布维护</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#npm-组件" class="sidebar-link">NPM 组件</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#git-远程库维护" class="sidebar-link">Git 远程库维护</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#在线预览" class="sidebar-link">在线预览</a></li></ul></li><li><a href="/pages/app/form-making.html#后记" class="sidebar-link">后记</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/app/form-making.html#更新日志" class="sidebar-link">更新日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#_2020-12-11-17-18" class="sidebar-link">2020/12/11 17:18</a></li><li class="sidebar-sub-header"><a href="/pages/app/form-making.html#_2022-03-05-17-35" class="sidebar-link">2022/03/05 17:35</a></li></ul></li><li><a href="/pages/app/form-making.html#🎉-写在最后" class="sidebar-link">🎉 写在最后</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-element-web-表单设计工具"><a href="#vue-element-web-表单设计工具" class="header-anchor">#</a> vue element web 表单设计工具</h1> <p><img src="/app/form-making/banner.jpg" alt=""></p> <h2 id="工具概述"><a href="#工具概述" class="header-anchor">#</a> 工具概述</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>  项目名 <a href="https://github.com/dongwei1125/dw-form-making" target="_blank" rel="noopener noreferrer">dw-form-making<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，基于 <a href="https://element.eleme.cn/#/zh-CN" target="_blank" rel="noopener noreferrer">element-ui<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 组件库的<code>Web</code>端表单设计工具。</p> <p>  项目技术栈<code>vue</code>、<code>vue-cli3</code>，可视化设计<code>element-ui</code>输入框、选择器、单选框等控件组成的<code>Form</code>表单，配置表单字段、标签、校验规则等。</p> <p>  较早版本采用<code>vuex</code>，由于发布<code>npm</code>包以及项目对<code>vuex</code>依赖性较高（即<code>npm</code>安装后还需配置<code>vuex</code>）等原因，故此种方案抛弃。使用<code>vue.observable</code>实现<code>vuex</code>的<code>state</code>、<code>mutations</code>部分。</p> <p>  项目第三方组件包括<code>vuedraggable</code>拖拽组件、<code>tinymce</code>富文本编辑器、<code>clipboard</code>复制插件、<code>lodash</code>函数库、<code>ace</code>代码编辑器等，其中<code>element-ui</code>未包含在<code>npm</code>发布包内，最大程度减小项目体积，避免二次引入。</p> <p>  项目样式参考 <a href="http://docs.form.making.link/" target="_blank" rel="noopener noreferrer">vue-form-making<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 基础版本，表单组件未采用<code>v-if</code>判断方式渲染，原因一是表单组件较多，几乎全是<code>v-if</code>，容易造成代码冗余阅读性差，二是栅格布局采用组件递归，此种方式页面渲染性能差，每次递归页面<code>v-if</code>重复数次，故抛弃此种方式，采用动态组件方式渲染表单，不仅可读性高性能也好。</p> <p>  由于经常使用<code>vue-form-making</code>，而后对其实现方式较为感兴趣，故在参考原样式基础上，项目<code>js</code>部分完全脱离<code>vue-form-making</code>方式，从零开始重构<code>vue-form-making</code>基础版本代码。</p> <p>  项目可熟练巩固使用<code>element-ui</code>表单组件和部分<code>Dialog</code>对话框、<code>Message</code>消息提示、<code>Container</code>布局容器等。涉及递归组件内作用域插槽、组件循环引用处理、<code>Git</code>多远程库维护、<code>npm</code>包发布。</p> <h3 id="项目预览"><a href="#项目预览" class="header-anchor">#</a> 项目预览</h3> <p>  ;<a href="http://dongwei1125.github.io/dw-form-making/" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> / <a href="http://dongwei1125.gitee.io/dw-form-making/" target="_blank" rel="noopener noreferrer">Gitee<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="示意图"><a href="#示意图" class="header-anchor">#</a> 示意图</h3> <p><img src="/app/form-making/example.gif" alt=""></p> <h3 id="文件目录配置"><a href="#文件目录配置" class="header-anchor">#</a> 文件目录配置</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>├── dist
├── docs
├── lib
├── <span class="token keyword">public</span>
├── src
│   ├── assets
│   │   ├── fonts
│   │   ├── images
│   │   ├── js
│   ├── components
│   │   ├── ButtonView
│   │   │   ├── GenerateForm<span class="token punctuation">.</span>vue
│   │   │   ├── ViewForm<span class="token punctuation">.</span>vue
│   │   │   ├── Widget<span class="token punctuation">.</span>vue
│   │   ├── ConfigOption
│   │   │   ├── FieldProperty<span class="token punctuation">.</span>vue
│   │   │   ├── FormProperty<span class="token punctuation">.</span>vue
│   │   ├── AceEditor<span class="token punctuation">.</span>vue
│   │   ├── PublicDialog<span class="token punctuation">.</span>vue
│   ├── elements
│   │   ├── input
│   │   │   ├── config<span class="token punctuation">.</span>vue
│   │   │   ├── view<span class="token punctuation">.</span>vue
│   │   ├── radio
│   │   │   ├── config<span class="token punctuation">.</span>vue
│   │   │   ├── view<span class="token punctuation">.</span>vue
│   │   ├── <span class="token operator">...</span>
│   │   ├── CommonField<span class="token punctuation">.</span>vue
│   │   ├── CommonView<span class="token punctuation">.</span>vue
│   │   ├── config<span class="token punctuation">.</span>js
│   │   ├── index<span class="token punctuation">.</span>js
│   │   ├── view<span class="token punctuation">.</span>js
│   ├── layout
│   │   ├── index<span class="token punctuation">.</span>vue
│   │   ├── components
│   │   │   ├── ButtonView<span class="token punctuation">.</span>vue
│   │   │   ├── ConfigOption<span class="token punctuation">.</span>vue
│   │   │   ├── ElementCate<span class="token punctuation">.</span>vue
│   │   │   ├── LinkHeader<span class="token punctuation">.</span>vue
│   ├── store
│   │   ├── index<span class="token punctuation">.</span>js
│   │   ├── vuex<span class="token punctuation">.</span>js
│   ├── styles
│   │   ├── index<span class="token punctuation">.</span>scss
│   │   ├── layout<span class="token punctuation">.</span>scss
│   ├── utils
│   │   ├── index<span class="token punctuation">.</span>js
│   │   ├── format<span class="token punctuation">.</span>js
│   │   ├── vue<span class="token operator">-</span>component<span class="token punctuation">.</span>js
│   ├── App<span class="token punctuation">.</span>vue
│   ├── main<span class="token punctuation">.</span>js
│   ├── index<span class="token punctuation">.</span>js
│   ├── <span class="token keyword">package</span><span class="token punctuation">.</span>json
│   ├── <span class="token constant">README</span><span class="token punctuation">.</span>md
│   ├── vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js
</code></pre></div><h2 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h2> <h3 id="脚手架初始化"><a href="#脚手架初始化" class="header-anchor">#</a> 脚手架初始化</h3> <p>  初始空脚手架<code>vue-cli3</code>仅配置<code>Babel</code>、<code>CSS Pre-processors</code>（<code>scss</code>），删除其余业务不相关部分，文件夹部分根据需求逐步创建。</p> <p>  项目核心组件库<code>element-ui</code>，由于整个项目完全依赖<code>element-ui</code>，所以可以直接全局引入。但是<code>npm</code>包发布不引入，最大程度减小项目体积，具体后续还会提到。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i element<span class="token operator">-</span>ui <span class="token operator">-</span><span class="token constant">S</span>

<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>
</code></pre></div><p>  其次项目核心拖拽业务组件 <a href="https://github.com/SortableJS/Vue.Draggable" target="_blank" rel="noopener noreferrer">vuedraggable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，拖拽页面部分引入即可，不用全局引入。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i <span class="token operator">-</span><span class="token constant">S</span> vuedraggable

<span class="token keyword">import</span> draggable <span class="token keyword">from</span> <span class="token string">'vuedraggable'</span>
<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    draggable<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre></div><p>  初始化样式使用 <a href="https://github.com/necolas/normalize.css" target="_blank" rel="noopener noreferrer">normalize.css<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，项目定制样式初始化<code>styles</code>下<code>index.scss</code>，其余布局相关、组件相关样式统一放在<code>layout.scss</code>。</p> <h3 id="页面布局"><a href="#页面布局" class="header-anchor">#</a> 页面布局</h3> <p>  其中<code>ButtonView</code>视图区域<code>components</code>维护组件<code>GenerateForm.vue</code>、<code>ViewForm.vue</code>、<code>Widget.vue</code>，<code>ConfigOption</code>配置参数维护组件<code>FieldProperty.vue</code>字段属性、<code>FormProperty.vue</code>表单属性。</p> <p><img src="/app/form-making/layout.png" alt=""></p> <p>  项目基本布局确定完毕，开始实现具体结构。创建<code>layout</code>文件夹，维护整个页面布局相关部分，<code>App.vue</code>中只做<code>layout</code>的引入，这样后期<code>App.vue</code>基本不作改动，同时最为关键的是，最终发布为<code>npm</code>包时，整个<code>layout</code>注册为组件，方便引入。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// App.vue</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Layout <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token keyword">import</span> Layout <span class="token keyword">from</span> <span class="token string">'./layout/index'</span>
<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    Layout<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>

<span class="token comment">// index.js</span>
<span class="token keyword">import</span> MakingForm <span class="token keyword">from</span> <span class="token string">'./layout/index'</span>
<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  MakingForm
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>layout</code> <code>index.vue</code>作为组件导出，其中<code>layout</code>内部使用<code>element-ui</code> <code>container</code>布局容器，四个页面主要区域放在同级<code>components</code>文件夹下，底部<code>Powered by</code>代码较少，不用再作抽离。四个主要区域设置类名，<code>ElementCate</code>固定宽度<code>250px</code>，<code>ConfigOption</code>固定宽度<code>300px</code>，<code>ButtonView</code>最小宽度<code>440px</code>，防止屏幕宽度较小样式错乱。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>el<span class="token operator">-</span>container <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dw-form-making-container&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>header <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dw-form-making-header&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>link<span class="token operator">-</span>header <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>header<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>el<span class="token operator">-</span>container <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dw-form-making-body&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>aside <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dw-form-making-elementcate&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;250px&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>element<span class="token operator">-</span>cate <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>aside<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>el<span class="token operator">-</span>main <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dw-form-making-buttonview&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button<span class="token operator">-</span>view <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>main<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>el<span class="token operator">-</span>aside <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dw-form-making-configoption&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;300px&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>config<span class="token operator">-</span>option <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>aside<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>container<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>el<span class="token operator">-</span>footer <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dw-form-making-footer&quot;</span><span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>footer<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>container<span class="token operator">&gt;</span>
</code></pre></div><p>  ;<code>ElementCate</code>部分首先考虑各个元素数据和图标，暂不考虑元素的其他情况（配置信息等），<a href="https://www.iconfont.cn/" target="_blank" rel="noopener noreferrer">iconfont<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 创建个人项目，选择合适的图标，下载本地压缩包解压导入，注意<code>iconfont.css</code>导入路径前加上<code>~</code>符号，从<code>vue.config.js</code>中<code>alias</code>查询相关路径加载模块，不添加<code>~</code>默认为当前目录下路径。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>@<span class="token keyword">import</span> <span class="token string">'~assets/fonts/iconfont.css'</span><span class="token punctuation">;</span>
</code></pre></div><p>  ;<code>ElementCate.vue</code>中引入三个不同类别的表单组件，假设某个<code>js</code>文件（<code>elements</code>文件夹内<code>index.js</code>）对外导出三个数组，分别为<code>basic</code>、<code>advance</code>、<code>layout</code>，且每个数组对象暂时包含<code>name</code>标签、<code>icon</code>图标。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// element -&gt; index.js</span>
<span class="token keyword">const</span> basic <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token operator">...</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'单行文本'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'icon-input'</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> advance <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">const</span> layout <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  basic<span class="token punctuation">,</span>
  advance<span class="token punctuation">,</span>
  layout<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>ElementCate.vue</code>引入三个数组，暂时使用<code>ul</code> <code>li</code>渲染出来，<code>li</code>设置为块级再指定宽度<code>48%</code>，其中图标和组件名均对齐中线，同时设置表单组件悬浮的样式。</p> <p>  ;<code>ButtonView</code>按钮视图区域分为上下两部分，按钮区域和视图区域，按钮区域暂时放置对应按钮，事件后续接入逻辑详细处理，视图区域抽离为组件<code>ViewForm.vue</code>，现在暂时放置一个<code>div</code>盒子。</p> <p>  ;<code>ConfigOption</code>配置参数区域分为字段属性、表单属性，实现最基本的<code>Tabs</code>切换即可。</p> <h3 id="vuedraggable-拖动与-transition-group"><a href="#vuedraggable-拖动与-transition-group" class="header-anchor">#</a> vuedraggable 拖动与 transition-group</h3> <p>  ;<a href="https://github.com/SortableJS/Vue.Draggable" target="_blank" rel="noopener noreferrer">vuedraggable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 官方文档提供了<code>vuedraggable</code>与<code>transition-group</code>配合使用的示例方法，这里详细说明项目元素分类和视图表单区域的配置参数。</p> <ul><li><code>tag</code>: <code>draggable</code>渲染后的标签名</li> <li><code>value</code>: 和内部元素<code>v-for</code>指令引用相同的数组，不应该直接使用，可通过<code>v-model</code></li> <li><code>group.name</code>: 同分组名可相互拖动，不同<code>draggable</code>列表也可以</li> <li><code>group.pull</code>: 拖动至其他分组克隆或复制，而非直接取出再移动</li> <li><code>group.put</code>: 其他组别拖动至当前分组是否放入</li> <li><code>sort</code>: 同分组拖动后不排序</li> <li><code>animation</code>: 单位<code>ms</code>，与<code>transition-group</code>产生过渡效果</li> <li><code>ghostClass</code>: 被拖动元素<code>class</code>类名</li> <li><code>handle</code>: 拖动列表元素上指定类名部分（拖动小图标）才能进行拖动</li> <li><code>clone</code>: 克隆事件，声明使用<code>:</code>，处理克隆后的元素</li> <li><code>add</code>: 添加事件，其他分组拖动至当前分组，处理添加前的元素</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ElementCate.vue</span>
<span class="token operator">&lt;</span>draggable
  v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;list&quot;</span>
  tag<span class="token operator">=</span><span class="token string">&quot;ul&quot;</span>
  v<span class="token operator">-</span>bind<span class="token operator">=</span>&quot;<span class="token punctuation">{</span>
    <span class="token literal-property property">group</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'view'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">pull</span><span class="token operator">:</span> <span class="token string">'clone'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">put</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>&quot;
  <span class="token operator">:</span>clone<span class="token operator">=</span><span class="token string">&quot;handleClone&quot;</span>
<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>draggable<span class="token operator">&gt;</span>

<span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>draggable
  v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;list&quot;</span>
  v<span class="token operator">-</span>bind<span class="token operator">=</span>&quot;<span class="token punctuation">{</span>
    <span class="token literal-property property">group</span><span class="token operator">:</span> <span class="token string">'view'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">animation</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ghostClass</span><span class="token operator">:</span> <span class="token string">'move'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">handle</span><span class="token operator">:</span> <span class="token string">'.drag-icon'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>&quot;
  @add<span class="token operator">=</span><span class="token string">&quot;handleAdd&quot;</span>
<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>draggable<span class="token operator">&gt;</span>
</code></pre></div><p>  ;<code>ElementCate</code>部分根据上述配置，引入分类列表<code>basic</code>、<code>advance</code>、<code>layout</code>，注册<code>Draggable</code>组件，其中分类列表长度若为<code>0</code>，对应列表标题也不显示，不用外层添加<code>DOM</code>元素，使用<code>template</code>配合<code>v-if</code>使用。<code>clone</code>函数拖动时触发，参数为拷贝的元素对象，暂时打印，返回拷贝的对象。</p> <p>  视图表单部分使用<code>absolute</code>绝对定位使高度为整个下半部分区域，<code>draggable</code>覆盖区域高度不够不会产生拖动且内部绑定的<code>list</code>暂时为<code>data</code>内变量。<code>add</code>函数参数解构<code>newIndex</code>（列表内索引），通过索引可获取拖入后的元素。控制台查看视图表单内列表，当元素拖入（鼠标不松开），元素类名为<code>element-cate-item</code> <code>move</code>，鼠标松开渲染为视图表单列表元素，<code>layout.scss</code>设置拖入样式。由于视图表单也存在元素的拖动情况，故样式声明为变量，使用时引入。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>@mixin form<span class="token operator">-</span>item<span class="token operator">-</span>move <span class="token punctuation">{</span>
  outline<span class="token operator">-</span>width<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token literal-property property">height</span><span class="token operator">:</span> 3px<span class="token punctuation">;</span>
  <span class="token literal-property property">overflow</span><span class="token operator">:</span> hidden<span class="token punctuation">;</span>
  <span class="token literal-property property">border</span><span class="token operator">:</span> 2px solid #409eff<span class="token punctuation">;</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>element<span class="token operator">-</span>cate<span class="token operator">-</span>item <span class="token punctuation">{</span>
  <span class="token operator">&amp;</span><span class="token punctuation">.</span>move <span class="token punctuation">{</span>
    @include form<span class="token operator">-</span>item<span class="token operator">-</span>move<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>FormProperty</code>可配置按钮视图中对齐方式、宽度、组件尺寸等，故将按钮视图中<code>draggable</code>放入<code>el-form</code>组件内，每一个列表元素渲染为<code>el-form-item</code>，<code>el-form</code>配置固定，<code>el-form-item</code>暂时渲染<code>label</code>和输入框。注意<code>transition-group</code>内部元素必须设置<code>key</code>值，否则元素无法渲染并且控制台会打印警告。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>el<span class="token operator">-</span>form size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;100px&quot;</span> label<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;right&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>draggable <span class="token operator">...</span> @add<span class="token operator">=</span><span class="token string">&quot;handleAdd&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in data&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;view-form-item&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;element.name&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>el<span class="token operator">-</span>input <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>draggable<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token function">handleAdd</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> newIndex <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>select <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>ElementCate</code>元素拖入<code>ViewForm</code>可以看见蓝色长条，鼠标松开渲染为输入框和标签，设置<code>view-form-item</code>样式和<code>hover</code>样式，边框色同<code>ElementCate</code>元素一致。当点击<code>view-form-item</code>时，<code>data</code>中变量<code>select</code>保存点击的<code>view-form-item</code>，判断显示出蓝色边框和拖动图标。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>div <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;['view-form-item', { active: select.key === element.key }]&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;handleSelect(element)&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">...</span><span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
  <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;select.key === element.key&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item-drag&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont icon-drag drag-icon&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token function">handleSelect</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>select <span class="token operator">=</span> element
<span class="token punctuation">}</span>
</code></pre></div><p>  首先要明确的是，分类元素中<code>clone</code>事件返回的对象就是视图表单放入的对象，故可以在<code>clone</code>回调时添加<code>key</code>属性或者表单视图<code>add</code>事件内<code>newIndex</code>获取元素添加<code>key</code>属性。但是两种方式有明显差异，前者鼠标拖动<code>clone</code>返回对象并添加<code>key</code>值，鼠标松开<code>add</code>活动元素<code>select</code>设为当前元素（拖入的元素高亮），后者鼠标拖动<code>clone</code>返回对象，鼠标松开<code>add</code>添加<code>key</code>后再设置活动元素。虽然实现效果并无差异，但是后者一个函数做了两件事（添加<code>key</code>、高亮），不符合单一职责原则<code>SRP</code>。</p> <p>  ;<code>key</code>值使用<code>4</code>位随机字符串和时间戳方式。<code>clone</code>函数参数为拖动元素引用，故返回对象时要另拷贝，对象拷贝使用 <a href="https://www.lodashjs.com/" target="_blank" rel="noopener noreferrer">lodash<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.deepClone，也可以使用<code>JSON</code>深拷贝，但是<code>JSON.stringify</code>序列化时会丢失掉函数等类型，不推荐使用。<code>utils</code>工具类下暴露出<code>uuid</code>、<code>deepClone</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ElementCate.vue</span>
<span class="token function">handleClone</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">deepClone</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// utils -&gt; index.js</span>
<span class="token keyword">import</span> lodash <span class="token keyword">from</span> <span class="token string">'lodash'</span>

<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> lodash<span class="token punctuation">.</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token constant">S4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x10000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token constant">S4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  uuid<span class="token punctuation">,</span>
  deepClone
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="elements-元素参数和-vuex"><a href="#elements-元素参数和-vuex" class="header-anchor">#</a> Elements 元素参数和 vuex</h3> <p>  上述部分已基本实现元素拖动和单击高亮，但是<code>view-form-item</code>还渲染为输入框，若<code>ElementCate</code>元素有配置参数，可根据不同配置渲染不同表单元素，暂时采用<code>v-if</code>方式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; index.js</span>
<span class="token keyword">const</span> basic <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'单行文本'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'icon-input'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'input'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'多行文本'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'icon-textarea'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'textarea'</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">]</span>

<span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">'element.name'</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">'element.type === &quot;input&quot;'</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input type<span class="token operator">=</span><span class="token string">'textarea'</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">'element.type === &quot;textarea&quot;'</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
</code></pre></div><p>  ;<code>ElementCate</code>元素拖入，高亮同时字段属性能配置不同参数，但是字段属性与视图表单没有关联，<code>vue-form-making</code>基础版本内部采用组件传值，活动元素<code>select</code>传递到顶层<code>layout</code>再发送至<code>FieldProperty.vue</code>，首先组件层级较深且代码可读性差，优化组件层级，组件树结构又不合理，很难兼备。若存在全局状态管理，解决方式就很灵活，同时也不影响组件层级和结构。</p> <p>  ;<code>vuex</code>的确能很好地解决上述问题，但是项目对<code>vuex</code>依赖性不高并且项目不大，仅仅使用<code>state</code>状态管理显得多余。而<code>vue.observable</code>方式不仅可以实现部分<code>vuex</code>功能，项目也会显得轻量。视图表单内<code>select</code>活动元素<code>state</code>下维护，视图表单内<code>computed</code>引入，元素拖入和单击时调用<code>mutations</code>设置活动元素。<code>FieldProperty.vue</code>同理引入<code>select</code>，暂时可配置元素标签名。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// store -&gt; index.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">select</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mutations</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">SET_SELECT</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> select</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>select <span class="token operator">===</span> select<span class="token punctuation">)</span> <span class="token keyword">return</span>
      state<span class="token punctuation">.</span>select <span class="token operator">=</span> select
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ViewForm.vue</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'store/index.js'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>select
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleSelect</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_SELECT'</span><span class="token punctuation">,</span> element<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">handleAdd</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> newIndex <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_SELECT'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// FieldProperty.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> label<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;top&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;标签&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.name&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>select
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  若单行文本含<code>placeholder</code>，多行文本不含<code>placeholder</code>，<code>FieldProperty.vue</code>内渲染配置项就会不一样，也采用<code>v-if</code>方式。<code>placeholder</code>与<code>name</code>标签不同，属于元素具体配置，放在<code>options</code>下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; index.js</span>
<span class="token keyword">const</span> basic <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'单行文本'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'icon-input'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token literal-property property">placeholder</span><span class="token operator">:</span><span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'多行文本'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'icon-textarea'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'textarea'</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">]</span>

<span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;element.name&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;element.type === 'input'&quot;</span> <span class="token operator">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;element.options.placeholder&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;element.type === 'textarea'&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;textarea&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>

<span class="token comment">// FieldProperty.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> label<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;top&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;标签&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.name&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;data.type === 'input'&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;占位内容&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.options.placeholder&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
</code></pre></div><h2 id="表单元素操作"><a href="#表单元素操作" class="header-anchor">#</a> 表单元素操作</h2> <h3 id="全局表单配置"><a href="#全局表单配置" class="header-anchor">#</a> 全局表单配置</h3> <p>  其实表单也是一个全局变量，包含表单配置（对齐方式、宽度、组件尺寸等）和内部元素。<code>ViewForm.vue</code>内部<code>data</code>维护至<code>store</code>，对表单和活动元素的操作，基本都在<code>mutations</code>内部。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// store -&gt; index.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">select</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">config</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">labelWidth</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
        <span class="token literal-property property">labelPosition</span><span class="token operator">:</span> <span class="token string">'right'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token string">'small'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">customClass</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form
  <span class="token operator">:</span>size<span class="token operator">=</span><span class="token string">&quot;data.config.size&quot;</span>
  <span class="token operator">:</span>label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;data.config.labelWidth + 'px'&quot;</span>
  <span class="token operator">:</span>label<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;data.config.labelPosition&quot;</span>
<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>data
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// FormProperty.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form label<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;top&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;标签对齐方式&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>radio<span class="token operator">-</span>group v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.labelPosition&quot;</span><span class="token operator">&gt;</span> <span class="token operator">...</span> <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>radio<span class="token operator">-</span>group<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">.</span>config
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="动态组件"><a href="#动态组件" class="header-anchor">#</a> 动态组件</h3> <p>  目前元素可拖动至视图表单，同时配置标签等，表单也可全局配置。但是按钮视图的元素还很单一，逐渐完善后数量多达<code>20</code>个左右，若输入框等组件仅仅通过<code>v-if</code>判断渲染，首先全篇几乎是<code>v-if</code>全等判断，阅读性非常差，其次每渲染一个组件就会经过<code>20</code>次的<code>v-if</code>，视图表单引入栅格后，栅格每嵌套一级，<code>v-if</code>重复<code>20</code>次，表单一旦栅格层级较深、元素较多，渲染性能会非常差，再者后期自定义添加表单组件，每添加一个组件，调整代码的地方会非常多，维护非常困难。参考 <a href="https://github.com/GavinZhuLei/vue-form-making/blob/master/src/components/WidgetConfig.vue" target="_blank" rel="noopener noreferrer">vue-form-making<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 基础版本，高级版可能已重构，而且性能很好。表单配置也同理，全篇<code>v-if</code>不是最终解决办法，动态组件将会很好解决这个问题。</p> <p>  ;<code>ElementCate</code>每一个元素都对应一个表单组件、表单配置组件，根据<code>ElementCate</code>的组件名动态渲染，代码量会大大精简，只是视图表单初始化、字段属性初始化需要引入多个组件，需要用到<code>require.context</code>自动化导入模块，避免重复代码和手动导入。</p> <p>  ;<code>elements</code>放置表单组件，<code>ElementCate</code>若添加组件，<code>element</code>下新增组件即可，不用去考虑视图表单内部的渲染。<code>index.js</code>配置<code>ElementCate</code>元素，<code>view.js</code>和<code>config.js</code>自动化导入<code>config.vue</code>并注册组件。</p> <p>  添加单行文本组件，<code>elements</code>下新建<code>input</code>，创建<code>config.vue</code>和<code>view.vue</code>，必须配置组件名。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements 组件目录</span>
│   ├── elements
│   │   ├── input
│   │   │   ├── config<span class="token punctuation">.</span>vue
│   │   │   ├── view<span class="token punctuation">.</span>vue
│   │   ├── <span class="token operator">...</span>
│   │   ├── config<span class="token punctuation">.</span>js
│   │   ├── index<span class="token punctuation">.</span>js
│   │   ├── view<span class="token punctuation">.</span>js

<span class="token comment">// index.js</span>
<span class="token keyword">const</span> basic <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'单行文本'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'icon-input'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> <span class="token string">'DwInput'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">placeholder</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment">// view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">...</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input <span class="token operator">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;element.options.placeholder&quot;</span> <span class="token operator">...</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'DwInput'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">element</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Object<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token comment">// config.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> label<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;top&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;标签&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.name&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'DwInputConfig'</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>view.js</code>动态导入<code>elements</code>下所有<code>view.vue</code>文件，对外导出为组件列表，<code>config.js</code>同理。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// view.js</span>
<span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> requireComponent <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'elements/'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(view.vue)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>

requireComponent<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fileName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> componentOptions <span class="token operator">=</span> <span class="token function">requireComponent</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
  <span class="token keyword">const</span> component <span class="token operator">=</span> componentOptions<span class="token punctuation">.</span>default <span class="token operator">||</span> componentOptions

  components<span class="token punctuation">[</span>component<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> component
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> components

<span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;element in data.list&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;view-form-item&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>component <span class="token operator">:</span>is<span class="token operator">=</span><span class="token string">'item.component'</span> <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">'element'</span><span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;select.key === element.key&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item-drag&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont icon-drag drag-icon&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token keyword">import</span> Draggable <span class="token keyword">from</span> <span class="token string">'vuedraggable'</span>
<span class="token keyword">import</span> components <span class="token keyword">from</span> <span class="token string">'elements/view'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    Draggable<span class="token punctuation">,</span>
    <span class="token operator">...</span>components<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// FormProperty.vue</span>
<span class="token operator">&lt;</span>component <span class="token operator">:</span>is<span class="token operator">=</span><span class="token string">&quot;component.component &amp;&amp; `${component.component}Config`&quot;</span> <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;component&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token keyword">import</span> components <span class="token keyword">from</span> <span class="token string">'elements/config'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>select
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="公共字段属性和公共视图"><a href="#公共字段属性和公共视图" class="header-anchor">#</a> 公共字段属性和公共视图</h3> <p>  通用字段属性包括字段标识<code>model</code>、标签<code>name</code>、标签宽度（<code>isLabelWidth</code>、<code>labelWidth</code>）、隐藏标签<code>hideLabel</code>、自定义<code>Class</code> <code>customClass</code>五个属性，字段标识即字段名，默认生成的字段标识为元素<code>type</code>加<code>key</code>值，字段标识<code>model</code>随<code>key</code>值一起生成。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ElementCate</span>
<span class="token function">handleClone</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">deepClone</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">,</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> element<span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> key<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>  五个属性封装为公共组件<code>CommonField.vue</code>，放置插槽，组件<code>config.vue</code>引用，组件独有配置插入插槽即可。要注意的是，组件传值是单向的，但是<code>CommonField.vue</code>内部却能修改传入的值，原因是组件传引用类型的值实际传递的是引用地址，所以组件内部修改外部依然同步。组件传值不仅可以使用<code>sync</code>实现双向传值，也可传递引用类型实现组件双向传值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>common<span class="token operator">-</span>field <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;data&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;custom&quot;</span><span class="token operator">&gt;</span> <span class="token operator">...</span> <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>common<span class="token operator">-</span>field<span class="token operator">&gt;</span>

<span class="token keyword">import</span> CommonField <span class="token keyword">from</span> <span class="token string">'../CommonField'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    CommonField<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  公共组件<code>CommonField.vue</code>与<code>CommonField.vue</code>同步，<code>el-form-item</code>插槽<code>label</code>和<code>label-width</code>显隐标签，<code>el-form-item</code>添加<code>class</code>自定义<code>customClass</code>，<code>isLabelWidth</code>控制标签宽度，标签不显示，宽度为<code>0</code>，标签显示且自定义宽度，宽度为自定义值，标签显示但不自定义宽度，宽度为表单标签宽度。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item
  <span class="token operator">:</span>label<span class="token operator">-</span>width<span class="token operator">=</span>&quot;
    element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>hideLabel
      <span class="token operator">?</span> <span class="token string">'0px'</span>
      <span class="token operator">:</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isLabelWidth <span class="token operator">?</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>labelWidth <span class="token operator">:</span> config<span class="token punctuation">.</span>labelWidth<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'px'</span>
  &quot;
  <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;element.options.customClass&quot;</span>
<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;!element.options.hideLabel&quot;</span> slot<span class="token operator">=</span><span class="token string">&quot;label&quot;</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span> element<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
</code></pre></div><h3 id="元素拷贝、删除和伪元素"><a href="#元素拷贝、删除和伪元素" class="header-anchor">#</a> 元素拷贝、删除和伪元素</h3> <p>  ;<code>ViewForm</code>内元素的字段标识<code>model</code>可创建<code>div</code>盒子定位或者运用<code>css</code>伪元素实现。</p> <p>  ;<code>view-form-item</code>自定义属性<code>data-model</code>，<code>css</code>伪元素<code>content</code>内部<code>attr</code>函数获取。<code>ViewForm</code>表单元素禁止输入，同理可定位<code>div</code>盒子或者<code>css</code>伪元素，伪元素绝对定位四个参数都设为<code>0</code>且父元素相对定位，可实现宽高等于父元素。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;element in data.list&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;view-form-item&quot;</span> <span class="token operator">:</span>data<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;element.model&quot;</span><span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// layout.scss</span>
<span class="token punctuation">.</span>view<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token punctuation">{</span>
  <span class="token literal-property property">position</span><span class="token operator">:</span> relative<span class="token punctuation">;</span>
  <span class="token operator">...</span>
  <span class="token operator">&amp;</span><span class="token operator">:</span><span class="token operator">:</span>before <span class="token punctuation">{</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token function">attr</span><span class="token punctuation">(</span>data<span class="token operator">-</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> absolute<span class="token punctuation">;</span>
    <span class="token literal-property property">top</span><span class="token operator">:</span> 3px<span class="token punctuation">;</span>
    <span class="token literal-property property">right</span><span class="token operator">:</span> 3px<span class="token punctuation">;</span>
    font<span class="token operator">-</span>size<span class="token operator">:</span> 12px<span class="token punctuation">;</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
    font<span class="token operator">-</span>weight<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token operator">&amp;</span><span class="token operator">:</span><span class="token operator">:</span>after <span class="token punctuation">{</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> absolute<span class="token punctuation">;</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>view-form-item</code>内部添加克隆图标，传递参数包括克隆元素、索引值、列表元素，处理函数在<code>store</code>中维护，拷贝元素<code>key</code>值和<code>model</code>重新生成，克隆后活动元素<code>select</code>重置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in data.list&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;view-form-item&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">...</span>
  <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont icon-clone&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;handleClone(element, index, data.list)&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token function">handleClone</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> index<span class="token punctuation">,</span> list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'CLONE_ELEMENT'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> index<span class="token punctuation">,</span> element<span class="token punctuation">,</span> list <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// store -&gt; index.js</span>
<span class="token constant">CLONE_ELEMENT</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> index<span class="token punctuation">,</span> element<span class="token punctuation">,</span> list <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>

  list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>
    index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      key<span class="token punctuation">,</span>
      <span class="token literal-property property">model</span><span class="token operator">:</span> element<span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> key<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>

  state<span class="token punctuation">.</span>select <span class="token operator">=</span> list<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>  删除按钮为避免重复点击，只在第一次点击时触发，元素删除动画触发过程中不可再点击。元素删除前更新活动元素<code>select</code>，被删除元素处在列表末尾且长度大于<code>1</code>，活动元素为上一个元素。若处在列表末尾且长度等于<code>1</code>，即列表只有一个元素，活动元素为空。不满足上述则元素处在中部，删除后活动元素为下一个元素。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;view-form-item&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">...</span>
  <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont icon-trash&quot;</span> @click<span class="token punctuation">.</span>once<span class="token operator">=</span><span class="token string">&quot;handleDelete(data.list, index)&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token function">handleDelete</span><span class="token punctuation">(</span><span class="token parameter">list<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'DELETE_ELEMENT'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> list<span class="token punctuation">,</span> index <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// store -&gt; index.js</span>
<span class="token constant">DELETE_ELEMENT</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> list<span class="token punctuation">,</span> index <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">===</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>select <span class="token operator">=</span> index <span class="token operator">?</span> list<span class="token punctuation">[</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>select <span class="token operator">=</span> list<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="elementcate-组件"><a href="#elementcate-组件" class="header-anchor">#</a> ElementCate 组件</h2> <p>  组件参数引用<code>CommonFild.vue</code>公共字段属性，默认含有<code>5</code>个公共属性，宽度、操作属性、校验规则等根据实际情况加入，定制化属性添加至组件，再由插槽插入内部。组件视图引用<code>CommonView.vue</code>公共视图，负责表单活动样式、标签、字段属性等，组件引用后不考虑表单呈现，仅专注同步组件参数部分。</p> <p>  组件视图部分<code>view.vue</code>，由于表单预览可获取表单内部值，显然组件实现<code>v-model</code>双向绑定，组件内部暂时接收传值<code>value</code>，预览部分再自定义组件<code>v-model</code>。</p> <p>  下面简述组件定制化部分，诸如<code>placeholer</code>占位内容、<code>style</code>宽度等参考源代码。</p> <h3 id="单行文本"><a href="#单行文本" class="header-anchor">#</a> 单行文本</h3> <p>  单行文本参数包括宽度、默认值、占位内容、操作属性等，校验规则较为复杂，暂不考虑。新增组件参数和视图部分均可参考单行文本源码，单行文本禁用和只读属性二者择其一，不能同时作用于同一表单元素。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; input -&gt; config.vue</span>
<span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;option&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>checkbox v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.options.disabled&quot;</span> <span class="token operator">:</span>disabled<span class="token operator">=</span><span class="token string">&quot;data.options.readonly&quot;</span><span class="token operator">&gt;</span>禁用<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>checkbox<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>checkbox v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.options.readonly&quot;</span> <span class="token operator">:</span>disabled<span class="token operator">=</span><span class="token string">&quot;data.options.disabled&quot;</span><span class="token operator">&gt;</span>只读<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>checkbox<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre></div><h3 id="多行文本"><a href="#多行文本" class="header-anchor">#</a> 多行文本</h3> <p>  多行文本参数部分，默认值使用文本域。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; textarea -&gt; config.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;默认值&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input type<span class="token operator">=</span><span class="token string">&quot;textarea&quot;</span> <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
</code></pre></div><h3 id="计数器"><a href="#计数器" class="header-anchor">#</a> 计数器</h3> <p>  计数器操作按钮位置传递参数<code>controls-position</code>，默认为<code>default</code>，默认值受最大值、最小值、步数限制。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; number -&gt; view.vue</span>
<span class="token operator">&lt;</span>common<span class="token operator">-</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input<span class="token operator">-</span>number
    <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;element.options.defaultValue&quot;</span>
    <span class="token operator">:</span>controls<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;element.options.controlsPosition&quot;</span>
  <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>common<span class="token operator">-</span>view<span class="token operator">&gt;</span>

<span class="token comment">// elements -&gt; number -&gt; config.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;默认值&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input<span class="token operator">-</span>number
    v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.options.defaultValue&quot;</span>
    <span class="token operator">:</span>max<span class="token operator">=</span><span class="token string">&quot;data.options.max&quot;</span>
    <span class="token operator">:</span>min<span class="token operator">=</span><span class="token string">&quot;data.options.min&quot;</span>
    <span class="token operator">:</span>step<span class="token operator">=</span><span class="token string">&quot;data.options.step&quot;</span>
  <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
</code></pre></div><h3 id="单选框组"><a href="#单选框组" class="header-anchor">#</a> 单选框组</h3> <p>  单选框组布局方式分为块级和行内，选项包括静态数据和动态数据，暂不考虑动态数据，选项为<code>label-value</code>对形式，内部引用<code>draggable</code>拖动列表，选项可删除和新增，添加选项生成随机<code>label-value</code>对，选中选项设置默认值，清空列表时默认值清空，选中项删除，清空默认值。注意<code>el-radio</code>组件，若不显示<code>label</code>，可传入<code>nbsp</code>空位符。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; radio -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>radio
  v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(item, index) in element.options.options&quot;</span>
  style<span class="token operator">=</span>&quot;<span class="token punctuation">{</span>
    <span class="token literal-property property">display</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>inline
    <span class="token operator">?</span> <span class="token string">'inline-block'</span> <span class="token operator">:</span> <span class="token string">'block'</span>
  <span class="token punctuation">}</span>&quot;
  <span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>label <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>radio<span class="token operator">&gt;</span>

<span class="token comment">// elements -&gt; radio -&gt; config.vue</span>
<span class="token operator">&lt;</span>li <span class="token operator">...</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>radio <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;item.value&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;hidden-label&quot;</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>radio<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
</code></pre></div><h3 id="多选框组"><a href="#多选框组" class="header-anchor">#</a> 多选框组</h3> <p>  多选框组与单选框组大同小异，多选框组默认值为数组，多选框组默认值可选择多个，删除选中项时，首先获取选中项<code>value</code>值在默认值中的索引，满足则删除默认值对应项，不满足只删除选中项。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; checkbox -&gt; config.vue</span>
<span class="token function">handleDeleteOptions</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>value<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>options<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="时间选择器"><a href="#时间选择器" class="header-anchor">#</a> 时间选择器</h3> <p>  时间选择器默认值受格式控制，也包括禁用和只读，同单行文本一致，只能二者选其一。时间选择为占位内容，范围选择包括开始占位内容、范围分隔符、结束占位内容。开启范围选择时默认值只能为<code>null</code>，关闭时设为空字符。<code>el-time-picker</code>组件<code>v-bind</code>绑定<code>is-range</code>，范围选择切换导致选择器定位错乱，是<code>element</code>组件自身的<code>bug</code>，<code>v-if</code>与范围选择参数一致并且指定<code>key</code>值可解决，两者缺一不可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; time -&gt; config.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;默认值&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>time<span class="token operator">-</span>picker v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;data.options.isRange&quot;</span> key<span class="token operator">=</span><span class="token string">&quot;range&quot;</span> is<span class="token operator">-</span>range <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>time<span class="token operator">-</span>picker v<span class="token operator">-</span><span class="token keyword">else</span> key<span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>

<span class="token function">handleRangeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isRange <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="日期选择器"><a href="#日期选择器" class="header-anchor">#</a> 日期选择器</h3> <p>  日期选择器显示类型包括月份、年份、日期、多日期、日期范围等，范围类型默认值为<code>null</code>，其余为空字符，格式对应，切换类型选择器错乱处理方式与时间选择器一致。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; date -&gt; config.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'日期时间范围'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'datetimerange'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
          <span class="token literal-property property">isRange</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleTypeChange</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> showType <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">.</span>value <span class="token operator">===</span> value<span class="token punctuation">)</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>format <span class="token operator">=</span> showType<span class="token punctuation">.</span>format
      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue <span class="token operator">=</span> showType<span class="token punctuation">.</span>type
      <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="评分"><a href="#评分" class="header-anchor">#</a> 评分</h3> <p>  评分默认值受半选、最大值控制，最大值最小为<code>1</code>，默认值清空为<code>0</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; rate -&gt; config.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>rate <span class="token operator">...</span> <span class="token operator">:</span>allow<span class="token operator">-</span>half<span class="token operator">=</span><span class="token string">&quot;data.options.isAllowhalf&quot;</span> <span class="token operator">:</span>max<span class="token operator">=</span><span class="token string">&quot;data.options.max&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="颜色选择器"><a href="#颜色选择器" class="header-anchor">#</a> 颜色选择器</h3> <p>  颜色选择器选择颜色后，元素默认值为<code>hex</code>十六进制，勾选透明度，点击颜色选择器，默认值颜色并未改变，是<code>el-color-picker</code>组件自身的<code>bug</code>，解决方式类似时间选择器，<code>v-if</code>和<code>key</code>值两者共同作用。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; color -&gt; config.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;默认值&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>color<span class="token operator">-</span>picker v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;data.options.showAlpha&quot;</span> key<span class="token operator">=</span><span class="token string">&quot;alpha&quot;</span> <span class="token operator">...</span> show<span class="token operator">-</span>alpha <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>color<span class="token operator">-</span>picker v<span class="token operator">-</span><span class="token keyword">else</span> key<span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
</code></pre></div><h3 id="下拉选择器"><a href="#下拉选择器" class="header-anchor">#</a> 下拉选择器</h3> <p>  下拉选择器添加选项与单选框组一致，删除元素即单选框组和多选框组的合并，单选多选切换保留默认值方式有差异。单选过渡多选，单选未选择默认值，值为空数组，单选选择默认值，值为包含默认值的数组。多选过渡单选，多选未选择默认值，值为<code>null</code>，多选选择默认值，值为数组首个元素值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; select -&gt; config.vue</span>
<span class="token function">handleMultipleChange</span><span class="token punctuation">(</span><span class="token parameter">multiple</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue

  <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue <span class="token operator">=</span> multiple
    <span class="token operator">?</span> value <span class="token operator">===</span> <span class="token keyword">null</span>
      <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token operator">:</span> <span class="token punctuation">[</span>value<span class="token punctuation">]</span>
    <span class="token operator">:</span> value<span class="token punctuation">.</span>length
    <span class="token operator">?</span> value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="开关"><a href="#开关" class="header-anchor">#</a> 开关</h3> <p>  开关参考<code>el-switch</code>参数，可自定义开启和关闭的文字颜色、文字描述。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; switch -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span><span class="token keyword">switch</span>
  <span class="token operator">:</span>active<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">&quot;element.options.isColor ? element.options.activeColor : '#409EFF'&quot;</span>
  <span class="token operator">:</span>inactive<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">&quot;element.options.isColor ? element.options.inactiveColor : '#C0CCDA'&quot;</span>
  <span class="token operator">:</span>active<span class="token operator">-</span>text<span class="token operator">=</span><span class="token string">&quot;element.options.isText ? element.options.activeText : ''&quot;</span>
  <span class="token operator">:</span>inactive<span class="token operator">-</span>text<span class="token operator">=</span><span class="token string">&quot;element.options.isText ? element.options.inactiveText : ''&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="滑块"><a href="#滑块" class="header-anchor">#</a> 滑块</h3> <p>  滑块默认值受最大值、最小值、步长限制。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; slider -&gt; config.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>slider
  v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.options.defaultValue&quot;</span>
  <span class="token operator">:</span>max<span class="token operator">=</span><span class="token string">&quot;data.options.max&quot;</span>
  <span class="token operator">:</span>min<span class="token operator">=</span><span class="token string">&quot;data.options.min&quot;</span>
  <span class="token operator">:</span>step<span class="token operator">=</span><span class="token string">&quot;data.options.step&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="文字"><a href="#文字" class="header-anchor">#</a> 文字</h3> <p>  文字仅是一小段段落，丰富组件列表和部分表单的描述信息，由于可指定宽度，则元素为块级元素。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; text -&gt; view.vue</span>
<span class="token operator">&lt;</span>div <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">&quot;{ width: element.options.width }&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>span style<span class="token operator">=</span><span class="token string">&quot;word-break: break-all&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><h3 id="html"><a href="#html" class="header-anchor">#</a> html</h3> <p>  ;<code>html</code>组件默认值暂时为文本域，可填写<code>html</code>代码即可，视图部分利用<code>v-html</code>指令。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; html -&gt; view.vue</span>
<span class="token operator">&lt;</span>div <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">&quot;{ width: element.options.width }&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div v<span class="token operator">-</span>html<span class="token operator">=</span><span class="token string">&quot;value&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><h3 id="级联选择器"><a href="#级联选择器" class="header-anchor">#</a> 级联选择器</h3> <p>  级联选择器一般异步获取数据源，默认含<code>label</code>、<code>value</code>和<code>children</code>字段，也可指定属性配置，可选项数据源<code>options</code>暂时为空数组。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; cascader -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>cascader
  <span class="token operator">:</span>props<span class="token operator">=</span>&quot;<span class="token punctuation">{</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>props<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token literal-property property">label</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>props<span class="token punctuation">.</span>label<span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>&quot;
  <span class="token operator">:</span>options<span class="token operator">=</span><span class="token string">&quot;[]&quot;</span>
  <span class="token operator">...</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="分割线"><a href="#分割线" class="header-anchor">#</a> 分割线</h3> <p>  分割线<code>content-position</code>控制文本位置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; divider -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>divider <span class="token operator">:</span>content<span class="token operator">-</span>position<span class="token operator">=</span><span class="token string">&quot;element.options.textPosition&quot;</span><span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token punctuation">{</span> element<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>divider<span class="token operator">&gt;</span>
</code></pre></div><h2 id="栅格布局"><a href="#栅格布局" class="header-anchor">#</a> 栅格布局</h2> <p>  上述部分仅仅支持单行单表单组件，尚无法满足简单的栅格布局，即一行无法显示多个表单组件，<code>vue-form-making</code>基础版本不支持栅格布局，但是其样式和参数可作为参考。</p> <p>  栅格样式不同于其他组件，<code>view-form-item</code>判断是否为栅格元素，动态生成类名。栅格样式权重应高于普通样式，栅格样式代码顺序在普通样式后层叠。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>div
  <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span>&quot;<span class="token punctuation">[</span>
    <span class="token string">'view-form-item'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">active</span><span class="token operator">:</span> select<span class="token punctuation">.</span>key <span class="token operator">===</span> element<span class="token punctuation">.</span>key<span class="token punctuation">,</span>
      <span class="token literal-property property">grid</span><span class="token operator">:</span> element<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'grid'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>&quot;
  <span class="token operator">...</span>
<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// layout.scss</span>
<span class="token punctuation">.</span>view<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>view<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token punctuation">.</span>grid <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  栅格参数暂不考虑，一行显示两列。对比<code>ViewForm.vue</code>，<code>ElementCate</code>内元素若能拖入栅格内，首先栅格内渲染的列表要绑定<code>draggable</code>，即<code>draggleble</code>包含栅格列表，其次<code>draggable</code>覆盖区域必须足够高，否则元素拖不进来。栅格内暂时渲染元素对象，<code>v-model</code>绑定<code>data</code>内变量，元素拖入后可以观察到数据已拖入并渲染。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>row type<span class="token operator">=</span><span class="token string">&quot;flex&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;12&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>draggable
      v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;list&quot;</span>
      v<span class="token operator">-</span>bind<span class="token operator">=</span>&quot;<span class="token punctuation">{</span>
        <span class="token literal-property property">group</span><span class="token operator">:</span> <span class="token string">'view'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>&quot;
    <span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>transition<span class="token operator">-</span>group tag<span class="token operator">=</span><span class="token string">&quot;div&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;el-col-list&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in list&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> element <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>draggable<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;12&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;el-col-list&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>

<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre></div><p>  ;<code>el-col-list</code>内元素渲染为表单组件，局部批量注册组件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>transition<span class="token operator">-</span>group tag<span class="token operator">=</span><span class="token string">&quot;div&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;el-col-list&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>component <span class="token operator">:</span>is<span class="token operator">=</span><span class="token string">&quot;element.component&quot;</span> v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in list&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span> <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">&quot;element&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>

<span class="token keyword">import</span> Draggable <span class="token keyword">from</span> <span class="token string">'vuedraggable'</span>
<span class="token keyword">import</span> components <span class="token keyword">from</span> <span class="token string">'elements/view'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'DwGrid'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    Draggable<span class="token punctuation">,</span>
    <span class="token operator">...</span>components<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>ElementCate</code>元素拖入，控制台会报错组件未注册，但是代码内明确注册了组件。在生命周期<code>beforeCreate</code>内打印<code>this.$options.components</code>，页面注册的组件只有<code>Draggable</code>和栅格<code>DwGrid</code>。其余批量注册的组件均不存在，即组件并未注册。造成错误的原因是组件之间的循环引用，若表单元素全局注册，这种错误不会存在。但是组件局部注册，<code>DwGrid</code>内部引用<code>DwGrid</code>，就变成了一个循环，组件不知道如何完全解析出自身。解决方式有两种，<a href="https://cn.vuejs.org/v2/guide/components-edge-cases.html#%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8" target="_blank" rel="noopener noreferrer">vue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 官方给出了示例，由于是批量注册，<code>webpack</code>的异步<code>import</code>不适用，在生命周期<code>beforeCreate</code>时去注册它。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> components <span class="token keyword">from</span> <span class="token string">'elements/view'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>components<span class="token punctuation">,</span> components<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  此时<code>ElementCate</code>元素拖入，对应表单可渲染，参考<code>ViewForm.vue</code>内部<code>view-form-list</code>，配置<code>draggable</code>参数，部分克隆、删除事件暂不考虑，函数设为空函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>transition<span class="token operator">-</span>group <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;el-col-list&quot;</span> <span class="token operator">...</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div
    v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;element in list&quot;</span>
    <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;element.key&quot;</span>
    <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span>&quot;<span class="token punctuation">[</span>
      <span class="token string">'view-form-item'</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">active</span><span class="token operator">:</span> select<span class="token punctuation">.</span>key <span class="token operator">===</span> element<span class="token punctuation">.</span>key<span class="token punctuation">,</span>
        <span class="token literal-property property">grid</span><span class="token operator">:</span> element<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'grid'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>&quot;
    <span class="token operator">:</span>data<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;element.model&quot;</span>
    @click<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token string">&quot;handleSelect(element)&quot;</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>component <span class="token operator">:</span>is<span class="token operator">=</span><span class="token string">&quot;element.component&quot;</span> <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">&quot;element&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;select.key === element.key&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item-drag&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont icon-drag drag-icon&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;select.key === element.key&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item-action&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont icon-clone&quot;</span> @click<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token string">&quot;handleClone&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont icon-trash&quot;</span> @click<span class="token punctuation">.</span>stop<span class="token punctuation">.</span>once<span class="token operator">=</span><span class="token string">&quot;handleDelete&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleSelect</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_SELECT'</span><span class="token punctuation">,</span> element<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">handleClone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">handleDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  细致发现，<code>ViewForm.vue</code>和栅格内部<code>view-form-item</code>代码完全一致（逻辑部分暂不考虑），一般抽离公共代码，封装成一个组件，但是可以梳理页面结构并最终发现，代码一致是必然的。首先<code>ViewForm.vue</code>是一个单一的列表，组件拖入并渲染单个元素，引入栅格后，每个栅格代表一个列表，栅格列表与<code>ViewForm.vue</code>的列表实质是同一种列表，拖入的组件也是同一类组件，所以最终列表（<code>view-form</code>、<code>el-col-list</code>）内代码是一致的。</p> <p>  公共部分代码为<code>Widget.vue</code>小部件，即对每个组件的一层包装，包括点击高亮、拖动、克隆、删除事件，组件传值暂时为<code>element</code>、<code>index</code>（元素索引）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ViewFrom.vue</span>
<span class="token operator">&lt;</span>transition<span class="token operator">-</span>group <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;view-form&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>widget v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in data.list&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;element.key&quot;</span> <span class="token operator">:</span>index<span class="token operator">=</span><span class="token string">&quot;index&quot;</span> <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">&quot;element&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>

<span class="token keyword">import</span> Widget <span class="token keyword">from</span> <span class="token string">'./Widget'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    Widget<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  栅格组件内部引入小部件，拖入<code>ElementCate</code>元素，页面报错组件渲染失败。根据报错信息很难排查问题原因，细致梳理页面结构，小部件批量引入表单组件，其中包含输入框、栅格等，栅格内部引入小部件，又是组件的循环引用，由于是单个组件，采用<code>webpack</code>的异步<code>import</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>transition<span class="token operator">-</span>group <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;el-col-list&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>widget v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in list&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;element.key&quot;</span> <span class="token operator">:</span>index<span class="token operator">=</span><span class="token string">&quot;index&quot;</span> <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">&quot;element&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">-</span>group<span class="token operator">&gt;</span>

<span class="token comment">// import Widget from 'components/ButtonView/Widget.vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">Widget</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'components/ButtonView/Widget.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  栅格列数未与栅格<code>json</code>数据绑定，栅格列表内表单元素是栅格<code>json</code>的一部分，<code>columns</code>数组保存栅格对象，栅格对象参数暂不考虑，只包括<code>list</code>列表字段，<code>draggable</code>双向绑定<code>column.list</code>，未绑定或绑定错误都不能显示。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; index.js</span>
<span class="token keyword">const</span> layout <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'grid'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'栅格布局'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>col v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(column, index) in element.columns&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span> <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;12&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>draggable v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;column.list&quot;</span> <span class="token operator">...</span><span class="token operator">&gt;</span>
      <span class="token operator">...</span>
      <span class="token operator">&lt;</span>widget
        v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in column.list&quot;</span>
        <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;element.key&quot;</span>
        <span class="token operator">:</span>index<span class="token operator">=</span><span class="token string">&quot;index&quot;</span>
        <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">&quot;element&quot;</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>draggable<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
</code></pre></div><p>  栅格参数可配置水平、垂直排列方式，栅格方式分为<code>flex</code>和响应式，默认为<code>flex</code>，参数具体描述参考 <a href="https://element.eleme.cn/#/zh-CN/component/layout" target="_blank" rel="noopener noreferrer">Layout<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 布局。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; index.js</span>
<span class="token keyword">const</span> layout <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'grid'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'栅格布局'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">gutter</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">isFlex</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">justify</span><span class="token operator">:</span> <span class="token string">'start'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">align</span><span class="token operator">:</span> <span class="token string">'top'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">span</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token literal-property property">xs</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token literal-property property">sm</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token literal-property property">md</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lg</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token literal-property property">xl</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>row
  type<span class="token operator">=</span><span class="token string">&quot;flex&quot;</span>
  <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;element.options.gutter&quot;</span>
  <span class="token operator">:</span>justify<span class="token operator">=</span><span class="token string">&quot;element.options.justify&quot;</span>
  <span class="token operator">:</span>align<span class="token operator">=</span><span class="token string">&quot;element.options.align&quot;</span>
<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>col
    <span class="token operator">:</span>xs<span class="token operator">=</span><span class="token string">&quot;element.options.isFlex ? undefined : column.xs&quot;</span>
    <span class="token operator">:</span>sm<span class="token operator">=</span><span class="token string">&quot;element.options.isFlex ? undefined : column.sm&quot;</span>
    <span class="token operator">:</span>md<span class="token operator">=</span><span class="token string">&quot;element.options.isFlex ? undefined : column.md&quot;</span>
    <span class="token operator">:</span>lg<span class="token operator">=</span><span class="token string">&quot;element.options.isFlex ? undefined : column.lg&quot;</span>
    <span class="token operator">:</span>xl<span class="token operator">=</span><span class="token string">&quot;element.options.isFlex ? undefined : column.xl&quot;</span>
    <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;column.span&quot;</span>
    <span class="token operator">...</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">...</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
</code></pre></div><p>  栅格内元素拖入高亮，类比<code>ViewForm.vue</code>，根据索引找出元素即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">...</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">...</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>draggable <span class="token operator">...</span> @add<span class="token operator">=</span><span class="token string">&quot;handleAdd($event, column)&quot;</span><span class="token operator">&gt;</span> <span class="token operator">...</span> <span class="token operator">&lt;</span><span class="token operator">/</span>draggable<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>

<span class="token function">handleAdd</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> newIndex <span class="token punctuation">}</span><span class="token punctuation">,</span> column</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_SELECT'</span><span class="token punctuation">,</span> column<span class="token punctuation">.</span>list<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>  类比原始<code>ViewForm.vue</code>，删除元素传参包括索引值、元素列表，<code>Widget.vue</code>声明组件传值<code>data</code>，栅格内也是如此。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ViewForm.vue</span>
<span class="token operator">&lt;</span>widget
  v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in data.list&quot;</span>
  <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;element.key&quot;</span>
  <span class="token operator">:</span>index<span class="token operator">=</span><span class="token string">&quot;index&quot;</span>
  <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;data&quot;</span>
  <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">&quot;element&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>widget
  v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(element, index) in column.list&quot;</span>
  <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;element.key&quot;</span>
  <span class="token operator">:</span>index<span class="token operator">=</span><span class="token string">&quot;index&quot;</span>
  <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;column&quot;</span>
  <span class="token operator">:</span>element<span class="token operator">=</span><span class="token string">&quot;element&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><p>  小部件内克隆与<code>ViewForm.vue</code>大同小异，若栅格内部多层嵌套或包含其他表单组件，克隆后不仅要生成副本，而且副本下所有元素的<code>key</code>值不能和之前相同，需递归更新元素的<code>key</code>值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// store -&gt; index.js</span>
<span class="token constant">CLONE_ELEMENT</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> index<span class="token punctuation">,</span> element<span class="token punctuation">,</span> list <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'grid'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">resetGridKey</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">resetGridKey</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">column</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      column<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        el<span class="token punctuation">.</span>key <span class="token operator">=</span> key
        el<span class="token punctuation">.</span>model <span class="token operator">=</span> el<span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> key

        <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'grid'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">resetGridKey</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="dialog-公共对话框和-aceeditor"><a href="#dialog-公共对话框和-aceeditor" class="header-anchor">#</a> Dialog 公共对话框和 AceEditor</h2> <p>  导入<code>json</code>，可粘贴<code>json</code>数据快速配置表单，点击确定，根据配置的<code>json</code>数据渲染表单，但是数据不限制会发生很多错误，<code>utils</code>下<code>format.js</code>验证传入的<code>json</code>数据格式是否正确，格式不正确<code>reject</code>并返回错误原因，格式正确更新<code>state</code>内表单数据<code>data</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// layout -&gt; components -&gt; ButtonView.vue</span>
<span class="token function">handleUploadJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">formatJson</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>uploadAceEditor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_DATA'</span><span class="token punctuation">,</span> json<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>showUpload <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'数据格式有误'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>  粘贴<code>json</code>数据，只有用户事先授予网站或应用对剪切板的访问许可后，才能使用异步剪切板读取方法 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/clipboard" target="_blank" rel="noopener noreferrer">MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。使用<code>navigator.clipboard</code>来访问剪切板，<code>readText()</code>异步读取剪切板内容，由于浏览器出于安全考虑，非本地或者网站是<code>http</code>协议，都不能读取剪切板内容。可在<code>http</code>或<code>https</code>网站控制台打印<code>navigator.clipboard</code>，<code>http</code>协议网站为<code>undefined</code>。故只有当<code>https</code>网站或者用户授予才可粘贴，否则显示取消按钮，由用户手动粘贴。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// layout -&gt; components -&gt; ButtonView.vue</span>
<span class="token operator">...</span>
<span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;action&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;showPasteBtn&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;handlePaste&quot;</span><span class="token operator">&gt;</span>粘贴<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button v<span class="token operator">-</span><span class="token keyword">else</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;showUpload = false&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">showPasteBtn</span><span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token function">handlePaste</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>uploadAceEditor<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  清空时清除活动元素<code>select</code>，视图内列表清空。生成<code>json</code>，即显示表单<code>json</code>信息。复制功能引入第三方复制插件<code>clipboard</code>，剪切板实例参数为按钮类名、复制内容，二次封装提示信息，复制完成销毁剪切板实例。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// layout -&gt; components -&gt; ButtonView.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>button <span class="token operator">...</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;copyJson&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;handleCopyJson&quot;</span><span class="token operator">&gt;</span> 复制<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>

<span class="token function">handleCopyJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleCopyText</span><span class="token punctuation">(</span><span class="token string">'jsonAceEditor'</span><span class="token punctuation">,</span> <span class="token string">'.copyJson'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token function">handleCopyText</span><span class="token punctuation">(</span><span class="token parameter">ref<span class="token punctuation">,</span> className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">copyText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span>ref<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> className<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'复制成功'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'复制失败'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// utils -&gt; index.js</span>
<span class="token keyword">function</span> <span class="token function">copyText</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> clipboard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Clipboard</span><span class="token punctuation">(</span>className<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">text</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> text<span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    clipboard<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      clipboard<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    clipboard<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      clipboard<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  设计工具目的是设计<code>json</code>表单数据，某个独立组件传参表单数据渲染为表单。封装独立组件<code>GenerateForm.vue</code>，<code>ButtonView.vue</code>引入并插入预览弹框插槽，传入全局<code>state</code>内<code>data</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// layout -&gt; components -&gt; ButtonView.vue</span>
<span class="token operator">&lt;</span><span class="token keyword">public</span><span class="token operator">-</span>dialog<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
  <span class="token operator">&lt;</span>generate<span class="token operator">-</span>form <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;data&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">public</span><span class="token operator">-</span>dialog<span class="token operator">&gt;</span>

<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>data
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;generate-form&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">...</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>component <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  点击预览，单个组件正常渲染（文字、<code>html</code>未显示），栅格内单个组件渲染后残留部分图标。原因是因为栅格组件内部引入的小部件，小部件内部含图标，即预览时栅格内部不应渲染小部件，而应渲染表单元素。<code>GenerateForm.vue</code>批量引入组件，组件传值不可拖动，栅格接收参数，仅渲染为表单元素。栅格内批量引入组件，组件内又包括栅格，即组件循环引用，在<code>beforeCreate</code>再次注册。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token operator">&lt;</span>component <span class="token operator">...</span> <span class="token operator">:</span>draggable<span class="token operator">=</span><span class="token string">&quot;false&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>draggable v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;draggable&quot;</span><span class="token operator">&gt;</span> <span class="token operator">...</span> <span class="token operator">&lt;</span><span class="token operator">/</span>draggable<span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>component <span class="token operator">...</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

<span class="token keyword">import</span> components <span class="token keyword">from</span> <span class="token string">'elements/view'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>components<span class="token punctuation">,</span> components<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  除文字、<code>html</code>外基本可实现预览，获取数据还不可用，表单元素字段属性配置默认值后，<code>ViewForm.vue</code>视图还未显示，但是几乎全部表单元素都将<code>value</code>作为组件传值，小部件传递组件默认值即可显示，栅格内列表也引入的小部件，故栅格内表单元素也会显示默认值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; input -&gt; view.vue</span>
<span class="token operator">&lt;</span>input <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;value&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// components -&gt; ButtonView -&gt; Widget.vue</span>
<span class="token operator">&lt;</span>component <span class="token operator">...</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;element.options.defaultValue&quot;</span> draggable <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><p>  点击预览尚不可显示默认值，而且默认值必然与表单组件双向绑定。故需自定义表单组件元素的 <a href="https://cn.vuejs.org/v2/guide/components-custom-events.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%9A%84-v-model" target="_blank" rel="noopener noreferrer">v-model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，声明传入组件的<code>prop</code>，同时表单值变化触发某个事件的时候，更新<code>prop</code>。文字和<code>html</code>不做双向绑定，但是内部依然可以组件传值<code>value</code>，另外分割线无需组件传值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; input -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>input <span class="token operator">...</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;value&quot;</span> @input<span class="token operator">=</span><span class="token string">&quot;value =&gt; $emit('change', value)&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">prop</span><span class="token operator">:</span> <span class="token string">'value'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">event</span><span class="token operator">:</span> <span class="token string">'change'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  ;<code>GenerateForm.vue</code>内部是<code>el-form</code>，内部引入不同表单元素，表单元素已实现双向绑定，接下来需要与数据绑定，栅格和分割线不用绑定变量，但是栅格内部元素和外部其他元素均绑定<code>model</code>。<code>GenerateForm.vue</code>初始化的<code>models</code>传入栅格，由于对象传值引用，故栅格内部元素也能绑定，栅格内部可能嵌套栅格，<code>models</code>需传递下去。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;models&quot;</span> <span class="token operator">...</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>components v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;models[element.model]&quot;</span> <span class="token operator">:</span>models<span class="token operator">=</span><span class="token string">&quot;models&quot;</span> <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">models</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleSetModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleSetModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

      <span class="token function">getGridModel</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">)</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span>models <span class="token operator">=</span> models

      <span class="token keyword">function</span> <span class="token function">getGridModel</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'grid'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            element<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">column</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">getGridModel</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span>list<span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'divider'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              models<span class="token punctuation">[</span>element<span class="token punctuation">.</span>model<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>components v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;models[element.model]&quot;</span> <span class="token operator">:</span>models<span class="token operator">=</span><span class="token string">&quot;models&quot;</span> <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">models</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  点击获取数据后，将<code>models</code>数据放入编辑器，<code>GenerateForm.vue</code>内部加入<code>getData</code>方法返回<code>models</code>，<code>models</code>需拷贝副本返回，保证组件内<code>models</code>不被污染。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// layout -&gt; components -&gt; ButtonView.vue</span>
<span class="token operator">&lt;</span>generate<span class="token operator">-</span>form ref<span class="token operator">=</span><span class="token string">&quot;generateForm&quot;</span> <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;data&quot;</span> <span class="token operator">...</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token function">handleGetData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>models <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>generateForm<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>showPreviewData <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="tinymce-富文本编辑器"><a href="#tinymce-富文本编辑器" class="header-anchor">#</a> Tinymce 富文本编辑器</h2> <p>  最初决定使用<code>tinymce</code>作为富文本编辑器主要是由于<code>tinymce</code>操作按钮很容易控制，图片上传很方便，<a href="http://tinymce.ax-z.cn/" target="_blank" rel="noopener noreferrer">中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 也容易上手，不足部分就是依赖<code>tinymce-vue</code>且很多功能声明后还需单独引入才能使用，组件语言部分要单独引入<code>js</code>。其他编辑器图片上传很复杂，并且最主要的是上传的图片大小不可控制，有的文档也不完善，后续可能会替换其他编辑器，<code>wangEditor</code>可作为尝试。</p> <p>  组件内配置详细可参考源代码，其中图片上传部分详细描述。使用<code>images_upload_handler</code>自定义图片上传，参数分别为<code>blobInfo</code>、<code>success</code>、<code>failure</code>，<code>blobInfo</code>为图片文件详细信息（文件名、<code>base64</code>等），<code>success</code>为图片上传成功回调，传参图片<code>url</code>地址，<code>failure</code>为图片上传失败回调，传参错误描述信息。用户引入<code>GenerateForm.vue</code>不可见自定义图片上传函数体，若要获取文件信息、回调函数只能通过子组件传值父组件，且栅格引入后需逐层向上传递。<code>editorUploadImage</code>函数内可获取文件信息，也可异步调用失败和成功回调函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; editor -&gt; view.vue</span>
<span class="token function-variable function">images_upload_handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">blobInfo<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failure</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'editor-upload-image'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    blobInfo<span class="token punctuation">,</span>
    success<span class="token punctuation">,</span>
    failure<span class="token punctuation">,</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>element<span class="token punctuation">.</span>model<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>component @editor<span class="token operator">-</span>upload<span class="token operator">-</span>image<span class="token operator">=</span><span class="token string">&quot;data =&gt; $emit('editor-upload-image', data)&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token operator">&lt;</span>component @editor<span class="token operator">-</span>upload<span class="token operator">-</span>image<span class="token operator">=</span><span class="token string">&quot;data =&gt; $emit('editor-upload-image', data)&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// layout -&gt; components -&gt; ButtonView.vue</span>
<span class="token operator">&lt;</span>generate<span class="token operator">-</span>form <span class="token operator">...</span> @editor<span class="token operator">-</span>upload<span class="token operator">-</span>image<span class="token operator">=</span><span class="token string">&quot;editorUploadImage&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token function">editorUploadImage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> blobInfo<span class="token punctuation">,</span> success <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'data:image/jpeg;base64,'</span> <span class="token operator">+</span> blobInfo<span class="token punctuation">.</span><span class="token function">base64</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="blank-自定义区域"><a href="#blank-自定义区域" class="header-anchor">#</a> blank 自定义区域</h2> <p>  若设计工具仅仅支持上述表单组件，设计工具的局限性会非常大，尚不支持<code>Tabs</code>标签页、表格，也不支持引入第三方的表单组件，所以需提供自定义区域插槽，用户再根据实际情况插入不同的表单组件，以此增加表单延展性。</p> <p>  首先要明确的是，组件内部若有多个同名具名插槽，外部插入元素时，均会插入到同名具名插槽内部。组件外部插入多个不同插槽名元素时，只有和组件内插槽名相同的元素才能插入。<code>GenerateForm.vue</code>初始化时不仅需要创建绑定表单<code>models</code>，还要获取表单内所有自定义区域的<code>model</code>，即是自定义区域内插槽的名称。</p> <p>  若<code>GenerateForm.vue</code>外部插入<code>A</code>、<code>B</code>、<code>C</code>等若干个不同插槽名的元素，表单内含自定义区域<code>A</code>、栅格嵌套多层的<code>B</code>。<code>GenerateForm.vue</code>根据表单内自定义区域个数创建<code>slots</code>数组（<code>A</code>、<code>B</code>），创建<code>A</code>、<code>B</code>对应具名插槽，自定义区域<code>A</code>外部<code>A</code>、<code>B</code>两个元素待插入，但是由于自定义区域<code>A</code>内部只有插槽<code>A</code>，则<code>A</code>元素插入自定义区域<code>A</code>内部。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>generate<span class="token operator">-</span>form<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token operator">&gt;</span><span class="token constant">A</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token operator">&gt;</span><span class="token constant">B</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">&quot;C&quot;</span><span class="token operator">&gt;</span><span class="token constant">C</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>generate<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token comment">// generate-form</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>blank<span class="token operator">-</span><span class="token constant">A</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>blank<span class="token operator">-</span><span class="token constant">A</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// black-A</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><p>  自定义区域假设嵌套两层栅格，传入<code>slots</code>数组（<code>A</code>、<code>B</code>），第一层栅格外部插入<code>A</code>、<code>B</code>元素，第一层栅格内部解析为第二层栅格并创建<code>A</code>、<code>B</code>插槽，第二层栅格外部插入<code>A</code>、<code>B</code>元素，内部解析为自定义区域<code>B</code>并创建<code>A</code>、<code>B</code>插槽，由于自定义区域<code>B</code>内部只有插槽<code>B</code>，则<code>B</code>元素插入自定义区域<code>B</code>内部。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>generate<span class="token operator">-</span>form<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token operator">&gt;</span><span class="token constant">A</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token operator">&gt;</span><span class="token constant">B</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">&quot;C&quot;</span><span class="token operator">&gt;</span><span class="token constant">C</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>generate<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token comment">// generate-form</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>grid<span class="token operator">-</span><span class="token number">1</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>grid<span class="token operator">-</span><span class="token number">1</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// grid1</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>grid<span class="token operator">-</span><span class="token number">2</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>grid<span class="token operator">-</span><span class="token number">2</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// grid-2</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>black<span class="token operator">-</span><span class="token constant">B</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template slot<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>black<span class="token operator">-</span><span class="token constant">B</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// black-B</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><p>  上述原理基本接近源代码，页面创建初始化<code>models</code>和<code>slots</code>。自定义区域将<code>models</code>放在<code>model</code>字段上，无论栅格嵌套多少层，<code>scope.model</code>始终为<code>models</code>，并且<code>models</code>与表单内部<code>models</code>是同一个<code>models</code>，自定义组件双向绑定<code>models</code>变量，预览获取数据始终为表单值<code>models</code>（包括自定义组件）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token operator">&lt;</span>component <span class="token operator">:</span>slots<span class="token operator">=</span><span class="token string">&quot;slots&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;slot in slots&quot;</span> <span class="token operator">:</span>slot<span class="token operator">=</span><span class="token string">&quot;slot&quot;</span> slot<span class="token operator">-</span>scope<span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>slot <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;slot&quot;</span> <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;scope.model&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>component<span class="token operator">&gt;</span>

<span class="token function">handleSetModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">const</span> slots <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token function">getGridModel</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">)</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>models <span class="token operator">=</span> models
  <span class="token keyword">this</span><span class="token punctuation">.</span>slots <span class="token operator">=</span> slots

  <span class="token keyword">function</span> <span class="token function">getGridModel</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'grid'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'blank'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          slots<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>model<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token operator">...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// elements -&gt; grid -&gt; view.vue</span>
<span class="token operator">&lt;</span>component <span class="token operator">:</span>slots<span class="token operator">=</span><span class="token string">&quot;slots&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;slot in slots&quot;</span> <span class="token operator">:</span>slot<span class="token operator">=</span><span class="token string">&quot;slot&quot;</span> slot<span class="token operator">-</span>scope<span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>slot <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;slot&quot;</span> <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;scope.model&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>component<span class="token operator">&gt;</span>

<span class="token comment">// elements -&gt; blank -&gt; view.vue</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>slot <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;element.model&quot;</span> <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;models&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;custom-area&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> element<span class="token punctuation">.</span>model <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><h2 id="表单功能"><a href="#表单功能" class="header-anchor">#</a> 表单功能</h2> <h3 id="重置"><a href="#重置" class="header-anchor">#</a> 重置</h3> <p>  表单重置其实调用<code>el-form</code> <code>resetFields</code>方法基本就能完成重置，但是时间和日期选择器重置存在<code>bug</code>。时间范围下绑定值<code>times</code>，初始值<code>null</code>，选择时间后重置，<code>times</code>值为<code>[ null ]</code>，绑定值空数组<code>[]</code>，打开时间选择器无法选择时间。日期范围下均存在这种<code>bug</code>，故范围选择方式统一默认值<code>null</code>，表单内部重置重写一次。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>el<span class="token operator">-</span>form ref<span class="token operator">=</span><span class="token string">&quot;form&quot;</span> <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;form&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item prop<span class="token operator">=</span><span class="token string">&quot;times&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;时间范围&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>time<span class="token operator">-</span>picker v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;form.times&quot;</span> value<span class="token operator">-</span>format<span class="token operator">=</span><span class="token string">&quot;HH-mm-ss&quot;</span> is<span class="token operator">-</span>range<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>time<span class="token operator">-</span>picker<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>el<span class="token operator">-</span>button @click<span class="token operator">=</span><span class="token string">&quot;$refs.form.resetFields()&quot;</span><span class="token operator">&gt;</span>重置<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">form</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">times</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>modelsForm<span class="token punctuation">.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetTimePicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token function">resetTimePicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">null</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="校验规则"><a href="#校验规则" class="header-anchor">#</a> 校验规则</h3> <p>  校验规则大多数涉及必填，只有单行文本和多行文本较为特殊。单行文本支持验证器验证和正则表达式验证，多行文本支持正则表达式验证。必填字段星号可由组件传值<code>el-fom-item</code> <code>required</code>属性控制。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">:</span>required<span class="token operator">=</span><span class="token string">&quot;element.options.required&quot;</span><span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
</code></pre></div><p>  ;<code>element-ui</code> <code>el-form</code>表单验证方式包括四种，必填方式最为常用，指定<code>required</code> <code>true</code>开启必填，正则表达式方式<code>pattern</code>可直接指定正则表达式，验证器方式包括字符串<code>string</code>、数字<code>number</code>、整数<code>interger</code>、浮点数<code>float</code>、<code>URL</code>类型、<code>16</code>进制<code>hex</code>、电子邮箱<code>email</code>等，自定义验证方式最灵活，可定制化设置验证规则，详细参考 <a href="https://element.eleme.cn/2.14/#/zh-CN/component/form" target="_blank" rel="noopener noreferrer">element-ui<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'请输入姓名'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">phone</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^1[3456789]d{9}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'格式有误'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'格式有误'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">psw</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">validator</span><span class="token operator">:</span> validatePsw <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>  表单初始化时不仅创建<code>models</code>、<code>slots</code>，验证规则<code>rules</code>也要创建。所有属性均会添加必填方式，但是<code>required</code>为<code>false</code>不会开启必填。<code>isPattern</code>为正则验证方式，其中单行文本和多行文本独有，<code>new RegExp</code>实例化正则。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// components -&gt; ButtonView -&gt; GenerateForm.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token keyword">function</span> <span class="token function">handleSetModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token operator">...</span>
  <span class="token function">getGridModel</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">)</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>rules <span class="token operator">=</span> rules

  <span class="token keyword">function</span> <span class="token function">getGridModel</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'grid'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">[</span>element<span class="token punctuation">.</span>model<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>required<span class="token punctuation">,</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>requiredMessage <span class="token operator">||</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">请输入</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>element<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          rules<span class="token punctuation">[</span>element<span class="token punctuation">.</span>model<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>typeMessage <span class="token operator">||</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>element<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">验证不匹配</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>isPattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          rules<span class="token punctuation">[</span>element<span class="token punctuation">.</span>model<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>pattern<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span> element<span class="token punctuation">.</span>options<span class="token punctuation">.</span>patternMessage <span class="token operator">||</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>element<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">格式不匹配</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>  验证器方式中数字、整数、浮点数较为特殊，若指定其中一种，表单验证是不会通过的，因为单行文本双向绑定值始终为字符串，不会为数字类型。解决方式指定需指定<code>el-input</code>为数字类型，且触发<code>change</code>事件需转换为数值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>common<span class="token operator">-</span>view <span class="token operator">...</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input
    v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;element.options.isType &amp;&amp; ['number', 'integer', 'float'].includes(element.options.type)&quot;</span>
    type<span class="token operator">=</span><span class="token string">&quot;number&quot;</span>
    @input<span class="token operator">=</span><span class="token string">&quot;input&quot;</span>
  <span class="token operator">/</span><span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span><span class="token keyword">else</span> @input<span class="token operator">=</span><span class="token string">&quot;input&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>common<span class="token operator">-</span>view<span class="token operator">&gt;</span>

<span class="token function">input</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> type<span class="token punctuation">,</span> isType <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>element<span class="token punctuation">.</span>options

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isType <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span><span class="token string">'number'</span><span class="token punctuation">,</span> <span class="token string">'integer'</span><span class="token punctuation">,</span> <span class="token string">'float'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    value <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="生成代码"><a href="#生成代码" class="header-anchor">#</a> 生成代码</h3> <p>  生成代码部分需要根据表单<code>json</code>往固定模板填充数据，默认包括提交、重置按钮，组件传参<code>jsonData</code>为表单<code>json</code>数据，<code>editData</code>为表单初始值，<code>remoteOption</code>是级联选择器列表数据。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// elements -&gt; cascader -&gt; view.vue</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>cascader <span class="token operator">...</span> <span class="token operator">:</span>options<span class="token operator">=</span><span class="token string">&quot;remoteOption &amp;&amp; remoteOption[element.options.remoteOption]&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><p>  若组件使用了富文本编辑器，默认包含事件<code>editor-upload-image</code>及其对应处理函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">editorUploadImage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> model<span class="token punctuation">,</span> blobInfo<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failure <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// success(图片地址) / failure(失败说明) 可异步调用</span>
  <span class="token comment">// success('http://xxx.xxx.xxx/xxx/image-url.png')</span>
  <span class="token comment">// failure('上传失败')</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'data:image/jpeg;base64,'</span> <span class="token operator">+</span> blobInfo<span class="token punctuation">.</span><span class="token function">base64</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> 
</code></pre></div><p>  插槽部分根据<code>slots</code>列表插入组件内部，默认包含插槽名和变量绑定方式。<code>editData</code>传入组件内部，<code>GenerateForm.vue</code>内部需要合并默认值和<code>editData</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>models <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>models<span class="token punctuation">,</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="html-默认值"><a href="#html-默认值" class="header-anchor">#</a> HTML 默认值</h3> <p>  ;<code>html</code>默认值最初放置的是多行文本框，现在引入<code>AceEditor</code>后需要调整。<code>AceEditor</code>内部修改值后需更新<code>html</code>默认值，通过<code>change</code>事件触发。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// compoents -&gt; AceEditor.vue</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>editor<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">delta</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// elements -&gt; html -&gt; config.vue</span>
<span class="token operator">&lt;</span>ace<span class="token operator">-</span>editor <span class="token operator">...</span> @change<span class="token operator">=</span><span class="token string">&quot;handelChange&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token function">handelChange</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue <span class="token operator">=</span> text
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>  若表单内包括多个<code>html</code>组件，切换组件发现<code>AceEditor</code>内部值并未发生改变。<code>html</code>字段属性始终是同一个<code>AceEditor</code>，所以值不会发生改变。内部需要监听<code>html</code>对象的改变，调用组件内部<code>setValue</code>方法赋值。元素拖入立即执行监听<code>hander</code>，默认对象非深度监听，但是不能开启深度监听，原因是因为组件内部<code>change</code>事件触发更新默认值时，开启深度监听后，<code>hander</code>会触发再次调用组件内<code>setValue</code>，<code>setValue</code>再次触发<code>change</code>，会造成循环调用页面卡死。即监听对象引用改变，不监听对象内容改变即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>htmlAceEditor<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="发布维护"><a href="#发布维护" class="header-anchor">#</a> 发布维护</h2> <h3 id="npm-组件"><a href="#npm-组件" class="header-anchor">#</a> NPM 组件</h3> <p>  为方便后期使用，可将项目发布为<code>npm</code>包。与<code>main.js</code>同级目录创建<code>index.js</code>，引入需导出的组件和样式。<code>Vue.use(cpn)</code>默认调用<code>cpn</code>上<code>install</code>方法注册组件，参数默认为<code>Vue</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">[</span>GenerateForm<span class="token punctuation">,</span> MakingForm<span class="token punctuation">]</span>

<span class="token keyword">const</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token parameter">Vue</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  components<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">component</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>name<span class="token punctuation">,</span> component<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  install<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// 引用方式</span>
<span class="token keyword">import</span> DwFormMaking <span class="token keyword">from</span> <span class="token string">'dw-form-making'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>DwFormMaking<span class="token punctuation">)</span>
</code></pre></div><p>  组件部分引入方式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> GenerateForm <span class="token keyword">from</span> <span class="token string">'components/ButtonView/GenerateForm'</span>
<span class="token keyword">import</span> MakingForm <span class="token keyword">from</span> <span class="token string">'./layout/index'</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> GenerateForm<span class="token punctuation">,</span> MakingForm <span class="token punctuation">}</span>

<span class="token comment">// 调用方式</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> GenerateForm<span class="token punctuation">,</span> MakingForm <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dw-form-making'</span>

Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>GenerateForm<span class="token punctuation">.</span>name<span class="token punctuation">,</span> GenerateForm<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>MakingForm<span class="token punctuation">.</span>name<span class="token punctuation">,</span> MakingForm<span class="token punctuation">)</span>
</code></pre></div><p>  新增<code>script</code>命令，<code>name</code>为构建名称，最后一个参数为入口文件。参数以及构建库输出文件详细参考 <a href="https://cli.vuejs.org/zh/guide/build-targets.html#%E5%BA%93" target="_blank" rel="noopener noreferrer">vue-cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 库。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// package.json</span>
<span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token string-property property">&quot;publish&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --target lib --name DwFormMaking ./src/index.js&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>  配置<code>package.json</code>，详细描述发布包所需字段。</p> <ul><li><code>name</code>：包名，名字是唯一的，可在<code>npm</code>官网查询是否重复</li> <li><code>description</code>：描述，<code>npm</code>官网查询出包后的描述信息</li> <li><code>version</code>：版本号，每次发布版本号不能和历史版本号相同</li> <li><code>author</code>：作者</li> <li><code>private</code>：是否私有，<code>false</code>公开才能发布到<code>npm</code></li> <li><code>keywords</code>：关键字，通常用于<code>npm</code>关键字搜索</li> <li><code>main</code>：入口文件，指向编译后的包文件</li> <li><code>files</code>：<code>npm</code>白名单，只有<code>files</code>中指定的文件或文件夹会被打包到项目中</li></ul> <p>  配置完成后，运行<code>npm run publish</code>会生成相关的包文件，且默认位于<code>dist</code>目录下。</p> <p><img src="/app/form-making/dist.png" alt=""></p> <p>  申请<code>npm</code>官方账号后，运行<code>npm login</code>，输入用户名、密码和邮箱，注意密码输入后是不可见的，输入后回车请求登录到<code>npm</code>。</p> <p><img src="/app/form-making/email.png" alt=""></p> <p>  登录成功后控制台输出如下。</p> <p><img src="/app/form-making/logined.png" alt=""></p> <p>  紧接着再运行<code>npm publish</code>命令，将<code>package.json</code>中<code>files</code>属性指定的文件发布到<code>npm</code>。</p> <p><img src="/app/form-making/files.png" alt=""></p> <p>  控制台输出如下命令，即表示发布成功，后续邮箱中也会收到发布成功的邮件。</p> <p><img src="/app/form-making/publish.png" alt=""></p> <p>  现在就可以运行<code>npm i dw-form-making</code>下载刚才发布的包了，展开<code>node_modules</code>下<code>dw-form-making</code>文件夹，果然是将<code>files</code>指定的文件发布了。</p> <p><img src="/app/form-making/modules.png" alt=""></p> <h3 id="git-远程库维护"><a href="#git-远程库维护" class="header-anchor">#</a> Git 远程库维护</h3> <p>  ;<code>GitHub</code>新建仓库后，本地再关联远程仓库。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git remote add origin https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>username<span class="token operator">/</span>repository<span class="token punctuation">.</span>git
</code></pre></div><p>  将本地<code>master</code>分支推送至远程仓库。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git push origin master
</code></pre></div><h3 id="在线预览"><a href="#在线预览" class="header-anchor">#</a> 在线预览</h3> <p>  ;<code>GitHub</code>提供了静态页面的预览功能，并默认展示分支下的<code>index.html</code>文件。</p> <p>  因此可以单独创建一个<code>page</code>分支。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git branch page
</code></pre></div><p>  然后运行<code>npm run build</code>，删除目录内除<code>lib</code>、<code>node_modules</code>、<code>.gitignore</code>外的所有文件，移动<code>lib</code>内文件到外层，最终根目录结构大致如下。</p> <p><img src="/app/form-making/dir.png" alt=""></p> <p>  暂存并提交<code>page</code>分支的修改，推送至远程仓库。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>git push origin page
</code></pre></div><p>  假设上述都没有问题，那么将会在<code>GitHub</code>查看到如下分支结构。</p> <p><img src="/app/form-making/branch.png" alt=""></p> <p>  点击仓库内<code>Settings</code>按钮，找到侧边<code>Pages</code>项。</p> <p><img src="/app/form-making/pages.png" alt=""></p> <p>  选择<code>page</code>分支，<code>root</code>根目录，点击<code>Save</code>。</p> <p><img src="/app/form-making/save.png" alt=""></p> <p>  呐，你的预览页就已经发布到<code>https://xxx.github.io/dw-form-making/</code>了，点击试试吧。</p> <p><img src="/app/form-making/success.png" alt=""></p> <h2 id="后记"><a href="#后记" class="header-anchor">#</a> 后记</h2> <p>  开源的表单设计器基础版本使用范围很小，设计器内部非常多的<code>bug</code>，最为基本的栅格也不支持。某天空闲突然对其源码感兴趣，大致梳理发现其业务逻辑繁杂，组件层级非常深，部分组件代码冗余，甚至单个组件内部代码接近<code>500</code>行，可读性和拓展性很差。于是参考其样式，直接重构了<code>js</code>部分。</p> <p>  最为基础的表单组件基本实现并可预览，较为复杂的栅格布局需要仔细梳理，理解了其中栅格的递归嵌套逻辑，很快就能实现。基于此为基础的自定义区域，也就是递归组件内的作用域插槽，最为耗时，由于是空闲时间做的工具，工作时间稍微有点想法会实现一个<code>demo</code>，考虑过<code>render</code>函数，也考虑过缩小组件层级，最终的插槽<code>v-for</code>也是某个时刻偶然想到的。项目之前包括选择树、代码编辑器，仔细考虑后决定删除。最大原因还是为了缩小项目体积，其中组件更多不过是完善，差异也只是大同小异，不同基本组件都涉及，定制组件自定义引入，简单而不简单。</p> <p>  项目整体难度也不高，此笔记仅是记录重构过程的部分思路。重构初一方面由于兴趣使然，另一方面对其内部逻辑和<code>npm</code>包的发布新奇。整体下来可以巩固<code>element-ui</code>表单组件的使用，部分其它组件也有涉及，对于页面布局、类名的设定、代码规范都是一次练习。其中递归组件、作用域插槽、组件循环引用较复杂，仔细梳理也能明白其中原理。代码管理方面也可巩固<code>Git</code>基本命令的使用、多远程库的管理。</p> <p>  工具可在线预览或克隆，之前<code>Git</code>提交次数过多导致版本库较大，已重新创建了仓库。源代码在<code>GitHub</code>开源，工具名 <a href="https://dongwei1125.github.io/dw-form-making/" target="_blank" rel="noopener noreferrer">dw-form-making<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="更新日志"><a href="#更新日志" class="header-anchor">#</a> 更新日志</h2> <h3 id="_2020-12-11-17-18"><a href="#_2020-12-11-17-18" class="header-anchor">#</a> 2020/12/11 17:18</h3> <p>  可能你也注意到了，代码中用到<code>store</code>的地方都是引入再使用，为什么不放在<code>vue</code>原型对象<code>prototype</code>上，代码中将最大程度还原<code>vuex</code>的调用方式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$store <span class="token operator">=</span> store
</code></pre></div><p>  但是发布为 <a href="https://cn.vuejs.org/v2/guide/plugins.html" target="_blank" rel="noopener noreferrer">vue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 插件，<code>store</code>放在<code>vue</code>的原型上不是那么理想，首先来看看组件<code>install</code>方法，第一个参数是<code>Vue</code>构造器，也就是执行<code>Vue.use()</code>时的<code>Vue</code>，倘若像上述给予<code>Vue</code>原型上添加<code>$store</code>，有一个很糟糕的情况，则是<code>$store</code>关键字被占用了，页面只有单独定义其他关键字，否则<code>$store</code>直接被覆盖掉。更糟糕的情况则是引用<code>vuex</code>状态管理的项目，由于<code>vuex</code>在<code>beforeCreate</code>首行注入<code>$store</code>，若同时集成表单工具，可能会导致工具崩溃，出现意料之外的<code>bug</code>。</p> <p>  此次更新修复了栅格复制<code>key</code>值的<code>bug</code>，删除掉组件内部分未引用的变量。并且在工具内控制台输出了彩蛋（<a href="https://dongwei1125.github.io/dw-form-making/" target="_blank" rel="noopener noreferrer">试一试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>），不包括<code>npm</code>组件。</p> <h3 id="_2022-03-05-17-35"><a href="#_2022-03-05-17-35" class="header-anchor">#</a> 2022/03/05 17:35</h3> <p>  虽然是个人维护的小项目，代码风格大多数都是统一的，但是也会存在很多不合理的风格。因此根据 <a href="/pages/js/eslint-prettier.html">vscode 插件与 npm 包，保存时自动修复代码格式错误</a> 一文，引入了<code>eslint</code>和<code>prettier</code>来规范和格式化项目的代码。组件内<code>props</code>传值类型和默认值也极为不合理，通过<code>eslint</code>检测已经全部修复。</p> <p>  另外在仓库下新增了<code>deploy.sh</code>脚本，主要用来快捷部署<code>Pages</code>静态页面。</p> <p>  由于<code>GitHub</code>的仓库经常访问缓慢或者无响应，因此利用<code>Gitee</code>镜像了此仓库（<a href="https://gitee.com/dongwei1125/dw-form-making" target="_blank" rel="noopener noreferrer">看一看<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）。</p> <h2 id="🎉-写在最后"><a href="#🎉-写在最后" class="header-anchor">#</a> 🎉 写在最后</h2> <p>🍻伙伴们，如果你已经看到了这里，觉得这篇文章有帮助到你的话不妨点赞👍或 <a href="https://github.com/dongwei1125/blog" target="_blank" rel="noopener noreferrer">Star<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ✨支持一下哦！</p> <p>手动码字，如有错误，欢迎在评论区指正💬~</p> <p>你的支持就是我更新的最大动力💪~</p> <p><a href="https://github.com/dongwei1125" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> / <a href="https://gitee.com/dongwei1125" target="_blank" rel="noopener noreferrer">Gitee<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://dongwei1125.github.io/" target="_blank" rel="noopener noreferrer">GitHub Pages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://juejin.cn/user/2621689331987783" target="_blank" rel="noopener noreferrer">掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://blog.csdn.net/Don_GW" target="_blank" rel="noopener noreferrer">CSDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 同步更新，欢迎关注😉~</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">3/6/2022, 9:06:37 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0aa97f73.js" defer></script><script src="/assets/js/2.f850a8ef.js" defer></script><script src="/assets/js/10.cb041c1b.js" defer></script>
  </body>
</html>
